{"version":3,"file":"angular-auth-oidc-client.umd.js","sources":["../../../projects/angular-auth-oidc-client/src/lib/api/http-base.service.ts","../../../node_modules/tslib/tslib.es6.js","../../../projects/angular-auth-oidc-client/src/lib/config/provider/config.provider.ts","../../../projects/angular-auth-oidc-client/src/lib/api/data.service.ts","../../../projects/angular-auth-oidc-client/src/lib/public-events/event-types.ts","../../../projects/angular-auth-oidc-client/src/lib/logging/log-level.ts","../../../projects/angular-auth-oidc-client/src/lib/logging/logger.service.ts","../../../projects/angular-auth-oidc-client/src/lib/storage/browser-storage.service.ts","../../../projects/angular-auth-oidc-client/src/lib/storage/storage-persistence.service.ts","../../../projects/angular-auth-oidc-client/src/lib/public-events/public-events.service.ts","../../../projects/angular-auth-oidc-client/src/lib/utils/tokenHelper/token-helper.service.ts","../../../projects/angular-auth-oidc-client/src/lib/validation/jsrsasign-reduced.service.ts","../../../projects/angular-auth-oidc-client/src/lib/validation/token-validation.service.ts","../../../projects/angular-auth-oidc-client/src/lib/auth-state/auth-state.service.ts","../../../projects/angular-auth-oidc-client/src/lib/auto-login/auto-login.service.ts","../../../projects/angular-auth-oidc-client/src/lib/utils/url/uri-encoder.ts","../../../projects/angular-auth-oidc-client/src/lib/flows/random/random.service.ts","../../../projects/angular-auth-oidc-client/src/lib/flows/flows-data.service.ts","../../../projects/angular-auth-oidc-client/src/lib/utils/flowHelper/flow-helper.service.ts","../../../projects/angular-auth-oidc-client/src/lib/utils/url/url.service.ts","../../../projects/angular-auth-oidc-client/src/lib/flows/callback-handling/code-flow-callback-handler.service.ts","../../../projects/angular-auth-oidc-client/src/lib/user-data/user.service.ts","../../../projects/angular-auth-oidc-client/src/lib/flows/reset-auth-data.service.ts","../../../projects/angular-auth-oidc-client/src/lib/flows/callback-handling/implicit-flow-callback-handler.service.ts","../../../projects/angular-auth-oidc-client/src/lib/validation/validation-result.ts","../../../projects/angular-auth-oidc-client/src/lib/flows/signin-key-data.service.ts","../../../projects/angular-auth-oidc-client/src/lib/flows/callback-handling/history-jwt-keys-callback-handler.service.ts","../../../projects/angular-auth-oidc-client/src/lib/flows/callback-handling/user-callback-handler.service.ts","../../../projects/angular-auth-oidc-client/src/lib/validation/state-validation-result.ts","../../../projects/angular-auth-oidc-client/src/lib/utils/equality/equality.service.ts","../../../projects/angular-auth-oidc-client/src/lib/validation/state-validation.service.ts","../../../projects/angular-auth-oidc-client/src/lib/flows/callback-handling/state-validation-callback-handler.service.ts","../../../projects/angular-auth-oidc-client/src/lib/flows/callback-handling/refresh-session-callback-handler.service.ts","../../../projects/angular-auth-oidc-client/src/lib/flows/callback-handling/refresh-token-callback-handler.service.ts","../../../projects/angular-auth-oidc-client/src/lib/flows/flows.service.ts","../../../projects/angular-auth-oidc-client/src/lib/callback/interval.service.ts","../../../projects/angular-auth-oidc-client/src/lib/callback/implicit-flow-callback.service.ts","../../../projects/angular-auth-oidc-client/src/lib/iframe/existing-iframe.service.ts","../../../projects/angular-auth-oidc-client/src/lib/iframe/check-session.service.ts","../../../projects/angular-auth-oidc-client/src/lib/utils/url/current-url.service.ts","../../../projects/angular-auth-oidc-client/src/lib/iframe/silent-renew.service.ts","../../../projects/angular-auth-oidc-client/src/lib/callback/code-flow-callback.service.ts","../../../projects/angular-auth-oidc-client/src/lib/callback/callback.service.ts","../../../projects/angular-auth-oidc-client/src/lib/config/auth-well-known/auth-well-known-data.service.ts","../../../projects/angular-auth-oidc-client/src/lib/config/auth-well-known/auth-well-known.service.ts","../../../projects/angular-auth-oidc-client/src/lib/iframe/refresh-session-iframe.service.ts","../../../projects/angular-auth-oidc-client/src/lib/callback/refresh-session-refresh-token.service.ts","../../../projects/angular-auth-oidc-client/src/lib/callback/refresh-session.service.ts","../../../projects/angular-auth-oidc-client/src/lib/callback/periodically-token-check.service.ts","../../../projects/angular-auth-oidc-client/src/lib/login/popup/popup.service.ts","../../../projects/angular-auth-oidc-client/src/lib/check-auth.service.ts","../../../projects/angular-auth-oidc-client/src/lib/config/default-config.ts","../../../projects/angular-auth-oidc-client/src/lib/config/validation/rule.ts","../../../projects/angular-auth-oidc-client/src/lib/config/validation/rules/ensure-authority.rule.ts","../../../projects/angular-auth-oidc-client/src/lib/config/validation/rules/ensure-clientId.rule.ts","../../../projects/angular-auth-oidc-client/src/lib/config/validation/rules/ensure-no-duplicated-configs.rule.ts","../../../projects/angular-auth-oidc-client/src/lib/config/validation/rules/ensure-redirect-url.rule.ts","../../../projects/angular-auth-oidc-client/src/lib/config/validation/rules/ensure-silentRenewUrl-with-no-refreshtokens.rule.ts","../../../projects/angular-auth-oidc-client/src/lib/config/validation/rules/use-offline-scope-with-silent-renew.rule.ts","../../../projects/angular-auth-oidc-client/src/lib/config/validation/rules/index.ts","../../../projects/angular-auth-oidc-client/src/lib/config/validation/config-validation.service.ts","../../../projects/angular-auth-oidc-client/src/lib/utils/platform-provider/platform.provider.ts","../../../projects/angular-auth-oidc-client/src/lib/storage/default-sessionstorage.service.ts","../../../projects/angular-auth-oidc-client/src/lib/config/config.service.ts","../../../projects/angular-auth-oidc-client/src/lib/config/loader/config-loader.ts","../../../projects/angular-auth-oidc-client/src/lib/interceptor/closest-matching-route.service.ts","../../../projects/angular-auth-oidc-client/src/lib/login/response-type-validation/response-type-validation.service.ts","../../../projects/angular-auth-oidc-client/src/lib/utils/redirect/redirect.service.ts","../../../projects/angular-auth-oidc-client/src/lib/login/par/par.service.ts","../../../projects/angular-auth-oidc-client/src/lib/login/par/par-login.service.ts","../../../projects/angular-auth-oidc-client/src/lib/login/popup/popup-login.service.ts","../../../projects/angular-auth-oidc-client/src/lib/login/standard/standard-login.service.ts","../../../projects/angular-auth-oidc-client/src/lib/login/login.service.ts","../../../projects/angular-auth-oidc-client/src/lib/logoff-revoke/logoff-revocation.service.ts","../../../projects/angular-auth-oidc-client/src/lib/oidc.security.service.ts","../../../projects/angular-auth-oidc-client/src/lib/auth.module.ts","../../../projects/angular-auth-oidc-client/src/lib/auto-login/auto-login-all-routes.guard.ts","../../../projects/angular-auth-oidc-client/src/lib/auto-login/auto-login-partial-routes.guard.ts","../../../projects/angular-auth-oidc-client/src/lib/interceptor/auth.interceptor.ts","../../../projects/angular-auth-oidc-client/src/lib/storage/abstract-security-storage.ts","../../../projects/angular-auth-oidc-client/src/lib/angular-auth-oidc-client.ts","../../../projects/angular-auth-oidc-client/src/public-api.ts","../../../projects/angular-auth-oidc-client/src/angular-auth-oidc-client.ts"],"sourcesContent":["import { HttpClient } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\n\n@Injectable()\nexport class HttpBaseService {\n  constructor(private http: HttpClient) {}\n\n  get<T>(url: string, params?: { [key: string]: any }): Observable<T> {\n    return this.http.get<T>(url, params);\n  }\n\n  post<T>(url: string, body: any, params?: { [key: string]: any }): Observable<T> {\n    return this.http.post<T>(url, body, params);\n  }\n}\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || from);\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n","import { Injectable } from '@angular/core';\nimport { OpenIdConfiguration } from '../openid-configuration';\n\n@Injectable()\nexport class ConfigurationProvider {\n  private configsInternal: Record<string, OpenIdConfiguration> = {};\n\n  hasAsLeastOneConfig(): boolean {\n    return Object.keys(this.configsInternal).length > 0;\n  }\n\n  hasManyConfigs(): boolean {\n    return Object.keys(this.configsInternal).length > 1;\n  }\n\n  setConfig(readyConfig: OpenIdConfiguration): void {\n    const { configId } = readyConfig;\n    this.configsInternal[configId] = readyConfig;\n  }\n\n  getOpenIDConfiguration(configId?: string): OpenIdConfiguration {\n    if (!!configId) {\n      return this.configsInternal[configId] || null;\n    }\n\n    const [, value] = Object.entries(this.configsInternal)[0] || [[null, null]];\n\n    return value || null;\n  }\n\n  getAllConfigurations(): OpenIdConfiguration[] {\n    return Object.values(this.configsInternal);\n  }\n}\n","import { HttpHeaders, HttpParams } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { ConfigurationProvider } from '../config/provider/config.provider';\nimport { HttpBaseService } from './http-base.service';\n\nconst NGSW_CUSTOM_PARAM = 'ngsw-bypass';\n\n@Injectable()\nexport class DataService {\n  constructor(private httpClient: HttpBaseService, private readonly configurationProvider: ConfigurationProvider) {}\n\n  get<T>(url: string, configId: string, token?: string): Observable<T> {\n    const headers = this.prepareHeaders(token);\n    const params = this.prepareParams(configId);\n\n    return this.httpClient.get<T>(url, {\n      headers,\n      params,\n    });\n  }\n\n  post<T>(url: string, body: any, configId: string, headersParams?: HttpHeaders): Observable<T> {\n    const headers = headersParams || this.prepareHeaders();\n    const params = this.prepareParams(configId);\n\n    return this.httpClient.post<T>(url, body, { headers, params });\n  }\n\n  private prepareHeaders(token?: string): HttpHeaders {\n    let headers = new HttpHeaders();\n    headers = headers.set('Accept', 'application/json');\n\n    if (!!token) {\n      headers = headers.set('Authorization', 'Bearer ' + decodeURIComponent(token));\n    }\n\n    return headers;\n  }\n\n  private prepareParams(configId: string): HttpParams {\n    let params = new HttpParams();\n    const { ngswBypass } = this.configurationProvider.getOpenIDConfiguration(configId);\n\n    if (ngswBypass) {\n      params = params.set(NGSW_CUSTOM_PARAM, '');\n    }\n\n    return params;\n  }\n}\n","// eslint-disable-next-line no-shadow\nexport enum EventTypes {\n  /**\n   *  This only works in the AppModule Constructor\n   */\n  ConfigLoaded,\n  ConfigLoadingFailed,\n  CheckSessionReceived,\n  UserDataChanged,\n  NewAuthenticationResult,\n  TokenExpired,\n  IdTokenExpired,\n  SilentRenewStarted,\n}\n","// eslint-disable-next-line no-shadow\nexport enum LogLevel {\n  None,\n  Debug,\n  Warn,\n  Error,\n}\n","import { Injectable } from '@angular/core';\nimport { ConfigurationProvider } from '../config/provider/config.provider';\nimport { LogLevel } from './log-level';\n\n@Injectable()\nexport class LoggerService {\n  constructor(private configurationProvider: ConfigurationProvider) {}\n\n  logError(configId: string, message: any, ...args: any[]): void {\n    if (!!configId) {\n      this.logErrorWithConfig(configId, message, ...args);\n    } else {\n      this.logErrorWithoutConfig(message, ...args);\n    }\n  }\n\n  logWarning(configId: string, message: any, ...args: any[]): void {\n    if (!!configId) {\n      this.logWarningWithConfig(configId, message, ...args);\n    } else {\n      this.logWarningWithoutConfig(message, ...args);\n    }\n  }\n\n  logDebug(configId: string, message: any, ...args: any[]): void {\n    if (!this.logLevelIsSet(configId)) {\n      return;\n    }\n\n    if (this.loggingIsTurnedOff(configId)) {\n      return;\n    }\n\n    if (!this.currentLogLevelIsEqualOrSmallerThan(configId, LogLevel.Debug)) {\n      return;\n    }\n\n    if (!!args && !!args.length) {\n      console.log(`[DEBUG] ${configId} - ${message}`, ...args);\n    } else {\n      console.log(`[DEBUG] ${configId} - ${message}`);\n    }\n  }\n\n  private logWarningWithoutConfig(message: any, ...args: any[]): void {\n    if (!!args && !!args.length) {\n      console.warn(`[WARN] - ${message}`, ...args);\n    } else {\n      console.warn(`[WARN] - ${message}`);\n    }\n  }\n\n  private logWarningWithConfig(configId: string, message: any, ...args: any[]): void {\n    if (!this.logLevelIsSet(configId)) {\n      return;\n    }\n\n    if (this.loggingIsTurnedOff(configId)) {\n      return;\n    }\n\n    if (!this.currentLogLevelIsEqualOrSmallerThan(configId, LogLevel.Warn)) {\n      return;\n    }\n\n    if (!!args && !!args.length) {\n      console.warn(`[WARN] ${configId} - ${message}`, ...args);\n    } else {\n      console.warn(`[WARN] ${configId} - ${message}`);\n    }\n  }\n\n  private logErrorWithConfig(configId: string, message: any, ...args: any[]): void {\n    if (this.loggingIsTurnedOff(configId)) {\n      return;\n    }\n\n    if (!!args && !!args.length) {\n      console.error(`[ERROR] ${configId} - ${message}`, ...args);\n    } else {\n      console.error(`[ERROR] ${configId} - ${message}`);\n    }\n  }\n\n  private logErrorWithoutConfig(message: any, ...args: any[]): void {\n    if (!!args && !!args.length) {\n      console.error(`[ERROR] - ${message}`, ...args);\n    } else {\n      console.error(`[ERROR] - ${message}`);\n    }\n  }\n\n  private currentLogLevelIsEqualOrSmallerThan(configId: string, logLevelToCompare: LogLevel): boolean {\n    const { logLevel } = this.configurationProvider.getOpenIDConfiguration(configId) || {};\n\n    return logLevel <= logLevelToCompare;\n  }\n\n  private logLevelIsSet(configId: string): boolean {\n    const { logLevel } = this.configurationProvider.getOpenIDConfiguration(configId) || {};\n\n    if (logLevel === null) {\n      return false;\n    }\n\n    if (logLevel === undefined) {\n      return false;\n    }\n\n    return true;\n  }\n\n  private loggingIsTurnedOff(configId: string): boolean {\n    const { logLevel } = this.configurationProvider.getOpenIDConfiguration(configId) || {};\n\n    return logLevel === LogLevel.None;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { ConfigurationProvider } from '../config/provider/config.provider';\nimport { LoggerService } from '../logging/logger.service';\nimport { AbstractSecurityStorage } from './abstract-security-storage';\n\n@Injectable()\nexport class BrowserStorageService {\n  constructor(private configProvider: ConfigurationProvider, private loggerService: LoggerService) {}\n\n  read(key: string, configId: string): any {\n    if (!this.hasStorage()) {\n      this.loggerService.logDebug(configId, `Wanted to read '${key}' but Storage was undefined`);\n\n      return null;\n    }\n\n    const storage = this.getStorage(configId);\n\n    if (!storage) {\n      this.loggerService.logDebug(configId, `Wanted to read config for '${configId}' but Storage was falsy`);\n\n      return null;\n    }\n\n    const storedConfig = storage.read(configId);\n\n    if (!storedConfig) {\n      return null;\n    }\n\n    return JSON.parse(storedConfig);\n  }\n\n  write(value: any, configId: string): boolean {\n    if (!this.hasStorage()) {\n      this.loggerService.logDebug(configId, `Wanted to write '${value}' but Storage was falsy`);\n\n      return false;\n    }\n\n    const storage = this.getStorage(configId);\n    if (!storage) {\n      this.loggerService.logDebug(configId, `Wanted to write '${value}' but Storage was falsy`);\n\n      return false;\n    }\n\n    value = value || null;\n\n    storage.write(configId, JSON.stringify(value));\n\n    return true;\n  }\n\n  remove(key: string, configId: string): boolean {\n    if (!this.hasStorage()) {\n      this.loggerService.logDebug(configId, `Wanted to remove '${key}' but Storage was falsy`);\n\n      return false;\n    }\n\n    const storage = this.getStorage(configId);\n    if (!storage) {\n      this.loggerService.logDebug(configId, `Wanted to write '${key}' but Storage was falsy`);\n\n      return false;\n    }\n\n    storage.remove(key);\n\n    return true;\n  }\n\n  // TODO THIS STORAGE WANTS AN ID BUT CLEARS EVERYTHING\n  clear(configId: string): boolean {\n    if (!this.hasStorage()) {\n      this.loggerService.logDebug(configId, `Wanted to clear storage but Storage was falsy`);\n\n      return false;\n    }\n\n    const storage = this.getStorage(configId);\n    if (!storage) {\n      this.loggerService.logDebug(configId, `Wanted to clear storage but Storage was falsy`);\n\n      return false;\n    }\n\n    storage.clear();\n\n    return true;\n  }\n\n  private getStorage(configId: string): AbstractSecurityStorage {\n    const { storage } = this.configProvider.getOpenIDConfiguration(configId) || {};\n\n    return storage;\n  }\n\n  private hasStorage(): boolean {\n    return typeof Storage !== 'undefined';\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { BrowserStorageService } from './browser-storage.service';\n\nexport type StorageKeys =\n  | 'authnResult'\n  | 'authzData'\n  | 'access_token_expires_at'\n  | 'authWellKnownEndPoints'\n  | 'userData'\n  | 'authNonce'\n  | 'codeVerifier'\n  | 'authStateControl'\n  | 'session_state'\n  | 'storageSilentRenewRunning'\n  | 'storageCustomParamsAuthRequest'\n  | 'storageCustomParamsRefresh'\n  | 'storageCustomParamsEndSession'\n  | 'redirect'\n  | 'configIds'\n  | 'jwtKeys';\n\n@Injectable()\nexport class StoragePersistenceService {\n  constructor(private readonly browserStorageService: BrowserStorageService) {}\n\n  read(key: StorageKeys, configId: string): any {\n    const storedConfig = this.browserStorageService.read(key, configId) || {};\n\n    return storedConfig[key];\n  }\n\n  write(key: StorageKeys, value: any, configId: string): void {\n    const storedConfig = this.browserStorageService.read(key, configId) || {};\n\n    storedConfig[key] = value;\n    this.browserStorageService.write(storedConfig, configId);\n  }\n\n  remove(key: StorageKeys, configId: string): void {\n    const storedConfig = this.browserStorageService.read(key, configId) || {};\n\n    delete storedConfig[key];\n\n    this.browserStorageService.write(storedConfig, configId);\n  }\n\n  clear(configId: string): void {\n    this.browserStorageService.clear(configId);\n  }\n\n  resetStorageFlowData(configId: string): void {\n    this.remove('session_state', configId);\n    this.remove('storageSilentRenewRunning', configId);\n    this.remove('codeVerifier', configId);\n    this.remove('userData', configId);\n    this.remove('storageCustomParamsAuthRequest', configId);\n    this.remove('access_token_expires_at', configId);\n    this.remove('storageCustomParamsRefresh', configId);\n    this.remove('storageCustomParamsEndSession', configId);\n  }\n\n  resetAuthStateInStorage(configId: string): void {\n    this.remove('authzData', configId);\n    this.remove('authnResult', configId);\n  }\n\n  getAccessToken(configId: string): string {\n    return this.read('authzData', configId);\n  }\n\n  getIdToken(configId: string): string {\n    return this.read('authnResult', configId)?.id_token;\n  }\n\n  getRefreshToken(configId: string): string {\n    return this.read('authnResult', configId)?.refresh_token;\n  }\n\n  getAuthenticationResult(configId: string): any {\n    return this.read('authnResult', configId);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable, ReplaySubject } from 'rxjs';\nimport { EventTypes } from './event-types';\nimport { OidcClientNotification } from './notification';\n\n@Injectable()\nexport class PublicEventsService {\n  private notify = new ReplaySubject<OidcClientNotification<any>>(1);\n\n  /**\n   * Fires a new event.\n   *\n   * @param type The event type.\n   * @param value The event value.\n   */\n  fireEvent<T>(type: EventTypes, value?: T): void {\n    this.notify.next({ type, value });\n  }\n\n  /**\n   * Wires up the event notification observable.\n   */\n  registerForEvents(): Observable<OidcClientNotification<any>> {\n    return this.notify.asObservable();\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { LoggerService } from '../../logging/logger.service';\n\nconst PARTS_OF_TOKEN = 3;\n@Injectable()\nexport class TokenHelperService {\n  constructor(private readonly loggerService: LoggerService) {}\n\n  getTokenExpirationDate(dataIdToken: any): Date {\n    if (!dataIdToken.hasOwnProperty('exp')) {\n      return new Date(new Date().toUTCString());\n    }\n\n    const date = new Date(0); // The 0 here is the key, which sets the date to the epoch\n    date.setUTCSeconds(dataIdToken.exp);\n\n    return date;\n  }\n\n  getHeaderFromToken(token: any, encoded: boolean, configId: string): any {\n    if (!this.tokenIsValid(token, configId)) {\n      return {};\n    }\n\n    return this.getPartOfToken(token, 0, encoded);\n  }\n\n  getPayloadFromToken(token: any, encoded: boolean, configId: string): any {\n    if (!this.tokenIsValid(token, configId)) {\n      return {};\n    }\n\n    return this.getPartOfToken(token, 1, encoded);\n  }\n\n  getSignatureFromToken(token: any, encoded: boolean, configId: string): any {\n    if (!this.tokenIsValid(token, configId)) {\n      return {};\n    }\n\n    return this.getPartOfToken(token, 2, encoded);\n  }\n\n  private getPartOfToken(token: string, index: number, encoded: boolean): any {\n    const partOfToken = this.extractPartOfToken(token, index);\n\n    if (encoded) {\n      return partOfToken;\n    }\n\n    const result = this.urlBase64Decode(partOfToken);\n\n    return JSON.parse(result);\n  }\n\n  private urlBase64Decode(str: string): string {\n    let output = str.replace(/-/g, '+').replace(/_/g, '/');\n\n    switch (output.length % 4) {\n      case 0:\n        break;\n      case 2:\n        output += '==';\n        break;\n      case 3:\n        output += '=';\n        break;\n      default:\n        throw Error('Illegal base64url string!');\n    }\n\n    const decoded = typeof window !== 'undefined' ? window.atob(output) : Buffer.from(output, 'base64').toString('binary');\n\n    try {\n      // Going backwards: from byte stream, to percent-encoding, to original string.\n      return decodeURIComponent(\n        decoded\n          .split('')\n          .map((c: string) => '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2))\n          .join('')\n      );\n    } catch (err) {\n      return decoded;\n    }\n  }\n\n  private tokenIsValid(token: string, configId: string): boolean {\n    if (!token) {\n      this.loggerService.logError(configId, `token '${token}' is not valid --> token falsy`);\n\n      return false;\n    }\n\n    if (!(token as string).includes('.')) {\n      this.loggerService.logError(configId, `token '${token}' is not valid --> no dots included`);\n\n      return false;\n    }\n\n    const parts = token.split('.');\n\n    if (parts.length !== PARTS_OF_TOKEN) {\n      this.loggerService.logError(configId, `token '${token}' is not valid --> token has to have exactly ${PARTS_OF_TOKEN - 1} dots`);\n\n      return false;\n    }\n\n    return true;\n  }\n\n  private extractPartOfToken(token: string, index: number): string {\n    return token.split('.')[index];\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { hextob64u, KJUR } from 'jsrsasign-reduced';\n\n@Injectable()\nexport class JsrsAsignReducedService {\n  generateCodeChallenge(codeVerifier: any): string {\n    const hash = KJUR.crypto.Util.hashString(codeVerifier, 'sha256');\n    const testData = hextob64u(hash);\n\n    return testData;\n  }\n\n  generateAtHash(accessToken: any, sha: string): string {\n    const hash = KJUR.crypto.Util.hashString(accessToken, sha);\n    const first128bits = hash.substr(0, hash.length / 2);\n    const testData = hextob64u(first128bits);\n\n    return testData;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { KEYUTIL, KJUR } from 'jsrsasign-reduced';\nimport { LoggerService } from '../logging/logger.service';\nimport { TokenHelperService } from '../utils/tokenHelper/token-helper.service';\nimport { JsrsAsignReducedService } from './jsrsasign-reduced.service';\n\n// http://openid.net/specs/openid-connect-implicit-1_0.html\n\n// id_token\n// id_token C1: The Issuer Identifier for the OpenID Provider (which is typically obtained during Discovery)\n// MUST exactly match the value of the iss (issuer) Claim.\n//\n// id_token C2: The Client MUST validate that the aud (audience) Claim contains its client_id value registered at the Issuer identified\n// by the iss (issuer) Claim as an audience.The ID Token MUST be rejected if the ID Token does not list the Client as a valid audience,\n// or if it contains additional audiences not trusted by the Client.\n//\n// id_token C3: If the ID Token contains multiple audiences, the Client SHOULD verify that an azp Claim is present.\n//\n// id_token C4: If an azp (authorized party) Claim is present, the Client SHOULD verify that its client_id is the Claim Value.\n//\n// id_token C5: The Client MUST validate the signature of the ID Token according to JWS [JWS] using the algorithm specified in the\n// alg Header Parameter of the JOSE Header.The Client MUST use the keys provided by the Issuer.\n//\n// id_token C6: The alg value SHOULD be RS256. Validation of tokens using other signing algorithms is described in the OpenID Connect\n// Core 1.0\n// [OpenID.Core] specification.\n//\n// id_token C7: The current time MUST be before the time represented by the exp Claim (possibly allowing for some small leeway to account\n// for clock skew).\n//\n// id_token C8: The iat Claim can be used to reject tokens that were issued too far away from the current time,\n// limiting the amount of time that nonces need to be stored to prevent attacks.The acceptable range is Client specific.\n//\n// id_token C9: The value of the nonce Claim MUST be checked to verify that it is the same value as the one that was sent\n// in the Authentication Request.The Client SHOULD check the nonce value for replay attacks.The precise method for detecting replay attacks\n// is Client specific.\n//\n// id_token C10: If the acr Claim was requested, the Client SHOULD check that the asserted Claim Value is appropriate.\n// The meaning and processing of acr Claim Values is out of scope for this document.\n//\n// id_token C11: When a max_age request is made, the Client SHOULD check the auth_time Claim value and request re- authentication\n// if it determines too much time has elapsed since the last End- User authentication.\n\n// Access Token Validation\n// access_token C1: Hash the octets of the ASCII representation of the access_token with the hash algorithm specified in JWA[JWA]\n// for the alg Header Parameter of the ID Token's JOSE Header. For instance, if the alg is RS256, the hash algorithm used is SHA-256.\n// access_token C2: Take the left- most half of the hash and base64url- encode it.\n// access_token C3: The value of at_hash in the ID Token MUST match the value produced in the previous step if at_hash is present\n// in the ID Token.\n\n@Injectable()\nexport class TokenValidationService {\n  static refreshTokenNoncePlaceholder = '--RefreshToken--';\n  keyAlgorithms: string[] = ['HS256', 'HS384', 'HS512', 'RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'PS256', 'PS384', 'PS512'];\n\n  constructor(\n    private tokenHelperService: TokenHelperService,\n    private loggerService: LoggerService,\n    private jsrsAsignReducedService: JsrsAsignReducedService\n  ) {}\n\n  // id_token C7: The current time MUST be before the time represented by the exp Claim\n  // (possibly allowing for some small leeway to account for clock skew).\n  hasIdTokenExpired(token: string, configId: string, offsetSeconds?: number): boolean {\n    const decoded = this.tokenHelperService.getPayloadFromToken(token, false, configId);\n\n    return !this.validateIdTokenExpNotExpired(decoded, configId, offsetSeconds);\n  }\n\n  // id_token C7: The current time MUST be before the time represented by the exp Claim\n  // (possibly allowing for some small leeway to account for clock skew).\n  validateIdTokenExpNotExpired(decodedIdToken: string, configId: string, offsetSeconds?: number): boolean {\n    const tokenExpirationDate = this.tokenHelperService.getTokenExpirationDate(decodedIdToken);\n    offsetSeconds = offsetSeconds || 0;\n\n    if (!tokenExpirationDate) {\n      return false;\n    }\n\n    const tokenExpirationValue = tokenExpirationDate.valueOf();\n    const nowWithOffset = new Date(new Date().toUTCString()).valueOf() + offsetSeconds * 1000;\n    const tokenNotExpired = tokenExpirationValue > nowWithOffset;\n\n    this.loggerService.logDebug(\n      configId,\n      `Has idToken expired: ${!tokenNotExpired} --> expires in ${this.millisToMinutesAndSeconds(\n        tokenExpirationValue - nowWithOffset\n      )} , ${new Date(tokenExpirationValue).toLocaleTimeString()} > ${new Date(nowWithOffset).toLocaleTimeString()}`\n    );\n\n    // Token not expired?\n    return tokenNotExpired;\n  }\n\n  validateAccessTokenNotExpired(accessTokenExpiresAt: Date, configId: string, offsetSeconds?: number): boolean {\n    // value is optional, so if it does not exist, then it has not expired\n    if (!accessTokenExpiresAt) {\n      return true;\n    }\n\n    offsetSeconds = offsetSeconds || 0;\n    const accessTokenExpirationValue = accessTokenExpiresAt.valueOf();\n    const nowWithOffset = new Date(new Date().toUTCString()).valueOf() + offsetSeconds * 1000;\n    const tokenNotExpired = accessTokenExpirationValue > nowWithOffset;\n\n    this.loggerService.logDebug(\n      configId,\n      `Has accessToken expired: ${!tokenNotExpired} --> expires in ${this.millisToMinutesAndSeconds(\n        accessTokenExpirationValue - nowWithOffset\n      )} , ${new Date(accessTokenExpirationValue).toLocaleTimeString()} > ${new Date(nowWithOffset).toLocaleTimeString()}`\n    );\n\n    // access token not expired?\n    return tokenNotExpired;\n  }\n\n  // iss\n  // REQUIRED. Issuer Identifier for the Issuer of the response.The iss value is a case-sensitive URL using the\n  // https scheme that contains scheme, host,\n  // and optionally, port number and path components and no query or fragment components.\n  //\n  // sub\n  // REQUIRED. Subject Identifier.Locally unique and never reassigned identifier within the Issuer for the End- User,\n  // which is intended to be consumed by the Client, e.g., 24400320 or AItOawmwtWwcT0k51BayewNvutrJUqsvl6qs7A4.\n  // It MUST NOT exceed 255 ASCII characters in length.The sub value is a case-sensitive string.\n  //\n  // aud\n  // REQUIRED. Audience(s) that this ID Token is intended for. It MUST contain the OAuth 2.0 client_id of the Relying Party as an\n  // audience value.\n  // It MAY also contain identifiers for other audiences.In the general case, the aud value is an array of case-sensitive strings.\n  // In the common special case when there is one audience, the aud value MAY be a single case-sensitive string.\n  //\n  // exp\n  // REQUIRED. Expiration time on or after which the ID Token MUST NOT be accepted for processing.\n  // The processing of this parameter requires that the current date/ time MUST be before the expiration date/ time listed in the value.\n  // Implementers MAY provide for some small leeway, usually no more than a few minutes, to account for clock skew.\n  // Its value is a JSON [RFC7159] number representing the number of seconds from 1970- 01 - 01T00: 00:00Z as measured in UTC until\n  // the date/ time.\n  // See RFC 3339 [RFC3339] for details regarding date/ times in general and UTC in particular.\n  //\n  // iat\n  // REQUIRED. Time at which the JWT was issued. Its value is a JSON number representing the number of seconds from\n  // 1970- 01 - 01T00: 00: 00Z as measured\n  // in UTC until the date/ time.\n  validateRequiredIdToken(dataIdToken: any, configId: string): boolean {\n    let validated = true;\n    if (!dataIdToken.hasOwnProperty('iss')) {\n      validated = false;\n      this.loggerService.logWarning(configId, 'iss is missing, this is required in the id_token');\n    }\n\n    if (!dataIdToken.hasOwnProperty('sub')) {\n      validated = false;\n      this.loggerService.logWarning(configId, 'sub is missing, this is required in the id_token');\n    }\n\n    if (!dataIdToken.hasOwnProperty('aud')) {\n      validated = false;\n      this.loggerService.logWarning(configId, 'aud is missing, this is required in the id_token');\n    }\n\n    if (!dataIdToken.hasOwnProperty('exp')) {\n      validated = false;\n      this.loggerService.logWarning(configId, 'exp is missing, this is required in the id_token');\n    }\n\n    if (!dataIdToken.hasOwnProperty('iat')) {\n      validated = false;\n      this.loggerService.logWarning(configId, 'iat is missing, this is required in the id_token');\n    }\n\n    return validated;\n  }\n\n  // id_token C8: The iat Claim can be used to reject tokens that were issued too far away from the current time,\n  // limiting the amount of time that nonces need to be stored to prevent attacks.The acceptable range is Client specific.\n  validateIdTokenIatMaxOffset(\n    dataIdToken: any,\n    maxOffsetAllowedInSeconds: number,\n    disableIatOffsetValidation: boolean,\n    configId: string\n  ): boolean {\n    if (disableIatOffsetValidation) {\n      return true;\n    }\n\n    if (!dataIdToken.hasOwnProperty('iat')) {\n      return false;\n    }\n\n    const dateTimeIatIdToken = new Date(0); // The 0 here is the key, which sets the date to the epoch\n    dateTimeIatIdToken.setUTCSeconds(dataIdToken.iat);\n    maxOffsetAllowedInSeconds = maxOffsetAllowedInSeconds || 0;\n\n    const nowInUtc = new Date(new Date().toUTCString());\n    const diff = nowInUtc.valueOf() - dateTimeIatIdToken.valueOf();\n    const maxOffsetAllowedInMilliseconds = maxOffsetAllowedInSeconds * 1000;\n\n    this.loggerService.logDebug(configId, `validate id token iat max offset ${diff} < ${maxOffsetAllowedInMilliseconds}`);\n\n    if (diff > 0) {\n      return diff < maxOffsetAllowedInMilliseconds;\n    }\n\n    return -diff < maxOffsetAllowedInMilliseconds;\n  }\n\n  // id_token C9: The value of the nonce Claim MUST be checked to verify that it is the same value as the one\n  // that was sent in the Authentication Request.The Client SHOULD check the nonce value for replay attacks.\n  // The precise method for detecting replay attacks is Client specific.\n\n  // However the nonce claim SHOULD not be present for the refresh_token grant type\n  // https://bitbucket.org/openid/connect/issues/1025/ambiguity-with-how-nonce-is-handled-on\n  // The current spec is ambiguous and KeyCloak does send it.\n  validateIdTokenNonce(dataIdToken: any, localNonce: any, ignoreNonceAfterRefresh: boolean, configId: string): boolean {\n    const isFromRefreshToken =\n      (dataIdToken.nonce === undefined || ignoreNonceAfterRefresh) && localNonce === TokenValidationService.refreshTokenNoncePlaceholder;\n    if (!isFromRefreshToken && dataIdToken.nonce !== localNonce) {\n      this.loggerService.logDebug(\n        configId,\n        'Validate_id_token_nonce failed, dataIdToken.nonce: ' + dataIdToken.nonce + ' local_nonce:' + localNonce\n      );\n\n      return false;\n    }\n\n    return true;\n  }\n\n  // id_token C1: The Issuer Identifier for the OpenID Provider (which is typically obtained during Discovery)\n  // MUST exactly match the value of the iss (issuer) Claim.\n  validateIdTokenIss(dataIdToken: any, authWellKnownEndpointsIssuer: any, configId: string): boolean {\n    if ((dataIdToken.iss as string) !== (authWellKnownEndpointsIssuer as string)) {\n      this.loggerService.logDebug(\n        configId,\n        'Validate_id_token_iss failed, dataIdToken.iss: ' +\n          dataIdToken.iss +\n          ' authWellKnownEndpoints issuer:' +\n          authWellKnownEndpointsIssuer\n      );\n\n      return false;\n    }\n\n    return true;\n  }\n\n  // id_token C2: The Client MUST validate that the aud (audience) Claim contains its client_id value registered at the Issuer identified\n  // by the iss (issuer) Claim as an audience.\n  // The ID Token MUST be rejected if the ID Token does not list the Client as a valid audience, or if it contains additional audiences\n  // not trusted by the Client.\n  validateIdTokenAud(dataIdToken: any, aud: any, configId: string): boolean {\n    if (Array.isArray(dataIdToken.aud)) {\n      const result = dataIdToken.aud.includes(aud);\n\n      if (!result) {\n        this.loggerService.logDebug(\n          configId,\n          'Validate_id_token_aud array failed, dataIdToken.aud: ' + dataIdToken.aud + ' client_id:' + aud\n        );\n\n        return false;\n      }\n\n      return true;\n    } else if (dataIdToken.aud !== aud) {\n      this.loggerService.logDebug(configId, 'Validate_id_token_aud failed, dataIdToken.aud: ' + dataIdToken.aud + ' client_id:' + aud);\n\n      return false;\n    }\n\n    return true;\n  }\n\n  validateIdTokenAzpExistsIfMoreThanOneAud(dataIdToken: any): boolean {\n    if (!dataIdToken) {\n      return false;\n    }\n\n    if (Array.isArray(dataIdToken.aud) && dataIdToken.aud.length > 1 && !dataIdToken.azp) {\n      return false;\n    }\n\n    return true;\n  }\n\n  // If an azp (authorized party) Claim is present, the Client SHOULD verify that its client_id is the Claim Value.\n  validateIdTokenAzpValid(dataIdToken: any, clientId: string): boolean {\n    if (!dataIdToken?.azp) {\n      return true;\n    }\n\n    if (dataIdToken.azp === clientId) {\n      return true;\n    }\n\n    return false;\n  }\n\n  validateStateFromHashCallback(state: any, localState: any, configId: string): boolean {\n    if ((state as string) !== (localState as string)) {\n      this.loggerService.logDebug(configId, 'ValidateStateFromHashCallback failed, state: ' + state + ' local_state:' + localState);\n\n      return false;\n    }\n\n    return true;\n  }\n\n  // id_token C5: The Client MUST validate the signature of the ID Token according to JWS [JWS] using the algorithm specified in the alg\n  // Header Parameter of the JOSE Header.The Client MUST use the keys provided by the Issuer.\n  // id_token C6: The alg value SHOULD be RS256. Validation of tokens using other signing algorithms is described in the\n  // OpenID Connect Core 1.0 [OpenID.Core] specification.\n  validateSignatureIdToken(idToken: any, jwtkeys: any, configId: string): boolean {\n    if (!jwtkeys || !jwtkeys.keys) {\n      return false;\n    }\n\n    const headerData = this.tokenHelperService.getHeaderFromToken(idToken, false, configId);\n\n    if (Object.keys(headerData).length === 0 && headerData.constructor === Object) {\n      this.loggerService.logWarning(configId, 'id token has no header data');\n\n      return false;\n    }\n\n    const kid = headerData.kid;\n    const alg = headerData.alg;\n\n    if (!this.keyAlgorithms.includes(alg as string)) {\n      this.loggerService.logWarning(configId, 'alg not supported', alg);\n\n      return false;\n    }\n\n    let jwtKtyToUse = 'RSA';\n    if ((alg as string).charAt(0) === 'E') {\n      jwtKtyToUse = 'EC';\n    }\n\n    let isValid = false;\n\n    // No kid in the Jose header\n    if (!kid) {\n      let keyToValidate;\n\n      // If only one key, use it\n      if (jwtkeys.keys.length === 1 && (jwtkeys.keys[0].kty as string) === jwtKtyToUse) {\n        keyToValidate = jwtkeys.keys[0];\n      } else {\n        // More than one key\n        // Make sure there's exactly 1 key candidate\n        // kty \"RSA\" and \"EC\" uses \"sig\"\n        let amountOfMatchingKeys = 0;\n        for (const key of jwtkeys.keys) {\n          if ((key.kty as string) === jwtKtyToUse && (key.use as string) === 'sig') {\n            amountOfMatchingKeys++;\n            keyToValidate = key;\n          }\n        }\n\n        if (amountOfMatchingKeys > 1) {\n          this.loggerService.logWarning(configId, 'no ID Token kid claim in JOSE header and multiple supplied in jwks_uri');\n\n          return false;\n        }\n      }\n\n      if (!keyToValidate) {\n        this.loggerService.logWarning(configId, 'no keys found, incorrect Signature, validation failed for id_token');\n\n        return false;\n      }\n\n      isValid = KJUR.jws.JWS.verify(idToken, KEYUTIL.getKey(keyToValidate), [alg]);\n\n      if (!isValid) {\n        this.loggerService.logWarning(configId, 'incorrect Signature, validation failed for id_token');\n      }\n\n      return isValid;\n    } else {\n      // kid in the Jose header of id_token\n      for (const key of jwtkeys.keys) {\n        if ((key.kid as string) === (kid as string)) {\n          const publicKey = KEYUTIL.getKey(key);\n          isValid = KJUR.jws.JWS.verify(idToken, publicKey, [alg]);\n          if (!isValid) {\n            this.loggerService.logWarning(configId, 'incorrect Signature, validation failed for id_token');\n          }\n\n          return isValid;\n        }\n      }\n    }\n\n    return isValid;\n  }\n\n  // Accepts ID Token without 'kid' claim in JOSE header if only one JWK supplied in 'jwks_url'\n  //// private validate_no_kid_in_header_only_one_allowed_in_jwtkeys(header_data: any, jwtkeys: any): boolean {\n  ////    this.oidcSecurityCommon.logDebug('amount of jwtkeys.keys: ' + jwtkeys.keys.length);\n  ////    if (!header_data.hasOwnProperty('kid')) {\n  ////        // no kid defined in Jose header\n  ////        if (jwtkeys.keys.length != 1) {\n  ////            this.oidcSecurityCommon.logDebug('jwtkeys.keys.length != 1 and no kid in header');\n  ////            return false;\n  ////        }\n  ////    }\n\n  ////    return true;\n  //// }\n\n  // Access Token Validation\n  // access_token C1: Hash the octets of the ASCII representation of the access_token with the hash algorithm specified in JWA[JWA]\n  // for the alg Header Parameter of the ID Token's JOSE Header. For instance, if the alg is RS256, the hash algorithm used is SHA-256.\n  // access_token C2: Take the left- most half of the hash and base64url- encode it.\n  // access_token C3: The value of at_hash in the ID Token MUST match the value produced in the previous step if at_hash\n  // is present in the ID Token.\n  validateIdTokenAtHash(accessToken: any, atHash: any, idTokenAlg: string, configId: string): boolean {\n    this.loggerService.logDebug(configId, 'at_hash from the server:' + atHash);\n\n    // 'sha256' 'sha384' 'sha512'\n    let sha = 'sha256';\n    if (idTokenAlg.includes('384')) {\n      sha = 'sha384';\n    } else if (idTokenAlg.includes('512')) {\n      sha = 'sha512';\n    }\n\n    const testData = this.jsrsAsignReducedService.generateAtHash('' + accessToken, sha);\n    this.loggerService.logDebug(configId, 'at_hash client validation not decoded:' + testData);\n    if (testData === (atHash as string)) {\n      return true; // isValid;\n    } else {\n      const testValue = this.jsrsAsignReducedService.generateAtHash('' + decodeURIComponent(accessToken), sha);\n      this.loggerService.logDebug(configId, '-gen access--' + testValue);\n      if (testValue === (atHash as string)) {\n        return true; // isValid\n      }\n    }\n\n    return false;\n  }\n\n  private millisToMinutesAndSeconds(millis: number): string {\n    const minutes = Math.floor(millis / 60000);\n    const seconds = ((millis % 60000) / 1000).toFixed(0);\n\n    return minutes + ':' + (+seconds < 10 ? '0' : '') + seconds;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { BehaviorSubject, Observable } from 'rxjs';\nimport { distinctUntilChanged } from 'rxjs/operators';\nimport { ConfigurationProvider } from '../config/provider/config.provider';\nimport { AuthResult } from '../flows/callback-context';\nimport { LoggerService } from '../logging/logger.service';\nimport { EventTypes } from '../public-events/event-types';\nimport { PublicEventsService } from '../public-events/public-events.service';\nimport { StoragePersistenceService } from '../storage/storage-persistence.service';\nimport { TokenValidationService } from '../validation/token-validation.service';\nimport { AuthenticatedResult } from './auth-result';\nimport { AuthStateResult } from './auth-state';\n\nconst DEFAULT_AUTHRESULT = { isAuthenticated: false, allConfigsAuthenticated: [] };\n\n@Injectable()\nexport class AuthStateService {\n  private authenticatedInternal$ = new BehaviorSubject<AuthenticatedResult>(DEFAULT_AUTHRESULT);\n\n  get authenticated$(): Observable<AuthenticatedResult> {\n    return this.authenticatedInternal$.asObservable().pipe(distinctUntilChanged());\n  }\n\n  constructor(\n    private storagePersistenceService: StoragePersistenceService,\n    private loggerService: LoggerService,\n    private publicEventsService: PublicEventsService,\n    private configurationProvider: ConfigurationProvider,\n    private tokenValidationService: TokenValidationService\n  ) {}\n\n  setAuthenticatedAndFireEvent(): void {\n    const result = this.composeAuthenticatedResult();\n    this.authenticatedInternal$.next(result);\n  }\n\n  setUnauthenticatedAndFireEvent(configIdToReset: string): void {\n    this.storagePersistenceService.resetAuthStateInStorage(configIdToReset);\n\n    const result = this.composeUnAuthenticatedResult();\n    this.authenticatedInternal$.next(result);\n  }\n\n  updateAndPublishAuthState(authenticationResult: AuthStateResult): void {\n    this.publicEventsService.fireEvent<AuthStateResult>(EventTypes.NewAuthenticationResult, authenticationResult);\n  }\n\n  setAuthorizationData(accessToken: string, authResult: AuthResult, configId: string): void {\n    this.loggerService.logDebug(configId, `storing the accessToken '${accessToken}'`);\n\n    this.storagePersistenceService.write('authzData', accessToken, configId);\n    this.persistAccessTokenExpirationTime(authResult, configId);\n    this.setAuthenticatedAndFireEvent();\n  }\n\n  getAccessToken(configId: string): string {\n    if (!this.isAuthenticated(configId)) {\n      return null;\n    }\n\n    const token = this.storagePersistenceService.getAccessToken(configId);\n\n    return this.decodeURIComponentSafely(token);\n  }\n\n  getIdToken(configId: string): string {\n    if (!this.isAuthenticated(configId)) {\n      return null;\n    }\n\n    const token = this.storagePersistenceService.getIdToken(configId);\n\n    return this.decodeURIComponentSafely(token);\n  }\n\n  getRefreshToken(configId: string): string {\n    if (!this.isAuthenticated(configId)) {\n      return null;\n    }\n\n    const token = this.storagePersistenceService.getRefreshToken(configId);\n\n    return this.decodeURIComponentSafely(token);\n  }\n\n  getAuthenticationResult(configId?: string): any {\n    if (!this.isAuthenticated(configId)) {\n      return null;\n    }\n\n    return this.storagePersistenceService.getAuthenticationResult(configId);\n  }\n\n  areAuthStorageTokensValid(configId: string): boolean {\n    if (!this.isAuthenticated(configId)) {\n      return false;\n    }\n\n    if (this.hasIdTokenExpiredAndRenewCheckIsEnabled(configId)) {\n      this.loggerService.logDebug(configId, 'persisted idToken is expired');\n\n      return false;\n    }\n\n    if (this.hasAccessTokenExpiredIfExpiryExists(configId)) {\n      this.loggerService.logDebug(configId, 'persisted accessToken is expired');\n\n      return false;\n    }\n\n    this.loggerService.logDebug(configId, 'persisted idToken and accessToken are valid');\n\n    return true;\n  }\n\n  hasIdTokenExpiredAndRenewCheckIsEnabled(configId: string): boolean {\n    const { renewTimeBeforeTokenExpiresInSeconds, enableIdTokenExpiredValidationInRenew } =\n      this.configurationProvider.getOpenIDConfiguration(configId);\n\n    if (!enableIdTokenExpiredValidationInRenew) {\n      return false;\n    }\n    const tokenToCheck = this.storagePersistenceService.getIdToken(configId);\n\n    const idTokenExpired = this.tokenValidationService.hasIdTokenExpired(tokenToCheck, configId, renewTimeBeforeTokenExpiresInSeconds);\n\n    if (idTokenExpired) {\n      this.publicEventsService.fireEvent<boolean>(EventTypes.IdTokenExpired, idTokenExpired);\n    }\n\n    return idTokenExpired;\n  }\n\n  hasAccessTokenExpiredIfExpiryExists(configId: string): boolean {\n    const { renewTimeBeforeTokenExpiresInSeconds } = this.configurationProvider.getOpenIDConfiguration(configId);\n    const accessTokenExpiresIn = this.storagePersistenceService.read('access_token_expires_at', configId);\n    const accessTokenHasNotExpired = this.tokenValidationService.validateAccessTokenNotExpired(\n      accessTokenExpiresIn,\n      configId,\n      renewTimeBeforeTokenExpiresInSeconds\n    );\n\n    const hasExpired = !accessTokenHasNotExpired;\n\n    if (hasExpired) {\n      this.publicEventsService.fireEvent<boolean>(EventTypes.TokenExpired, hasExpired);\n    }\n\n    return hasExpired;\n  }\n\n  isAuthenticated(configId: string): boolean {\n    return !!this.storagePersistenceService.getAccessToken(configId) && !!this.storagePersistenceService.getIdToken(configId);\n  }\n\n  private decodeURIComponentSafely(token: string): string {\n    if (token) {\n      return decodeURIComponent(token);\n    } else {\n      return '';\n    }\n  }\n\n  private persistAccessTokenExpirationTime(authResult: any, configId: string): void {\n    if (authResult?.expires_in) {\n      const accessTokenExpiryTime = new Date(new Date().toUTCString()).valueOf() + authResult.expires_in * 1000;\n      this.storagePersistenceService.write('access_token_expires_at', accessTokenExpiryTime, configId);\n    }\n  }\n\n  private composeAuthenticatedResult(): AuthenticatedResult {\n    if (!this.configurationProvider.hasManyConfigs()) {\n      const { configId } = this.configurationProvider.getOpenIDConfiguration();\n\n      return { isAuthenticated: true, allConfigsAuthenticated: [{ configId, isAuthenticated: true }] };\n    }\n\n    return this.checkAllConfigsIfTheyAreAuthenticated();\n  }\n\n  private composeUnAuthenticatedResult(): AuthenticatedResult {\n    if (!this.configurationProvider.hasManyConfigs()) {\n      const { configId } = this.configurationProvider.getOpenIDConfiguration();\n\n      return { isAuthenticated: false, allConfigsAuthenticated: [{ configId, isAuthenticated: false }] };\n    }\n\n    return this.checkAllConfigsIfTheyAreAuthenticated();\n  }\n\n  private checkAllConfigsIfTheyAreAuthenticated(): AuthenticatedResult {\n    const configs = this.configurationProvider.getAllConfigurations();\n\n    const allConfigsAuthenticated = configs.map(({ configId }) => ({\n      configId,\n      isAuthenticated: this.isAuthenticated(configId),\n    }));\n\n    const isAuthenticated = allConfigsAuthenticated.every((x) => !!x.isAuthenticated);\n\n    return { allConfigsAuthenticated, isAuthenticated };\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { StoragePersistenceService } from '../storage/storage-persistence.service';\n\nconst STORAGE_KEY = 'redirect';\n\n@Injectable()\nexport class AutoLoginService {\n  constructor(private readonly storageService: StoragePersistenceService, private readonly router: Router) {}\n\n  checkSavedRedirectRouteAndNavigate(configId: string): void {\n    const savedRouteForRedirect = this.getStoredRedirectRoute(configId);\n\n    if (savedRouteForRedirect) {\n      this.deleteStoredRedirectRoute(configId);\n      this.router.navigateByUrl(savedRouteForRedirect);\n    }\n  }\n\n  /**\n   * Saves the redirect URL to storage.\n   *\n   * @param url The redirect URL to save.\n   */\n  saveRedirectRoute(configId: string, url: string): void {\n    this.storageService.write(STORAGE_KEY, url, configId);\n  }\n\n  /**\n   * Gets the stored redirect URL from storage.\n   */\n  private getStoredRedirectRoute(configId: string): string {\n    return this.storageService.read(STORAGE_KEY, configId);\n  }\n\n  /**\n   * Removes the redirect URL from storage.\n   */\n  private deleteStoredRedirectRoute(configId: string): void {\n    this.storageService.remove(STORAGE_KEY, configId);\n  }\n}\n","import { HttpParameterCodec } from '@angular/common/http';\n\nexport class UriEncoder implements HttpParameterCodec {\n  encodeKey(key: string): string {\n    return encodeURIComponent(key);\n  }\n\n  encodeValue(value: string): string {\n    return encodeURIComponent(value);\n  }\n\n  decodeKey(key: string): string {\n    return decodeURIComponent(key);\n  }\n\n  decodeValue(value: string): string {\n    return decodeURIComponent(value);\n  }\n}\n","import { DOCUMENT } from '@angular/common';\nimport { Inject, Injectable } from '@angular/core';\nimport { LoggerService } from '../../logging/logger.service';\n\n@Injectable()\nexport class RandomService {\n  constructor(@Inject(DOCUMENT) private readonly doc: any, private loggerService: LoggerService) {}\n\n  createRandom(requiredLength: number, configId: string): string {\n    if (requiredLength <= 0) {\n      return '';\n    }\n\n    if (requiredLength > 0 && requiredLength < 7) {\n      this.loggerService.logWarning(configId, `RandomService called with ${requiredLength} but 7 chars is the minimum, returning 10 chars`);\n      requiredLength = 10;\n    }\n\n    const length = requiredLength - 6;\n    const arr = new Uint8Array(Math.floor((length || length) / 2));\n    if (this.getCrypto()) {\n      this.getCrypto().getRandomValues(arr);\n    }\n\n    return Array.from(arr, this.toHex).join('') + this.randomString(7);\n  }\n\n  private toHex(dec): string {\n    return ('0' + dec.toString(16)).substr(-2);\n  }\n\n  private randomString(length): string {\n    let result = '';\n    const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n\n    const values = new Uint32Array(length);\n    if (this.getCrypto()) {\n      this.getCrypto().getRandomValues(values);\n      for (let i = 0; i < length; i++) {\n        result += characters[values[i] % characters.length];\n      }\n    }\n\n    return result;\n  }\n\n  private getCrypto(): any {\n    // support for IE,  (window.crypto || window.msCrypto)\n    return this.doc.defaultView.crypto || (this.doc.defaultView as any).msCrypto;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { ConfigurationProvider } from '../config/provider/config.provider';\nimport { LoggerService } from '../logging/logger.service';\nimport { StoragePersistenceService } from '../storage/storage-persistence.service';\nimport { RandomService } from './random/random.service';\n\n@Injectable()\nexport class FlowsDataService {\n  constructor(\n    private storagePersistenceService: StoragePersistenceService,\n    private randomService: RandomService,\n    private configurationProvider: ConfigurationProvider,\n    private loggerService: LoggerService\n  ) {}\n\n  createNonce(configId: string): string {\n    const nonce = this.randomService.createRandom(40, configId);\n    this.loggerService.logDebug(configId, 'Nonce created. nonce:' + nonce);\n    this.setNonce(nonce, configId);\n\n    return nonce;\n  }\n\n  setNonce(nonce: string, configId: string): void {\n    this.storagePersistenceService.write('authNonce', nonce, configId);\n  }\n\n  getAuthStateControl(configId: string): any {\n    return this.storagePersistenceService.read('authStateControl', configId);\n  }\n\n  setAuthStateControl(authStateControl: string, configId: string): void {\n    this.storagePersistenceService.write('authStateControl', authStateControl, configId);\n  }\n\n  getExistingOrCreateAuthStateControl(configId: string): any {\n    let state = this.storagePersistenceService.read('authStateControl', configId);\n    if (!state) {\n      state = this.randomService.createRandom(40, configId);\n      this.storagePersistenceService.write('authStateControl', state, configId);\n    }\n\n    return state;\n  }\n\n  setSessionState(sessionState: any, configId: string): void {\n    this.storagePersistenceService.write('session_state', sessionState, configId);\n  }\n\n  resetStorageFlowData(configId: string): void {\n    this.storagePersistenceService.resetStorageFlowData(configId);\n  }\n\n  getCodeVerifier(configId: string): any {\n    return this.storagePersistenceService.read('codeVerifier', configId);\n  }\n\n  createCodeVerifier(configId: string): string {\n    const codeVerifier = this.randomService.createRandom(67, configId);\n    this.storagePersistenceService.write('codeVerifier', codeVerifier, configId);\n\n    return codeVerifier;\n  }\n\n  isSilentRenewRunning(configId: string): boolean {\n    const storageObject = this.getSilentRenewRunningStorageEntry(configId);\n\n    if (!storageObject) {\n      return false;\n    }\n\n    const { silentRenewTimeoutInSeconds } = this.configurationProvider.getOpenIDConfiguration(configId);\n    const timeOutInMilliseconds = silentRenewTimeoutInSeconds * 1000;\n    const dateOfLaunchedProcessUtc = Date.parse(storageObject.dateOfLaunchedProcessUtc);\n    const currentDateUtc = Date.parse(new Date().toISOString());\n    const elapsedTimeInMilliseconds = Math.abs(currentDateUtc - dateOfLaunchedProcessUtc);\n    const isProbablyStuck = elapsedTimeInMilliseconds > timeOutInMilliseconds;\n\n    if (isProbablyStuck) {\n      this.loggerService.logDebug(configId, 'silent renew process is probably stuck, state will be reset.', configId);\n      this.resetSilentRenewRunning(configId);\n\n      return false;\n    }\n\n    return storageObject.state === 'running';\n  }\n\n  setSilentRenewRunning(configId: string): void {\n    const storageObject = {\n      state: 'running',\n      dateOfLaunchedProcessUtc: new Date().toISOString(),\n    };\n\n    this.storagePersistenceService.write('storageSilentRenewRunning', JSON.stringify(storageObject), configId);\n  }\n\n  resetSilentRenewRunning(configId: string): void {\n    this.storagePersistenceService.write('storageSilentRenewRunning', '', configId);\n  }\n\n  private getSilentRenewRunningStorageEntry(configId: string): any {\n    const storageEntry = this.storagePersistenceService.read('storageSilentRenewRunning', configId);\n\n    if (!storageEntry) {\n      return null;\n    }\n\n    return JSON.parse(storageEntry);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { ConfigurationProvider } from '../../config/provider/config.provider';\n\n@Injectable()\nexport class FlowHelper {\n  constructor(private configurationProvider: ConfigurationProvider) {}\n\n  isCurrentFlowCodeFlow(configId: string): boolean {\n    return this.currentFlowIs('code', configId);\n  }\n\n  isCurrentFlowAnyImplicitFlow(configId: string): boolean {\n    return this.isCurrentFlowImplicitFlowWithAccessToken(configId) || this.isCurrentFlowImplicitFlowWithoutAccessToken(configId);\n  }\n\n  isCurrentFlowCodeFlowWithRefreshTokens(configId: string): boolean {\n    const { useRefreshToken } = this.configurationProvider.getOpenIDConfiguration(configId);\n    if (this.isCurrentFlowCodeFlow(configId) && useRefreshToken) {\n      return true;\n    }\n\n    return false;\n  }\n\n  isCurrentFlowImplicitFlowWithAccessToken(configId: string): boolean {\n    return this.currentFlowIs('id_token token', configId);\n  }\n\n  currentFlowIs(flowTypes: string[] | string, configId: string): boolean {\n    const { responseType } = this.configurationProvider.getOpenIDConfiguration(configId);\n\n    if (Array.isArray(flowTypes)) {\n      return flowTypes.some((x) => responseType === x);\n    }\n\n    return responseType === flowTypes;\n  }\n\n  private isCurrentFlowImplicitFlowWithoutAccessToken(configId: string): boolean {\n    return this.currentFlowIs('id_token', configId);\n  }\n}\n","import { HttpParams } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { ConfigurationProvider } from '../../config/provider/config.provider';\nimport { FlowsDataService } from '../../flows/flows-data.service';\nimport { LoggerService } from '../../logging/logger.service';\nimport { StoragePersistenceService } from '../../storage/storage-persistence.service';\nimport { JsrsAsignReducedService } from '../../validation/jsrsasign-reduced.service';\nimport { FlowHelper } from '../flowHelper/flow-helper.service';\nimport { UriEncoder } from './uri-encoder';\n\nconst CALLBACK_PARAMS_TO_CHECK = ['code', 'state', 'token', 'id_token'];\nconst AUTH0_ENDPOINT = 'auth0.com';\n\n@Injectable()\nexport class UrlService {\n  constructor(\n    private readonly configurationProvider: ConfigurationProvider,\n    private readonly loggerService: LoggerService,\n    private readonly flowsDataService: FlowsDataService,\n    private readonly flowHelper: FlowHelper,\n    private storagePersistenceService: StoragePersistenceService,\n    private jsrsAsignReducedService: JsrsAsignReducedService\n  ) {}\n\n  getUrlParameter(urlToCheck: any, name: any): string {\n    if (!urlToCheck) {\n      return '';\n    }\n\n    if (!name) {\n      return '';\n    }\n\n    name = name.replace(/[\\[]/, '\\\\[').replace(/[\\]]/, '\\\\]');\n    const regex = new RegExp('[\\\\?&]' + name + '=([^&#]*)');\n    const results = regex.exec(urlToCheck);\n\n    return results === null ? '' : decodeURIComponent(results[1]);\n  }\n\n  isCallbackFromSts(currentUrl: string): boolean {\n    return CALLBACK_PARAMS_TO_CHECK.some((x) => !!this.getUrlParameter(currentUrl, x));\n  }\n\n  getRefreshSessionSilentRenewUrl(configId: string, customParams?: { [key: string]: string | number | boolean }): string {\n    if (this.flowHelper.isCurrentFlowCodeFlow(configId)) {\n      return this.createUrlCodeFlowWithSilentRenew(configId, customParams);\n    }\n\n    return this.createUrlImplicitFlowWithSilentRenew(configId, customParams) || '';\n  }\n\n  getAuthorizeParUrl(requestUri: string, configId: string): string {\n    const authWellKnownEndPoints = this.storagePersistenceService.read('authWellKnownEndPoints', configId);\n\n    if (!authWellKnownEndPoints) {\n      this.loggerService.logError(configId, 'authWellKnownEndpoints is undefined');\n\n      return null;\n    }\n\n    const authorizationEndpoint = authWellKnownEndPoints.authorizationEndpoint;\n\n    if (!authorizationEndpoint) {\n      this.loggerService.logError(configId, `Can not create an authorize URL when authorizationEndpoint is '${authorizationEndpoint}'`);\n\n      return null;\n    }\n\n    const { clientId } = this.configurationProvider.getOpenIDConfiguration(configId);\n\n    if (!clientId) {\n      this.loggerService.logError(configId, `getAuthorizeParUrl could not add clientId because it was: `, clientId);\n\n      return null;\n    }\n\n    const urlParts = authorizationEndpoint.split('?');\n    const authorizationUrl = urlParts[0];\n    const existingParams = urlParts[1];\n    let params = this.createHttpParams(existingParams);\n\n    params = params.set('request_uri', requestUri);\n    params = params.append('client_id', clientId);\n\n    return `${authorizationUrl}?${params}`;\n  }\n\n  getAuthorizeUrl(configId: string, customParams?: { [key: string]: string | number | boolean }): string {\n    if (this.flowHelper.isCurrentFlowCodeFlow(configId)) {\n      return this.createUrlCodeFlowAuthorize(configId, customParams);\n    }\n\n    return this.createUrlImplicitFlowAuthorize(configId, customParams) || '';\n  }\n\n  createEndSessionUrl(idTokenHint: string, configId: string, customParamsEndSession?: { [p: string]: string | number | boolean }): string {\n    // Auth0 needs a special logout url\n    // See https://auth0.com/docs/api/authentication#logout\n\n    if (this.isAuth0Endpoint(configId)) {\n      return this.composeAuth0Endpoint(configId);\n    }\n\n    const authWellKnownEndPoints = this.storagePersistenceService.read('authWellKnownEndPoints', configId);\n    const endSessionEndpoint = authWellKnownEndPoints?.endSessionEndpoint;\n\n    if (!endSessionEndpoint) {\n      return null;\n    }\n\n    const urlParts = endSessionEndpoint.split('?');\n    const authorizationEndSessionUrl = urlParts[0];\n    const existingParams = urlParts[1];\n    let params = this.createHttpParams(existingParams);\n\n    params = params.set('id_token_hint', idTokenHint);\n\n    const postLogoutRedirectUri = this.getPostLogoutRedirectUrl(configId);\n\n    if (postLogoutRedirectUri) {\n      params = params.append('post_logout_redirect_uri', postLogoutRedirectUri);\n    }\n\n    if (customParamsEndSession) {\n      params = this.appendCustomParams({ ...customParamsEndSession }, params);\n    }\n\n    return `${authorizationEndSessionUrl}?${params}`;\n  }\n\n  createRevocationEndpointBodyAccessToken(token: any, configId: string): string {\n    const clientId = this.getClientId(configId);\n\n    if (!clientId) {\n      return null;\n    }\n\n    let params = this.createHttpParams();\n    params = params.set('client_id', clientId);\n    params = params.set('token', token);\n    params = params.set('token_type_hint', 'access_token');\n\n    return params.toString();\n  }\n\n  createRevocationEndpointBodyRefreshToken(token: any, configId: string): string {\n    const clientId = this.getClientId(configId);\n\n    if (!clientId) {\n      return null;\n    }\n\n    let params = this.createHttpParams();\n    params = params.set('client_id', clientId);\n    params = params.set('token', token);\n    params = params.set('token_type_hint', 'refresh_token');\n\n    return params.toString();\n  }\n\n  getRevocationEndpointUrl(configId: string): string {\n    const authWellKnownEndPoints = this.storagePersistenceService.read('authWellKnownEndPoints', configId);\n    const revocationEndpoint = authWellKnownEndPoints?.revocationEndpoint;\n\n    if (!revocationEndpoint) {\n      return null;\n    }\n\n    const urlParts = revocationEndpoint.split('?');\n\n    const revocationEndpointUrl = urlParts[0];\n\n    return revocationEndpointUrl;\n  }\n\n  createBodyForCodeFlowCodeRequest(code: string, configId: string, customTokenParams?: { [p: string]: string | number | boolean }): string {\n    const codeVerifier = this.flowsDataService.getCodeVerifier(configId);\n    if (!codeVerifier) {\n      this.loggerService.logError(configId, `CodeVerifier is not set `, codeVerifier);\n\n      return null;\n    }\n\n    const clientId = this.getClientId(configId);\n\n    if (!clientId) {\n      return null;\n    }\n\n    let params = this.createHttpParams();\n    params = params.set('grant_type', 'authorization_code');\n    params = params.set('client_id', clientId);\n    params = params.set('code_verifier', codeVerifier);\n    params = params.set('code', code);\n\n    if (customTokenParams) {\n      params = this.appendCustomParams({ ...customTokenParams }, params);\n    }\n\n    const silentRenewUrl = this.getSilentRenewUrl(configId);\n\n    if (this.flowsDataService.isSilentRenewRunning(configId) && silentRenewUrl) {\n      params = params.set('redirect_uri', silentRenewUrl);\n\n      return params.toString();\n    }\n\n    const redirectUrl = this.getRedirectUrl(configId);\n\n    if (!redirectUrl) {\n      return null;\n    }\n\n    params = params.set('redirect_uri', redirectUrl);\n\n    return params.toString();\n  }\n\n  createBodyForCodeFlowRefreshTokensRequest(\n    refreshToken: string,\n    configId: string,\n    customParamsRefresh?: { [key: string]: string | number | boolean }\n  ): string {\n    const clientId = this.getClientId(configId);\n\n    if (!clientId) {\n      return null;\n    }\n\n    let params = this.createHttpParams();\n    params = params.set('grant_type', 'refresh_token');\n    params = params.set('client_id', clientId);\n    params = params.set('refresh_token', refreshToken);\n\n    if (customParamsRefresh) {\n      params = this.appendCustomParams({ ...customParamsRefresh }, params);\n    }\n\n    return params.toString();\n  }\n\n  createBodyForParCodeFlowRequest(configId: string, customParamsRequest?: { [key: string]: string | number | boolean }): string {\n    const redirectUrl = this.getRedirectUrl(configId);\n\n    if (!redirectUrl) {\n      return null;\n    }\n\n    const state = this.flowsDataService.getExistingOrCreateAuthStateControl(configId);\n    const nonce = this.flowsDataService.createNonce(configId);\n    this.loggerService.logDebug(configId, 'Authorize created. adding myautostate: ' + state);\n\n    // code_challenge with \"S256\"\n    const codeVerifier = this.flowsDataService.createCodeVerifier(configId);\n    const codeChallenge = this.jsrsAsignReducedService.generateCodeChallenge(codeVerifier);\n\n    const { clientId, responseType, scope, hdParam, customParamsAuthRequest } = this.configurationProvider.getOpenIDConfiguration(configId);\n\n    let params = this.createHttpParams('');\n    params = params.set('client_id', clientId);\n    params = params.append('redirect_uri', redirectUrl);\n    params = params.append('response_type', responseType);\n    params = params.append('scope', scope);\n    params = params.append('nonce', nonce);\n    params = params.append('state', state);\n    params = params.append('code_challenge', codeChallenge);\n    params = params.append('code_challenge_method', 'S256');\n\n    if (hdParam) {\n      params = params.append('hd', hdParam);\n    }\n\n    if (customParamsAuthRequest) {\n      params = this.appendCustomParams({ ...customParamsAuthRequest }, params);\n    }\n\n    if (customParamsRequest) {\n      params = this.appendCustomParams({ ...customParamsRequest }, params);\n    }\n\n    return params.toString();\n  }\n\n  private createAuthorizeUrl(\n    codeChallenge: string,\n    redirectUrl: string,\n    nonce: string,\n    state: string,\n    configId: string,\n    prompt?: string,\n    customRequestParams?: { [key: string]: string | number | boolean }\n  ): string {\n    const authWellKnownEndPoints = this.storagePersistenceService.read('authWellKnownEndPoints', configId);\n    const authorizationEndpoint = authWellKnownEndPoints?.authorizationEndpoint;\n\n    if (!authorizationEndpoint) {\n      this.loggerService.logError(configId, `Can not create an authorize URL when authorizationEndpoint is '${authorizationEndpoint}'`);\n\n      return null;\n    }\n\n    const { clientId, responseType, scope, hdParam, customParamsAuthRequest } = this.configurationProvider.getOpenIDConfiguration(configId);\n\n    if (!clientId) {\n      this.loggerService.logError(configId, `createAuthorizeUrl could not add clientId because it was: `, clientId);\n\n      return null;\n    }\n\n    if (!responseType) {\n      this.loggerService.logError(configId, `createAuthorizeUrl could not add responseType because it was: `, responseType);\n\n      return null;\n    }\n\n    if (!scope) {\n      this.loggerService.logError(configId, `createAuthorizeUrl could not add scope because it was: `, scope);\n\n      return null;\n    }\n\n    const urlParts = authorizationEndpoint.split('?');\n    const authorizationUrl = urlParts[0];\n    const existingParams = urlParts[1];\n    let params = this.createHttpParams(existingParams);\n\n    params = params.set('client_id', clientId);\n    params = params.append('redirect_uri', redirectUrl);\n    params = params.append('response_type', responseType);\n    params = params.append('scope', scope);\n    params = params.append('nonce', nonce);\n    params = params.append('state', state);\n\n    if (this.flowHelper.isCurrentFlowCodeFlow(configId)) {\n      params = params.append('code_challenge', codeChallenge);\n      params = params.append('code_challenge_method', 'S256');\n    }\n\n    const mergedParams = { ...customParamsAuthRequest, ...customRequestParams };\n\n    if (Object.keys(mergedParams).length > 0) {\n      params = this.appendCustomParams({ ...mergedParams }, params);\n    }\n\n    if (prompt) {\n      params = this.overWriteParam(params, 'prompt', prompt);\n    }\n\n    if (hdParam) {\n      params = params.append('hd', hdParam);\n    }\n\n    return `${authorizationUrl}?${params}`;\n  }\n\n  private createUrlImplicitFlowWithSilentRenew(configId: string, customParams?: { [key: string]: string | number | boolean }): string {\n    const state = this.flowsDataService.getExistingOrCreateAuthStateControl(configId);\n    const nonce = this.flowsDataService.createNonce(configId);\n\n    const silentRenewUrl = this.getSilentRenewUrl(configId);\n\n    if (!silentRenewUrl) {\n      return null;\n    }\n\n    this.loggerService.logDebug(configId, 'RefreshSession created. adding myautostate: ', state);\n\n    const authWellKnownEndPoints = this.storagePersistenceService.read('authWellKnownEndPoints', configId);\n    if (authWellKnownEndPoints) {\n      return this.createAuthorizeUrl('', silentRenewUrl, nonce, state, configId, 'none', customParams);\n    }\n\n    this.loggerService.logError(configId, 'authWellKnownEndpoints is undefined');\n\n    return null;\n  }\n\n  private createUrlCodeFlowWithSilentRenew(configId: string, customParams?: { [key: string]: string | number | boolean }): string {\n    const state = this.flowsDataService.getExistingOrCreateAuthStateControl(configId);\n    const nonce = this.flowsDataService.createNonce(configId);\n\n    this.loggerService.logDebug(configId, 'RefreshSession created. adding myautostate: ' + state);\n\n    // code_challenge with \"S256\"\n    const codeVerifier = this.flowsDataService.createCodeVerifier(configId);\n    const codeChallenge = this.jsrsAsignReducedService.generateCodeChallenge(codeVerifier);\n\n    const silentRenewUrl = this.getSilentRenewUrl(configId);\n\n    if (!silentRenewUrl) {\n      return null;\n    }\n\n    const authWellKnownEndPoints = this.storagePersistenceService.read('authWellKnownEndPoints', configId);\n    if (authWellKnownEndPoints) {\n      return this.createAuthorizeUrl(codeChallenge, silentRenewUrl, nonce, state, configId, 'none', customParams);\n    }\n\n    this.loggerService.logWarning(configId, 'authWellKnownEndpoints is undefined');\n\n    return null;\n  }\n\n  private createUrlImplicitFlowAuthorize(configId: string, customParams?: { [key: string]: string | number | boolean }): string {\n    const state = this.flowsDataService.getExistingOrCreateAuthStateControl(configId);\n    const nonce = this.flowsDataService.createNonce(configId);\n    this.loggerService.logDebug(configId, 'Authorize created. adding myautostate: ' + state);\n\n    const redirectUrl = this.getRedirectUrl(configId);\n\n    if (!redirectUrl) {\n      return null;\n    }\n\n    const authWellKnownEndPoints = this.storagePersistenceService.read('authWellKnownEndPoints', configId);\n    if (authWellKnownEndPoints) {\n      return this.createAuthorizeUrl('', redirectUrl, nonce, state, configId, null, customParams);\n    }\n\n    this.loggerService.logError(configId, 'authWellKnownEndpoints is undefined');\n\n    return null;\n  }\n\n  private createUrlCodeFlowAuthorize(configId: string, customParams?: { [key: string]: string | number | boolean }): string {\n    const state = this.flowsDataService.getExistingOrCreateAuthStateControl(configId);\n    const nonce = this.flowsDataService.createNonce(configId);\n    this.loggerService.logDebug(configId, 'Authorize created. adding myautostate: ' + state);\n\n    const redirectUrl = this.getRedirectUrl(configId);\n\n    if (!redirectUrl) {\n      return null;\n    }\n\n    // code_challenge with \"S256\"\n    const codeVerifier = this.flowsDataService.createCodeVerifier(configId);\n    const codeChallenge = this.jsrsAsignReducedService.generateCodeChallenge(codeVerifier);\n\n    const authWellKnownEndPoints = this.storagePersistenceService.read('authWellKnownEndPoints', configId);\n    if (authWellKnownEndPoints) {\n      return this.createAuthorizeUrl(codeChallenge, redirectUrl, nonce, state, configId, null, customParams);\n    }\n\n    this.loggerService.logError(configId, 'authWellKnownEndpoints is undefined');\n\n    return null;\n  }\n\n  private getRedirectUrl(configId: string): string {\n    const { redirectUrl } = this.configurationProvider.getOpenIDConfiguration(configId);\n\n    if (!redirectUrl) {\n      this.loggerService.logError(configId, `could not get redirectUrl, was: `, redirectUrl);\n\n      null;\n    }\n\n    return redirectUrl;\n  }\n\n  private getSilentRenewUrl(configId: string): string {\n    const { silentRenewUrl } = this.configurationProvider.getOpenIDConfiguration(configId);\n\n    if (!silentRenewUrl) {\n      this.loggerService.logError(configId, `could not get silentRenewUrl, was: `, silentRenewUrl);\n\n      return null;\n    }\n\n    return silentRenewUrl;\n  }\n\n  private getPostLogoutRedirectUrl(configId: string): string {\n    const { postLogoutRedirectUri } = this.configurationProvider.getOpenIDConfiguration(configId);\n\n    if (!postLogoutRedirectUri) {\n      this.loggerService.logError(configId, `could not get postLogoutRedirectUri, was: `, postLogoutRedirectUri);\n\n      return null;\n    }\n\n    return postLogoutRedirectUri;\n  }\n\n  private getClientId(configId: string): string {\n    const { clientId } = this.configurationProvider.getOpenIDConfiguration(configId);\n\n    if (!clientId) {\n      this.loggerService.logError(configId, `could not get clientId, was: `, clientId);\n\n      return null;\n    }\n\n    return clientId;\n  }\n\n  private appendCustomParams(customParams: { [key: string]: string | number | boolean }, params: HttpParams): HttpParams {\n    for (const [key, value] of Object.entries({ ...customParams })) {\n      params = params.append(key, value.toString());\n    }\n\n    return params;\n  }\n\n  private overWriteParam(params: HttpParams, key: string, value: string | number | boolean): HttpParams {\n    return params.set(key, value);\n  }\n\n  private createHttpParams(existingParams?: string): HttpParams {\n    existingParams = existingParams ?? '';\n\n    const params = new HttpParams({\n      fromString: existingParams,\n      encoder: new UriEncoder(),\n    });\n\n    return params;\n  }\n\n  private isAuth0Endpoint(configId: string): boolean {\n    const { authority } = this.configurationProvider.getOpenIDConfiguration(configId);\n\n    if (!authority) {\n      return false;\n    }\n\n    return authority.endsWith(AUTH0_ENDPOINT);\n  }\n\n  private composeAuth0Endpoint(configId: string): string {\n    // format: https://YOUR_DOMAIN/v2/logout?client_id=YOUR_CLIENT_ID&returnTo=LOGOUT_URL\n    const { authority, clientId } = this.configurationProvider.getOpenIDConfiguration(configId);\n    const postLogoutRedirectUrl = this.getPostLogoutRedirectUrl(configId);\n\n    return `${authority}/v2/logout?client_id=${clientId}&returnTo=${postLogoutRedirectUrl}`;\n  }\n}\n","import { HttpErrorResponse, HttpHeaders } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable, of, throwError, timer } from 'rxjs';\nimport { catchError, mergeMap, retryWhen, switchMap } from 'rxjs/operators';\nimport { DataService } from '../../api/data.service';\nimport { ConfigurationProvider } from '../../config/provider/config.provider';\nimport { LoggerService } from '../../logging/logger.service';\nimport { StoragePersistenceService } from '../../storage/storage-persistence.service';\nimport { UrlService } from '../../utils/url/url.service';\nimport { TokenValidationService } from '../../validation/token-validation.service';\nimport { CallbackContext } from '../callback-context';\nimport { FlowsDataService } from '../flows-data.service';\n\n@Injectable()\nexport class CodeFlowCallbackHandlerService {\n  constructor(\n    private readonly urlService: UrlService,\n    private readonly loggerService: LoggerService,\n    private readonly tokenValidationService: TokenValidationService,\n    private readonly flowsDataService: FlowsDataService,\n    private readonly configurationProvider: ConfigurationProvider,\n    private readonly storagePersistenceService: StoragePersistenceService,\n    private readonly dataService: DataService\n  ) {}\n\n  // STEP 1 Code Flow\n  codeFlowCallback(urlToCheck: string, configId: string): Observable<CallbackContext> {\n    const code = this.urlService.getUrlParameter(urlToCheck, 'code');\n    const state = this.urlService.getUrlParameter(urlToCheck, 'state');\n    const sessionState = this.urlService.getUrlParameter(urlToCheck, 'session_state');\n\n    if (!state) {\n      this.loggerService.logDebug(configId, 'no state in url');\n\n      return throwError('no state in url');\n    }\n\n    if (!code) {\n      this.loggerService.logDebug(configId, 'no code in url');\n\n      return throwError('no code in url');\n    }\n\n    this.loggerService.logDebug(configId, 'running validation for callback', urlToCheck);\n\n    const initialCallbackContext = {\n      code,\n      refreshToken: null,\n      state,\n      sessionState,\n      authResult: null,\n      isRenewProcess: false,\n      jwtKeys: null,\n      validationResult: null,\n      existingIdToken: null,\n    };\n\n    return of(initialCallbackContext);\n  }\n\n  // STEP 2 Code Flow //  Code Flow Silent Renew starts here\n  codeFlowCodeRequest(callbackContext: CallbackContext, configId: string): Observable<CallbackContext> {\n    const authStateControl = this.flowsDataService.getAuthStateControl(configId);\n\n    const isStateCorrect = this.tokenValidationService.validateStateFromHashCallback(callbackContext.state, authStateControl, configId);\n\n    if (!isStateCorrect) {\n      return throwError('codeFlowCodeRequest incorrect state');\n    }\n\n    const authWellknownEndpoints = this.storagePersistenceService.read('authWellKnownEndPoints', configId);\n    const tokenEndpoint = authWellknownEndpoints?.tokenEndpoint;\n    if (!tokenEndpoint) {\n      return throwError('Token Endpoint not defined');\n    }\n\n    let headers: HttpHeaders = new HttpHeaders();\n    headers = headers.set('Content-Type', 'application/x-www-form-urlencoded');\n\n    const config = this.configurationProvider.getOpenIDConfiguration(configId);\n\n    const bodyForCodeFlow = this.urlService.createBodyForCodeFlowCodeRequest(\n      callbackContext.code,\n      configId,\n      config?.customParamsCodeRequest\n    );\n\n    return this.dataService.post(tokenEndpoint, bodyForCodeFlow, configId, headers).pipe(\n      switchMap((response) => {\n        let authResult: any = new Object();\n        authResult = response;\n        authResult.state = callbackContext.state;\n        authResult.session_state = callbackContext.sessionState;\n\n        callbackContext.authResult = authResult;\n\n        return of(callbackContext);\n      }),\n      retryWhen((error) => this.handleRefreshRetry(error, configId)),\n      catchError((error) => {\n        const { authority } = this.configurationProvider.getOpenIDConfiguration(configId);\n        const errorMessage = `OidcService code request ${authority}`;\n        this.loggerService.logError(configId, errorMessage, error);\n\n        return throwError(errorMessage);\n      })\n    );\n  }\n\n  private handleRefreshRetry(errors: Observable<any>, configId: string): Observable<any> {\n    return errors.pipe(\n      mergeMap((error) => {\n        // retry token refresh if there is no internet connection\n        if (error && error instanceof HttpErrorResponse && error.error instanceof ProgressEvent && error.error.type === 'error') {\n          const { authority, refreshTokenRetryInSeconds } = this.configurationProvider.getOpenIDConfiguration(configId);\n          const errorMessage = `OidcService code request ${authority} - no internet connection`;\n          this.loggerService.logWarning(configId, errorMessage, error);\n\n          return timer(refreshTokenRetryInSeconds * 1000);\n        }\n\n        return throwError(error);\n      })\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { BehaviorSubject, Observable, of, throwError } from 'rxjs';\nimport { map, retry, switchMap } from 'rxjs/operators';\nimport { DataService } from '../api/data.service';\nimport { OpenIdConfiguration } from '../config/openid-configuration';\nimport { ConfigurationProvider } from '../config/provider/config.provider';\nimport { LoggerService } from '../logging/logger.service';\nimport { EventTypes } from '../public-events/event-types';\nimport { PublicEventsService } from '../public-events/public-events.service';\nimport { StoragePersistenceService } from '../storage/storage-persistence.service';\nimport { FlowHelper } from '../utils/flowHelper/flow-helper.service';\nimport { TokenHelperService } from '../utils/tokenHelper/token-helper.service';\nimport { ConfigUserDataResult, UserDataResult } from './userdata-result';\n\nconst DEFAULT_USERRESULT = { userData: null, allUserData: [] };\n@Injectable()\nexport class UserService {\n  private userDataInternal$ = new BehaviorSubject<UserDataResult>(DEFAULT_USERRESULT);\n\n  get userData$(): Observable<UserDataResult> {\n    return this.userDataInternal$.asObservable();\n  }\n\n  constructor(\n    private oidcDataService: DataService,\n    private storagePersistenceService: StoragePersistenceService,\n    private eventService: PublicEventsService,\n    private loggerService: LoggerService,\n    private tokenHelperService: TokenHelperService,\n    private flowHelper: FlowHelper,\n    private configurationProvider: ConfigurationProvider\n  ) {}\n\n  getAndPersistUserDataInStore(configId: string, isRenewProcess = false, idToken?: any, decodedIdToken?: any): Observable<any> {\n    idToken = idToken || this.storagePersistenceService.getIdToken(configId);\n    decodedIdToken = decodedIdToken || this.tokenHelperService.getPayloadFromToken(idToken, false, configId);\n\n    const existingUserDataFromStorage = this.getUserDataFromStore(configId);\n    const haveUserData = !!existingUserDataFromStorage;\n    const isCurrentFlowImplicitFlowWithAccessToken = this.flowHelper.isCurrentFlowImplicitFlowWithAccessToken(configId);\n    const isCurrentFlowCodeFlow = this.flowHelper.isCurrentFlowCodeFlow(configId);\n\n    const accessToken = this.storagePersistenceService.getAccessToken(configId);\n    if (!(isCurrentFlowImplicitFlowWithAccessToken || isCurrentFlowCodeFlow)) {\n      this.loggerService.logDebug(configId, `authCallback idToken flow with accessToken ${accessToken}`);\n\n      this.setUserDataToStore(decodedIdToken, configId);\n\n      return of(decodedIdToken);\n    }\n\n    const { renewUserInfoAfterTokenRenew } = this.configurationProvider.getOpenIDConfiguration(configId);\n\n    if (!isRenewProcess || renewUserInfoAfterTokenRenew || !haveUserData) {\n      return this.getUserDataOidcFlowAndSave(decodedIdToken.sub, configId).pipe(\n        switchMap((userData) => {\n          this.loggerService.logDebug(configId, 'Received user data: ', userData);\n          if (!!userData) {\n            this.loggerService.logDebug(configId, 'accessToken: ', accessToken);\n\n            return of(userData);\n          } else {\n            return throwError('Received no user data, request failed');\n          }\n        })\n      );\n    }\n\n    return of(existingUserDataFromStorage);\n  }\n\n  getUserDataFromStore(configId: string): any {\n    return this.storagePersistenceService.read('userData', configId) || null;\n  }\n\n  publishUserDataIfExists(configId: string): void {\n    const userData = this.getUserDataFromStore(configId);\n\n    if (userData) {\n      this.fireUserDataEvent(configId, userData);\n    }\n  }\n\n  setUserDataToStore(userData: any, configId: string): void {\n    this.storagePersistenceService.write('userData', userData, configId);\n    this.fireUserDataEvent(configId, userData);\n  }\n\n  resetUserDataInStore(configId: string): void {\n    this.storagePersistenceService.remove('userData', configId);\n    this.fireUserDataEvent(configId, null);\n  }\n\n  private getUserDataOidcFlowAndSave(idTokenSub: any, configId: string): Observable<any> {\n    return this.getIdentityUserData(configId).pipe(\n      map((data: any) => {\n        if (this.validateUserDataSubIdToken(idTokenSub, data?.sub)) {\n          this.setUserDataToStore(data, configId);\n\n          return data;\n        } else {\n          // something went wrong, user data sub does not match that from id_token\n          this.loggerService.logWarning(configId, `User data sub does not match sub in id_token, resetting`);\n          this.resetUserDataInStore(configId);\n\n          return null;\n        }\n      })\n    );\n  }\n\n  private getIdentityUserData(configId: string): Observable<any> {\n    const token = this.storagePersistenceService.getAccessToken(configId);\n\n    const authWellKnownEndPoints = this.storagePersistenceService.read('authWellKnownEndPoints', configId);\n\n    if (!authWellKnownEndPoints) {\n      this.loggerService.logWarning(configId, 'init check session: authWellKnownEndpoints is undefined');\n\n      return throwError('authWellKnownEndpoints is undefined');\n    }\n\n    const userInfoEndpoint = authWellKnownEndPoints.userInfoEndpoint;\n\n    if (!userInfoEndpoint) {\n      this.loggerService.logError(\n        configId,\n        'init check session: authWellKnownEndpoints.userinfo_endpoint is undefined; set auto_userinfo = false in config'\n      );\n\n      return throwError('authWellKnownEndpoints.userinfo_endpoint is undefined');\n    }\n\n    return this.oidcDataService.get(userInfoEndpoint, configId, token).pipe(retry(2));\n  }\n\n  private validateUserDataSubIdToken(idTokenSub: any, userDataSub: any): boolean {\n    if (!idTokenSub) {\n      return false;\n    }\n\n    if (!userDataSub) {\n      return false;\n    }\n\n    if ((idTokenSub as string) !== (userDataSub as string)) {\n      this.loggerService.logDebug('validateUserDataSubIdToken failed', idTokenSub, userDataSub);\n\n      return false;\n    }\n\n    return true;\n  }\n\n  private fireUserDataEvent(configId: string, passedUserData: any): void {\n    const userData = this.composeSingleOrMultipleUserDataObject(configId, passedUserData);\n\n    this.userDataInternal$.next(userData);\n\n    this.eventService.fireEvent(EventTypes.UserDataChanged, { configId, userData: passedUserData });\n  }\n\n  private composeSingleOrMultipleUserDataObject(configId: string, passedUserData: any): UserDataResult {\n    const hasManyConfigs = this.configurationProvider.hasManyConfigs();\n\n    if (!hasManyConfigs) {\n      return this.composeSingleUserDataResult(configId, passedUserData);\n    }\n\n    const configs = this.configurationProvider.getAllConfigurations();\n\n    const allUserData: ConfigUserDataResult[] = configs.map((config) => {\n      if (this.currentConfigIsToUpdate(configId, config)) {\n        return { configId: config.configId, userData: passedUserData };\n      }\n\n      const alreadySavedUserData = this.storagePersistenceService.read('userData', config.configId) || null;\n\n      return { configId: config.configId, userData: alreadySavedUserData };\n    });\n\n    return {\n      userData: null,\n      allUserData,\n    };\n  }\n\n  private composeSingleUserDataResult(configId: string, userData: any): UserDataResult {\n    return {\n      userData,\n      allUserData: [{ configId, userData }],\n    };\n  }\n\n  private currentConfigIsToUpdate(configId: string, config: OpenIdConfiguration): boolean {\n    return config.configId === configId;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { AuthStateService } from '../auth-state/auth-state.service';\nimport { UserService } from '../user-data/user.service';\nimport { FlowsDataService } from './flows-data.service';\n\n@Injectable()\nexport class ResetAuthDataService {\n  constructor(\n    private readonly authStateService: AuthStateService,\n    private readonly flowsDataService: FlowsDataService,\n    private readonly userService: UserService\n  ) {}\n\n  resetAuthorizationData(configId: string): void {\n    this.userService.resetUserDataInStore(configId);\n    this.flowsDataService.resetStorageFlowData(configId);\n    this.authStateService.setUnauthenticatedAndFireEvent(configId);\n  }\n}\n","import { DOCUMENT } from '@angular/common';\nimport { Inject, Injectable } from '@angular/core';\nimport { Observable, of } from 'rxjs';\nimport { LoggerService } from '../../logging/logger.service';\nimport { CallbackContext } from '../callback-context';\nimport { FlowsDataService } from '../flows-data.service';\nimport { ResetAuthDataService } from '../reset-auth-data.service';\n\n@Injectable()\nexport class ImplicitFlowCallbackHandlerService {\n  constructor(\n    private readonly resetAuthDataService: ResetAuthDataService,\n    private readonly loggerService: LoggerService,\n    private readonly flowsDataService: FlowsDataService,\n    @Inject(DOCUMENT) private readonly doc: any\n  ) {}\n\n  // STEP 1 Code Flow\n  // STEP 1 Implicit Flow\n  implicitFlowCallback(configId: string, hash?: string): Observable<CallbackContext> {\n    const isRenewProcessData = this.flowsDataService.isSilentRenewRunning(configId);\n\n    this.loggerService.logDebug(configId, 'BEGIN callback, no auth data');\n    if (!isRenewProcessData) {\n      this.resetAuthDataService.resetAuthorizationData(configId);\n    }\n\n    hash = hash || this.doc.location.hash.substr(1);\n\n    const authResult: any = hash.split('&').reduce((resultData: any, item: string) => {\n      const parts = item.split('=');\n      resultData[parts.shift() as string] = parts.join('=');\n\n      return resultData;\n    }, {});\n\n    const callbackContext = {\n      code: null,\n      refreshToken: null,\n      state: null,\n      sessionState: null,\n      authResult,\n      isRenewProcess: isRenewProcessData,\n      jwtKeys: null,\n      validationResult: null,\n      existingIdToken: null,\n    };\n\n    return of(callbackContext);\n  }\n}\n","/* eslint-disable no-shadow */\nexport enum ValidationResult {\n  NotSet = 'NotSet',\n  StatesDoNotMatch = 'StatesDoNotMatch',\n  SignatureFailed = 'SignatureFailed',\n  IncorrectNonce = 'IncorrectNonce',\n  RequiredPropertyMissing = 'RequiredPropertyMissing',\n  MaxOffsetExpired = 'MaxOffsetExpired',\n  IssDoesNotMatchIssuer = 'IssDoesNotMatchIssuer',\n  NoAuthWellKnownEndPoints = 'NoAuthWellKnownEndPoints',\n  IncorrectAud = 'IncorrectAud',\n  IncorrectIdTokenClaimsAfterRefresh = 'IncorrectIdTokenClaimsAfterRefresh',\n  IncorrectAzp = 'IncorrectAzp',\n  TokenExpired = 'TokenExpired',\n  IncorrectAtHash = 'IncorrectAtHash',\n  Ok = 'Ok',\n  LoginRequired = 'LoginRequired',\n  SecureTokenServerError = 'SecureTokenServerError',\n}\n","import { HttpResponse } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable, throwError } from 'rxjs';\nimport { catchError, retry } from 'rxjs/operators';\nimport { DataService } from '../api/data.service';\nimport { LoggerService } from '../logging/logger.service';\nimport { StoragePersistenceService } from '../storage/storage-persistence.service';\nimport { JwtKeys } from '../validation/jwtkeys';\n\n@Injectable()\nexport class SigninKeyDataService {\n  constructor(\n    private storagePersistenceService: StoragePersistenceService,\n    private loggerService: LoggerService,\n    private dataService: DataService\n  ) {}\n\n  getSigningKeys(configId: string): Observable<JwtKeys> {\n    const authWellKnownEndPoints = this.storagePersistenceService.read('authWellKnownEndPoints', configId);\n    const jwksUri = authWellKnownEndPoints?.jwksUri;\n    if (!jwksUri) {\n      const error = `getSigningKeys: authWellKnownEndpoints.jwksUri is: '${jwksUri}'`;\n      this.loggerService.logWarning(configId, error);\n\n      return throwError(error);\n    }\n\n    this.loggerService.logDebug(configId, 'Getting signinkeys from ', jwksUri);\n\n    return this.dataService.get<JwtKeys>(jwksUri, configId).pipe(\n      retry(2),\n      catchError((e) => this.handleErrorGetSigningKeys(e, configId))\n    );\n  }\n\n  private handleErrorGetSigningKeys(errorResponse: HttpResponse<any> | any, configId: string): Observable<never> {\n    let errMsg = '';\n    if (errorResponse instanceof HttpResponse) {\n      const body = errorResponse.body || {};\n      const err = JSON.stringify(body);\n      const { status, statusText } = errorResponse;\n      errMsg = `${status || ''} - ${statusText || ''} ${err || ''}`;\n    } else {\n      const { message } = errorResponse;\n      errMsg = !!message ? message : `${errorResponse}`;\n    }\n    this.loggerService.logError(configId, errMsg);\n\n    return throwError(errMsg);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable, of, throwError } from 'rxjs';\nimport { catchError, switchMap, tap } from 'rxjs/operators';\nimport { AuthStateService } from '../../auth-state/auth-state.service';\nimport { ConfigurationProvider } from '../../config/provider/config.provider';\nimport { LoggerService } from '../../logging/logger.service';\nimport { StoragePersistenceService } from '../../storage/storage-persistence.service';\nimport { JwtKeys } from '../../validation/jwtkeys';\nimport { ValidationResult } from '../../validation/validation-result';\nimport { CallbackContext } from '../callback-context';\nimport { FlowsDataService } from '../flows-data.service';\nimport { ResetAuthDataService } from '../reset-auth-data.service';\nimport { SigninKeyDataService } from '../signin-key-data.service';\n\nconst JWT_KEYS = 'jwtKeys';\n\n@Injectable()\nexport class HistoryJwtKeysCallbackHandlerService {\n  constructor(\n    private readonly loggerService: LoggerService,\n    private readonly configurationProvider: ConfigurationProvider,\n    private readonly authStateService: AuthStateService,\n    private readonly flowsDataService: FlowsDataService,\n    private readonly signInKeyDataService: SigninKeyDataService,\n    private readonly storagePersistenceService: StoragePersistenceService,\n    private readonly resetAuthDataService: ResetAuthDataService\n  ) {}\n\n  // STEP 3 Code Flow, STEP 2 Implicit Flow, STEP 3 Refresh Token\n  callbackHistoryAndResetJwtKeys(callbackContext: CallbackContext, configId: string): Observable<CallbackContext> {\n    this.storagePersistenceService.write('authnResult', callbackContext.authResult, configId);\n\n    if (this.historyCleanUpTurnedOn(configId) && !callbackContext.isRenewProcess) {\n      this.resetBrowserHistory();\n    } else {\n      this.loggerService.logDebug(configId, 'history clean up inactive');\n    }\n\n    if (callbackContext.authResult.error) {\n      const errorMessage = `AuthCallback AuthResult came with error: ${callbackContext.authResult.error}`;\n      this.loggerService.logDebug(configId, errorMessage);\n      this.resetAuthDataService.resetAuthorizationData(configId);\n      this.flowsDataService.setNonce('', configId);\n      this.handleResultErrorFromCallback(callbackContext.authResult, callbackContext.isRenewProcess);\n\n      return throwError(errorMessage);\n    }\n\n    this.loggerService.logDebug(\n      configId,\n      `AuthResult '${JSON.stringify(callbackContext.authResult, null, 2)}'.\n      AuthCallback created, begin token validation`\n    );\n\n    return this.signInKeyDataService.getSigningKeys(configId).pipe(\n      tap((jwtKeys: JwtKeys) => this.storeSigningKeys(jwtKeys, configId)),\n      catchError((err) => {\n        // fallback: try to load jwtKeys from storage\n        const storedJwtKeys = this.readSigningKeys(configId);\n        if (!!storedJwtKeys) {\n          this.loggerService.logWarning(configId, `Failed to retrieve signing keys, fallback to stored keys`);\n\n          return of(storedJwtKeys);\n        }\n\n        return throwError(err);\n      }),\n      switchMap((jwtKeys) => {\n        if (jwtKeys) {\n          callbackContext.jwtKeys = jwtKeys;\n\n          return of(callbackContext);\n        }\n\n        const errorMessage = `Failed to retrieve signing key`;\n        this.loggerService.logWarning(configId, errorMessage);\n\n        return throwError(errorMessage);\n      }),\n      catchError((err) => {\n        const errorMessage = `Failed to retrieve signing key with error: ${err}`;\n        this.loggerService.logWarning(configId, errorMessage);\n\n        return throwError(errorMessage);\n      })\n    );\n  }\n\n  private handleResultErrorFromCallback(result: any, isRenewProcess: boolean): void {\n    let validationResult = ValidationResult.SecureTokenServerError;\n\n    if ((result.error as string) === 'login_required') {\n      validationResult = ValidationResult.LoginRequired;\n    }\n\n    this.authStateService.updateAndPublishAuthState({\n      isAuthenticated: false,\n      validationResult,\n      isRenewProcess,\n    });\n  }\n\n  private historyCleanUpTurnedOn(configId: string): boolean {\n    const { historyCleanupOff } = this.configurationProvider.getOpenIDConfiguration(configId);\n\n    return !historyCleanupOff;\n  }\n\n  private resetBrowserHistory(): void {\n    window.history.replaceState({}, window.document.title, window.location.origin + window.location.pathname);\n  }\n\n  private storeSigningKeys(jwtKeys: JwtKeys, configId: string): void {\n    this.storagePersistenceService.write(JWT_KEYS, jwtKeys, configId);\n  }\n\n  private readSigningKeys(configId: string): any {\n    return this.storagePersistenceService.read(JWT_KEYS, configId);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable, of, throwError } from 'rxjs';\nimport { catchError, switchMap } from 'rxjs/operators';\nimport { AuthStateService } from '../../auth-state/auth-state.service';\nimport { ConfigurationProvider } from '../../config/provider/config.provider';\nimport { LoggerService } from '../../logging/logger.service';\nimport { UserService } from '../../user-data/user.service';\nimport { StateValidationResult } from '../../validation/state-validation-result';\nimport { CallbackContext } from '../callback-context';\nimport { FlowsDataService } from '../flows-data.service';\nimport { ResetAuthDataService } from '../reset-auth-data.service';\n\n@Injectable()\nexport class UserCallbackHandlerService {\n  constructor(\n    private readonly loggerService: LoggerService,\n    private readonly configurationProvider: ConfigurationProvider,\n    private readonly authStateService: AuthStateService,\n    private readonly flowsDataService: FlowsDataService,\n    private readonly userService: UserService,\n    private readonly resetAuthDataService: ResetAuthDataService\n  ) {}\n\n  // STEP 5 userData\n  callbackUser(callbackContext: CallbackContext, configId: string): Observable<CallbackContext> {\n    const { isRenewProcess, validationResult, authResult, refreshToken } = callbackContext;\n    const { autoUserInfo, renewUserInfoAfterTokenRenew } = this.configurationProvider.getOpenIDConfiguration(configId);\n\n    if (!autoUserInfo) {\n      if (!isRenewProcess || renewUserInfoAfterTokenRenew) {\n        // userData is set to the id_token decoded, auto get user data set to false\n        if (validationResult.decodedIdToken) {\n          this.userService.setUserDataToStore(validationResult.decodedIdToken, configId);\n        }\n      }\n\n      if (!isRenewProcess && !refreshToken) {\n        this.flowsDataService.setSessionState(authResult.session_state, configId);\n      }\n\n      this.publishAuthState(validationResult, isRenewProcess);\n\n      return of(callbackContext);\n    }\n\n    return this.userService\n      .getAndPersistUserDataInStore(configId, isRenewProcess, validationResult.idToken, validationResult.decodedIdToken)\n      .pipe(\n        switchMap((userData) => {\n          if (!!userData) {\n            if (!refreshToken) {\n              this.flowsDataService.setSessionState(authResult.session_state, configId);\n            }\n\n            this.publishAuthState(validationResult, isRenewProcess);\n\n            return of(callbackContext);\n          } else {\n            this.resetAuthDataService.resetAuthorizationData(configId);\n            this.publishUnauthenticatedState(validationResult, isRenewProcess);\n            const errorMessage = `Called for userData but they were ${userData}`;\n            this.loggerService.logWarning(configId, errorMessage);\n\n            return throwError(errorMessage);\n          }\n        }),\n        catchError((err) => {\n          const errorMessage = `Failed to retrieve user info with error:  ${err}`;\n          this.loggerService.logWarning(configId, errorMessage);\n\n          return throwError(errorMessage);\n        })\n      );\n  }\n\n  private publishAuthState(stateValidationResult: StateValidationResult, isRenewProcess: boolean): void {\n    this.authStateService.updateAndPublishAuthState({\n      isAuthenticated: true,\n      validationResult: stateValidationResult.state,\n      isRenewProcess,\n    });\n  }\n\n  private publishUnauthenticatedState(stateValidationResult: StateValidationResult, isRenewProcess: boolean): void {\n    this.authStateService.updateAndPublishAuthState({\n      isAuthenticated: false,\n      validationResult: stateValidationResult.state,\n      isRenewProcess,\n    });\n  }\n}\n","import { ValidationResult } from './validation-result';\n\nexport class StateValidationResult {\n  constructor(\n    public accessToken = '',\n    public idToken = '',\n    public authResponseIsValid = false,\n    public decodedIdToken: any = {},\n    public state: ValidationResult = ValidationResult.NotSet\n  ) {}\n}\n","import { Injectable } from '@angular/core';\n\n@Injectable()\nexport class EqualityService {\n  isStringEqualOrNonOrderedArrayEqual(value1: string | any[], value2: string | any[]): boolean {\n    if (this.isNullOrUndefined(value1)) {\n      return false;\n    }\n\n    if (this.isNullOrUndefined(value2)) {\n      return false;\n    }\n\n    if (this.oneValueIsStringAndTheOtherIsArray(value1, value2)) {\n      return false;\n    }\n\n    if (this.bothValuesAreStrings(value1, value2)) {\n      return value1 === value2;\n    }\n\n    if (this.bothValuesAreArrays(value1, value2)) {\n      return this.arraysHaveEqualContent(value1 as any[], value2 as any[]);\n    }\n\n    return false;\n  }\n\n  areEqual(value1: string | any[] | any | null | undefined, value2: string | any[] | any | null | undefined): boolean {\n    if (!value1 || !value2) {\n      return false;\n    }\n\n    if (this.bothValuesAreArrays(value1, value2)) {\n      return this.arraysStrictEqual(value1 as any[], value2 as any[]);\n    }\n\n    if (this.bothValuesAreStrings(value1, value2)) {\n      return value1 === value2;\n    }\n\n    if (this.bothValuesAreObjects(value1, value2)) {\n      return JSON.stringify(value1).toLowerCase() === JSON.stringify(value2).toLowerCase();\n    }\n\n    if (this.oneValueIsStringAndTheOtherIsArray(value1, value2)) {\n      if (Array.isArray(value1) && this.valueIsString(value2)) {\n        return value1[0] === value2;\n      }\n      if (Array.isArray(value2) && this.valueIsString(value1)) {\n        return value2[0] === value1;\n      }\n    }\n\n    return false;\n  }\n\n  private oneValueIsStringAndTheOtherIsArray(value1: string | any | any[], value2: string | any | any[]): boolean {\n    return (Array.isArray(value1) && this.valueIsString(value2)) || (Array.isArray(value2) && this.valueIsString(value1));\n  }\n\n  private bothValuesAreObjects(value1: string | any | any[], value2: string | any | any[]): boolean {\n    return this.valueIsObject(value1) && this.valueIsObject(value2);\n  }\n\n  private bothValuesAreStrings(value1: string | any | any[], value2: string | any | any[]): boolean {\n    return this.valueIsString(value1) && this.valueIsString(value2);\n  }\n\n  private bothValuesAreArrays(value1: string | any | any[], value2: string | any | any[]): boolean {\n    return Array.isArray(value1) && Array.isArray(value2);\n  }\n\n  private valueIsString(value: any): boolean {\n    return typeof value === 'string' || value instanceof String;\n  }\n\n  private valueIsObject(value: any): boolean {\n    return typeof value === 'object';\n  }\n\n  private arraysStrictEqual(arr1: Array<string>, arr2: Array<string>): boolean {\n    if (arr1.length !== arr2.length) {\n      return false;\n    }\n\n    for (let i = arr1.length; i--; ) {\n      if (arr1[i] !== arr2[i]) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  private arraysHaveEqualContent(arr1: Array<string>, arr2: Array<string>): boolean {\n    if (arr1.length !== arr2.length) {\n      return false;\n    }\n\n    return arr1.some((v) => arr2.includes(v));\n  }\n\n  private isNullOrUndefined(val: any): boolean {\n    return val === null || val === undefined;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { ConfigurationProvider } from '../config/provider/config.provider';\nimport { CallbackContext } from '../flows/callback-context';\nimport { LoggerService } from '../logging/logger.service';\nimport { StoragePersistenceService } from '../storage/storage-persistence.service';\nimport { EqualityService } from '../utils/equality/equality.service';\nimport { FlowHelper } from '../utils/flowHelper/flow-helper.service';\nimport { TokenHelperService } from '../utils/tokenHelper/token-helper.service';\nimport { StateValidationResult } from './state-validation-result';\nimport { TokenValidationService } from './token-validation.service';\nimport { ValidationResult } from './validation-result';\n\n@Injectable()\nexport class StateValidationService {\n  constructor(\n    private storagePersistenceService: StoragePersistenceService,\n    private tokenValidationService: TokenValidationService,\n    private tokenHelperService: TokenHelperService,\n    private loggerService: LoggerService,\n    private configurationProvider: ConfigurationProvider,\n    private equalityService: EqualityService,\n    private flowHelper: FlowHelper\n  ) {}\n\n  getValidatedStateResult(callbackContext: CallbackContext, configId: string): StateValidationResult {\n    if (!callbackContext) {\n      return new StateValidationResult('', '', false, {});\n    }\n\n    if (callbackContext.authResult.error) {\n      return new StateValidationResult('', '', false, {});\n    }\n\n    return this.validateState(callbackContext, configId);\n  }\n\n  validateState(callbackContext: any, configId: string): StateValidationResult {\n    const toReturn = new StateValidationResult();\n    const authStateControl = this.storagePersistenceService.read('authStateControl', configId);\n\n    if (!this.tokenValidationService.validateStateFromHashCallback(callbackContext.authResult.state, authStateControl, configId)) {\n      this.loggerService.logWarning(configId, 'authCallback incorrect state');\n      toReturn.state = ValidationResult.StatesDoNotMatch;\n      this.handleUnsuccessfulValidation(configId);\n\n      return toReturn;\n    }\n\n    const isCurrentFlowImplicitFlowWithAccessToken = this.flowHelper.isCurrentFlowImplicitFlowWithAccessToken(configId);\n    const isCurrentFlowCodeFlow = this.flowHelper.isCurrentFlowCodeFlow(configId);\n\n    if (isCurrentFlowImplicitFlowWithAccessToken || isCurrentFlowCodeFlow) {\n      toReturn.accessToken = callbackContext.authResult.access_token;\n    }\n\n    if (callbackContext.authResult.id_token) {\n      const { clientId, issValidationOff, maxIdTokenIatOffsetAllowedInSeconds, disableIatOffsetValidation, ignoreNonceAfterRefresh } =\n        this.configurationProvider.getOpenIDConfiguration(configId);\n\n      toReturn.idToken = callbackContext.authResult.id_token;\n\n      toReturn.decodedIdToken = this.tokenHelperService.getPayloadFromToken(toReturn.idToken, false, configId);\n\n      if (!this.tokenValidationService.validateSignatureIdToken(toReturn.idToken, callbackContext.jwtKeys, configId)) {\n        this.loggerService.logDebug(configId, 'authCallback Signature validation failed id_token');\n        toReturn.state = ValidationResult.SignatureFailed;\n        this.handleUnsuccessfulValidation(configId);\n\n        return toReturn;\n      }\n\n      const authNonce = this.storagePersistenceService.read('authNonce', configId);\n\n      if (!this.tokenValidationService.validateIdTokenNonce(toReturn.decodedIdToken, authNonce, ignoreNonceAfterRefresh, configId)) {\n        this.loggerService.logWarning(configId, 'authCallback incorrect nonce, did you call the checkAuth() method multiple times?');\n        toReturn.state = ValidationResult.IncorrectNonce;\n        this.handleUnsuccessfulValidation(configId);\n\n        return toReturn;\n      }\n\n      if (!this.tokenValidationService.validateRequiredIdToken(toReturn.decodedIdToken, configId)) {\n        this.loggerService.logDebug(configId, 'authCallback Validation, one of the REQUIRED properties missing from id_token');\n        toReturn.state = ValidationResult.RequiredPropertyMissing;\n        this.handleUnsuccessfulValidation(configId);\n\n        return toReturn;\n      }\n\n      if (\n        !this.tokenValidationService.validateIdTokenIatMaxOffset(\n          toReturn.decodedIdToken,\n          maxIdTokenIatOffsetAllowedInSeconds,\n          disableIatOffsetValidation,\n          configId\n        )\n      ) {\n        this.loggerService.logWarning(\n          configId,\n          'authCallback Validation, iat rejected id_token was issued too far away from the current time'\n        );\n        toReturn.state = ValidationResult.MaxOffsetExpired;\n        this.handleUnsuccessfulValidation(configId);\n\n        return toReturn;\n      }\n\n      const authWellKnownEndPoints = this.storagePersistenceService.read('authWellKnownEndPoints', configId);\n\n      if (authWellKnownEndPoints) {\n        if (issValidationOff) {\n          this.loggerService.logDebug(configId, 'iss validation is turned off, this is not recommended!');\n        } else if (\n          !issValidationOff &&\n          !this.tokenValidationService.validateIdTokenIss(toReturn.decodedIdToken, authWellKnownEndPoints.issuer, configId)\n        ) {\n          this.loggerService.logWarning(configId, 'authCallback incorrect iss does not match authWellKnownEndpoints issuer');\n          toReturn.state = ValidationResult.IssDoesNotMatchIssuer;\n          this.handleUnsuccessfulValidation(configId);\n\n          return toReturn;\n        }\n      } else {\n        this.loggerService.logWarning(configId, 'authWellKnownEndpoints is undefined');\n        toReturn.state = ValidationResult.NoAuthWellKnownEndPoints;\n        this.handleUnsuccessfulValidation(configId);\n\n        return toReturn;\n      }\n\n      if (!this.tokenValidationService.validateIdTokenAud(toReturn.decodedIdToken, clientId, configId)) {\n        this.loggerService.logWarning(configId, 'authCallback incorrect aud');\n        toReturn.state = ValidationResult.IncorrectAud;\n        this.handleUnsuccessfulValidation(configId);\n\n        return toReturn;\n      }\n\n      if (!this.tokenValidationService.validateIdTokenAzpExistsIfMoreThanOneAud(toReturn.decodedIdToken)) {\n        this.loggerService.logWarning(configId, 'authCallback missing azp');\n        toReturn.state = ValidationResult.IncorrectAzp;\n        this.handleUnsuccessfulValidation(configId);\n\n        return toReturn;\n      }\n\n      if (!this.tokenValidationService.validateIdTokenAzpValid(toReturn.decodedIdToken, clientId)) {\n        this.loggerService.logWarning(configId, 'authCallback incorrect azp');\n        toReturn.state = ValidationResult.IncorrectAzp;\n        this.handleUnsuccessfulValidation(configId);\n\n        return toReturn;\n      }\n\n      if (!this.isIdTokenAfterRefreshTokenRequestValid(callbackContext, toReturn.decodedIdToken, configId)) {\n        this.loggerService.logWarning(configId, 'authCallback pre, post id_token claims do not match in refresh');\n        toReturn.state = ValidationResult.IncorrectIdTokenClaimsAfterRefresh;\n        this.handleUnsuccessfulValidation(configId);\n\n        return toReturn;\n      }\n\n      if (!this.tokenValidationService.validateIdTokenExpNotExpired(toReturn.decodedIdToken, configId)) {\n        this.loggerService.logWarning(configId, 'authCallback id token expired');\n        toReturn.state = ValidationResult.TokenExpired;\n        this.handleUnsuccessfulValidation(configId);\n\n        return toReturn;\n      }\n    } else {\n      this.loggerService.logDebug(configId, 'No id_token found, skipping id_token validation');\n    }\n\n    // flow id_token\n    if (!isCurrentFlowImplicitFlowWithAccessToken && !isCurrentFlowCodeFlow) {\n      toReturn.authResponseIsValid = true;\n      toReturn.state = ValidationResult.Ok;\n      this.handleSuccessfulValidation(configId);\n      this.handleUnsuccessfulValidation(configId);\n\n      return toReturn;\n    }\n\n    // only do check if id_token returned, no always the case when using refresh tokens\n    if (callbackContext.authResult.id_token) {\n      const idTokenHeader = this.tokenHelperService.getHeaderFromToken(toReturn.idToken, false, configId);\n\n      // The at_hash is optional for the code flow\n      if (isCurrentFlowCodeFlow && !(toReturn.decodedIdToken.at_hash as string)) {\n        this.loggerService.logDebug(configId, 'Code Flow active, and no at_hash in the id_token, skipping check!');\n      } else if (\n        !this.tokenValidationService.validateIdTokenAtHash(\n          toReturn.accessToken,\n          toReturn.decodedIdToken.at_hash,\n          idTokenHeader.alg, // 'RSA256'\n          configId\n        ) ||\n        !toReturn.accessToken\n      ) {\n        this.loggerService.logWarning(configId, 'authCallback incorrect at_hash');\n        toReturn.state = ValidationResult.IncorrectAtHash;\n        this.handleUnsuccessfulValidation(configId);\n\n        return toReturn;\n      }\n    }\n\n    toReturn.authResponseIsValid = true;\n    toReturn.state = ValidationResult.Ok;\n    this.handleSuccessfulValidation(configId);\n\n    return toReturn;\n  }\n\n  private isIdTokenAfterRefreshTokenRequestValid(callbackContext: CallbackContext, newIdToken: any, configId: string): boolean {\n    const { useRefreshToken, disableRefreshIdTokenAuthTimeValidation } = this.configurationProvider.getOpenIDConfiguration(configId);\n    if (!useRefreshToken) {\n      return true;\n    }\n\n    if (!callbackContext.existingIdToken) {\n      return true;\n    }\n\n    const decodedIdToken = this.tokenHelperService.getPayloadFromToken(callbackContext.existingIdToken, false, configId);\n\n    // Upon successful validation of the Refresh Token, the response body is the Token Response of Section 3.1.3.3\n    // except that it might not contain an id_token.\n\n    // If an ID Token is returned as a result of a token refresh request, the following requirements apply:\n\n    // its iss Claim Value MUST be the same as in the ID Token issued when the original authentication occurred,\n    if (decodedIdToken.iss !== newIdToken.iss) {\n      this.loggerService.logDebug(configId, `iss do not match: ${decodedIdToken.iss} ${newIdToken.iss}`);\n\n      return false;\n    }\n    // its azp Claim Value MUST be the same as in the ID Token issued when the original authentication occurred;\n    //   if no azp Claim was present in the original ID Token, one MUST NOT be present in the new ID Token, and\n    // otherwise, the same rules apply as apply when issuing an ID Token at the time of the original authentication.\n    if (decodedIdToken.azp !== newIdToken.azp) {\n      this.loggerService.logDebug(configId, `azp do not match: ${decodedIdToken.azp} ${newIdToken.azp}`);\n\n      return false;\n    }\n    // its sub Claim Value MUST be the same as in the ID Token issued when the original authentication occurred,\n    if (decodedIdToken.sub !== newIdToken.sub) {\n      this.loggerService.logDebug(configId, `sub do not match: ${decodedIdToken.sub} ${newIdToken.sub}`);\n\n      return false;\n    }\n\n    // its aud Claim Value MUST be the same as in the ID Token issued when the original authentication occurred,\n    if (!this.equalityService.isStringEqualOrNonOrderedArrayEqual(decodedIdToken?.aud, newIdToken?.aud)) {\n      this.loggerService.logDebug(configId, `aud in new id_token is not valid: '${decodedIdToken?.aud}' '${newIdToken.aud}'`);\n\n      return false;\n    }\n\n    if (disableRefreshIdTokenAuthTimeValidation) {\n      return true;\n    }\n\n    // its iat Claim MUST represent the time that the new ID Token is issued,\n    // if the ID Token contains an auth_time Claim, its value MUST represent the time of the original authentication\n    // - not the time that the new ID token is issued,\n    if (decodedIdToken.auth_time !== newIdToken.auth_time) {\n      this.loggerService.logDebug(configId, `auth_time do not match: ${decodedIdToken.auth_time} ${newIdToken.auth_time}`);\n\n      return false;\n    }\n\n    return true;\n  }\n\n  private handleSuccessfulValidation(configId: string): void {\n    const { autoCleanStateAfterAuthentication } = this.configurationProvider.getOpenIDConfiguration(configId);\n    this.storagePersistenceService.write('authNonce', null, configId);\n\n    if (autoCleanStateAfterAuthentication) {\n      this.storagePersistenceService.write('authStateControl', '', configId);\n    }\n    this.loggerService.logDebug(configId, 'authCallback token(s) validated, continue');\n  }\n\n  private handleUnsuccessfulValidation(configId: string): void {\n    const { autoCleanStateAfterAuthentication } = this.configurationProvider.getOpenIDConfiguration(configId);\n    this.storagePersistenceService.write('authNonce', null, configId);\n\n    if (autoCleanStateAfterAuthentication) {\n      this.storagePersistenceService.write('authStateControl', '', configId);\n    }\n    this.loggerService.logDebug(configId, 'authCallback token(s) invalid');\n  }\n}\n","import { DOCUMENT } from '@angular/common';\nimport { Inject, Injectable } from '@angular/core';\nimport { Observable, of, throwError } from 'rxjs';\nimport { AuthStateService } from '../../auth-state/auth-state.service';\nimport { LoggerService } from '../../logging/logger.service';\nimport { StateValidationResult } from '../../validation/state-validation-result';\nimport { StateValidationService } from '../../validation/state-validation.service';\nimport { CallbackContext } from '../callback-context';\nimport { ResetAuthDataService } from '../reset-auth-data.service';\n\n@Injectable()\nexport class StateValidationCallbackHandlerService {\n  constructor(\n    private readonly loggerService: LoggerService,\n    private readonly stateValidationService: StateValidationService,\n    private readonly authStateService: AuthStateService,\n    private readonly resetAuthDataService: ResetAuthDataService,\n    @Inject(DOCUMENT) private readonly doc: any\n  ) {}\n\n  // STEP 4 All flows\n\n  callbackStateValidation(callbackContext: CallbackContext, configId: string): Observable<CallbackContext> {\n    const validationResult = this.stateValidationService.getValidatedStateResult(callbackContext, configId);\n    callbackContext.validationResult = validationResult;\n\n    if (validationResult.authResponseIsValid) {\n      this.authStateService.setAuthorizationData(validationResult.accessToken, callbackContext.authResult, configId);\n\n      return of(callbackContext);\n    } else {\n      const errorMessage = `authorizedCallback, token(s) validation failed, resetting. Hash: ${this.doc.location.hash}`;\n      this.loggerService.logWarning(configId, errorMessage);\n      this.resetAuthDataService.resetAuthorizationData(configId);\n      this.publishUnauthorizedState(callbackContext.validationResult, callbackContext.isRenewProcess);\n\n      return throwError(errorMessage);\n    }\n  }\n\n  private publishUnauthorizedState(stateValidationResult: StateValidationResult, isRenewProcess: boolean): void {\n    this.authStateService.updateAndPublishAuthState({\n      isAuthenticated: false,\n      validationResult: stateValidationResult.state,\n      isRenewProcess,\n    });\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable, of, throwError } from 'rxjs';\nimport { AuthStateService } from '../../auth-state/auth-state.service';\nimport { LoggerService } from '../../logging/logger.service';\nimport { TokenValidationService } from '../../validation/token-validation.service';\nimport { CallbackContext } from '../callback-context';\nimport { FlowsDataService } from '../flows-data.service';\n\n@Injectable()\nexport class RefreshSessionCallbackHandlerService {\n  constructor(\n    private readonly loggerService: LoggerService,\n    private readonly authStateService: AuthStateService,\n    private readonly flowsDataService: FlowsDataService\n  ) {}\n\n  // STEP 1 Refresh session\n  refreshSessionWithRefreshTokens(configId: string): Observable<CallbackContext> {\n    const stateData = this.flowsDataService.getExistingOrCreateAuthStateControl(configId);\n    this.loggerService.logDebug(configId, 'RefreshSession created. Adding myautostate: ' + stateData);\n    const refreshToken = this.authStateService.getRefreshToken(configId);\n    const idToken = this.authStateService.getIdToken(configId);\n\n    if (refreshToken) {\n      const callbackContext = {\n        code: null,\n        refreshToken,\n        state: stateData,\n        sessionState: null,\n        authResult: null,\n        isRenewProcess: true,\n        jwtKeys: null,\n        validationResult: null,\n        existingIdToken: idToken,\n      };\n\n      this.loggerService.logDebug(configId, 'found refresh code, obtaining new credentials with refresh code');\n      // Nonce is not used with refresh tokens; but Key cloak may send it anyway\n      this.flowsDataService.setNonce(TokenValidationService.refreshTokenNoncePlaceholder, configId);\n\n      return of(callbackContext);\n    } else {\n      const errorMessage = 'no refresh token found, please login';\n      this.loggerService.logError(configId, errorMessage);\n\n      return throwError(errorMessage);\n    }\n  }\n}\n","import { HttpErrorResponse, HttpHeaders } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable, of, throwError, timer } from 'rxjs';\nimport { catchError, mergeMap, retryWhen, switchMap } from 'rxjs/operators';\nimport { DataService } from '../../api/data.service';\nimport { ConfigurationProvider } from '../../config/provider/config.provider';\nimport { LoggerService } from '../../logging/logger.service';\nimport { StoragePersistenceService } from '../../storage/storage-persistence.service';\nimport { UrlService } from '../../utils/url/url.service';\nimport { CallbackContext } from '../callback-context';\n\n@Injectable()\nexport class RefreshTokenCallbackHandlerService {\n  constructor(\n    private readonly urlService: UrlService,\n    private readonly loggerService: LoggerService,\n    private readonly configurationProvider: ConfigurationProvider,\n    private readonly dataService: DataService,\n    private readonly storagePersistenceService: StoragePersistenceService\n  ) {}\n\n  // STEP 2 Refresh Token\n  refreshTokensRequestTokens(\n    callbackContext: CallbackContext,\n    configId: string,\n    customParamsRefresh?: { [key: string]: string | number | boolean }\n  ): Observable<CallbackContext> {\n    let headers: HttpHeaders = new HttpHeaders();\n    headers = headers.set('Content-Type', 'application/x-www-form-urlencoded');\n\n    const authWellknownEndpoints = this.storagePersistenceService.read('authWellKnownEndPoints', configId);\n    const tokenEndpoint = authWellknownEndpoints?.tokenEndpoint;\n    if (!tokenEndpoint) {\n      return throwError('Token Endpoint not defined');\n    }\n\n    const data = this.urlService.createBodyForCodeFlowRefreshTokensRequest(callbackContext.refreshToken, configId, customParamsRefresh);\n\n    return this.dataService.post(tokenEndpoint, data, configId, headers).pipe(\n      switchMap((response: any) => {\n        this.loggerService.logDebug(configId, 'token refresh response: ', response);\n        let authResult: any = new Object();\n        authResult = response;\n        authResult.state = callbackContext.state;\n\n        callbackContext.authResult = authResult;\n\n        return of(callbackContext);\n      }),\n      retryWhen((error) => this.handleRefreshRetry(error, configId)),\n      catchError((error) => {\n        const { authority } = this.configurationProvider.getOpenIDConfiguration(configId);\n        const errorMessage = `OidcService code request ${authority}`;\n        this.loggerService.logError(configId, errorMessage, error);\n\n        return throwError(errorMessage);\n      })\n    );\n  }\n\n  private handleRefreshRetry(errors: Observable<any>, configId: string): Observable<any> {\n    return errors.pipe(\n      mergeMap((error) => {\n        // retry token refresh if there is no internet connection\n        if (error && error instanceof HttpErrorResponse && error.error instanceof ProgressEvent && error.error.type === 'error') {\n          const { authority, refreshTokenRetryInSeconds } = this.configurationProvider.getOpenIDConfiguration(configId);\n          const errorMessage = `OidcService code request ${authority} - no internet connection`;\n          this.loggerService.logWarning(configId, errorMessage, error);\n\n          return timer(refreshTokenRetryInSeconds * 1000);\n        }\n\n        return throwError(error);\n      })\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { concatMap } from 'rxjs/operators';\nimport { CallbackContext } from './callback-context';\nimport { CodeFlowCallbackHandlerService } from './callback-handling/code-flow-callback-handler.service';\nimport { HistoryJwtKeysCallbackHandlerService } from './callback-handling/history-jwt-keys-callback-handler.service';\nimport { ImplicitFlowCallbackHandlerService } from './callback-handling/implicit-flow-callback-handler.service';\nimport { RefreshSessionCallbackHandlerService } from './callback-handling/refresh-session-callback-handler.service';\nimport { RefreshTokenCallbackHandlerService } from './callback-handling/refresh-token-callback-handler.service';\nimport { StateValidationCallbackHandlerService } from './callback-handling/state-validation-callback-handler.service';\nimport { UserCallbackHandlerService } from './callback-handling/user-callback-handler.service';\n\n@Injectable()\nexport class FlowsService {\n  constructor(\n    private readonly codeFlowCallbackHandlerService: CodeFlowCallbackHandlerService,\n    private readonly implicitFlowCallbackHandlerService: ImplicitFlowCallbackHandlerService,\n    private readonly historyJwtKeysCallbackHandlerService: HistoryJwtKeysCallbackHandlerService,\n    private readonly userHandlerService: UserCallbackHandlerService,\n    private readonly stateValidationCallbackHandlerService: StateValidationCallbackHandlerService,\n    private readonly refreshSessionCallbackHandlerService: RefreshSessionCallbackHandlerService,\n    private readonly refreshTokenCallbackHandlerService: RefreshTokenCallbackHandlerService\n  ) {}\n\n  processCodeFlowCallback(urlToCheck: string, configId: string): Observable<CallbackContext> {\n    return this.codeFlowCallbackHandlerService.codeFlowCallback(urlToCheck, configId).pipe(\n      concatMap((callbackContext) => this.codeFlowCallbackHandlerService.codeFlowCodeRequest(callbackContext, configId)),\n      concatMap((callbackContext) => this.historyJwtKeysCallbackHandlerService.callbackHistoryAndResetJwtKeys(callbackContext, configId)),\n      concatMap((callbackContext) => this.stateValidationCallbackHandlerService.callbackStateValidation(callbackContext, configId)),\n      concatMap((callbackContext) => this.userHandlerService.callbackUser(callbackContext, configId))\n    );\n  }\n\n  processSilentRenewCodeFlowCallback(firstContext: CallbackContext, configId: string): Observable<CallbackContext> {\n    return this.codeFlowCallbackHandlerService.codeFlowCodeRequest(firstContext, configId).pipe(\n      concatMap((callbackContext) => this.historyJwtKeysCallbackHandlerService.callbackHistoryAndResetJwtKeys(callbackContext, configId)),\n      concatMap((callbackContext) => this.stateValidationCallbackHandlerService.callbackStateValidation(callbackContext, configId)),\n      concatMap((callbackContext) => this.userHandlerService.callbackUser(callbackContext, configId))\n    );\n  }\n\n  processImplicitFlowCallback(configId: string, hash?: string): Observable<CallbackContext> {\n    return this.implicitFlowCallbackHandlerService.implicitFlowCallback(configId, hash).pipe(\n      concatMap((callbackContext) => this.historyJwtKeysCallbackHandlerService.callbackHistoryAndResetJwtKeys(callbackContext, configId)),\n      concatMap((callbackContext) => this.stateValidationCallbackHandlerService.callbackStateValidation(callbackContext, configId)),\n      concatMap((callbackContext) => this.userHandlerService.callbackUser(callbackContext, configId))\n    );\n  }\n\n  processRefreshToken(configId: string, customParamsRefresh?: { [key: string]: string | number | boolean }): Observable<CallbackContext> {\n    return this.refreshSessionCallbackHandlerService.refreshSessionWithRefreshTokens(configId).pipe(\n      concatMap((callbackContext) =>\n        this.refreshTokenCallbackHandlerService.refreshTokensRequestTokens(callbackContext, configId, customParamsRefresh)\n      ),\n      concatMap((callbackContext) => this.historyJwtKeysCallbackHandlerService.callbackHistoryAndResetJwtKeys(callbackContext, configId)),\n      concatMap((callbackContext) => this.stateValidationCallbackHandlerService.callbackStateValidation(callbackContext, configId)),\n      concatMap((callbackContext) => this.userHandlerService.callbackUser(callbackContext, configId))\n    );\n  }\n}\n","import { Injectable, NgZone } from '@angular/core';\nimport { Observable, Subscription } from 'rxjs';\n\n@Injectable({ providedIn: 'root' })\nexport class IntervalService {\n  runTokenValidationRunning: Subscription = null;\n\n  constructor(private zone: NgZone) {}\n\n  stopPeriodicTokenCheck(): void {\n    if (this.runTokenValidationRunning) {\n      this.runTokenValidationRunning.unsubscribe();\n      this.runTokenValidationRunning = null;\n    }\n  }\n\n  startPeriodicTokenCheck(repeatAfterSeconds: number): Observable<unknown> {\n    const millisecondsDelayBetweenTokenCheck = repeatAfterSeconds * 1000;\n\n    return new Observable((subscriber) => {\n      let intervalId;\n      this.zone.runOutsideAngular(() => {\n        intervalId = setInterval(() => this.zone.run(() => subscriber.next()), millisecondsDelayBetweenTokenCheck);\n      });\n\n      return (): void => {\n        clearInterval(intervalId);\n      };\n    });\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { Observable, throwError } from 'rxjs';\nimport { catchError, tap } from 'rxjs/operators';\nimport { ConfigurationProvider } from '../config/provider/config.provider';\nimport { CallbackContext } from '../flows/callback-context';\nimport { FlowsDataService } from '../flows/flows-data.service';\nimport { FlowsService } from '../flows/flows.service';\nimport { IntervalService } from './interval.service';\n\n@Injectable({ providedIn: 'root' })\nexport class ImplicitFlowCallbackService {\n  constructor(\n    private flowsService: FlowsService,\n    private configurationProvider: ConfigurationProvider,\n    private router: Router,\n    private flowsDataService: FlowsDataService,\n    private intervalService: IntervalService\n  ) {}\n\n  authenticatedImplicitFlowCallback(configId: string, hash?: string): Observable<CallbackContext> {\n    const isRenewProcess = this.flowsDataService.isSilentRenewRunning(configId);\n    const { triggerAuthorizationResultEvent, postLoginRoute, unauthorizedRoute } =\n      this.configurationProvider.getOpenIDConfiguration(configId);\n\n    return this.flowsService.processImplicitFlowCallback(configId, hash).pipe(\n      tap((callbackContext) => {\n        if (!triggerAuthorizationResultEvent && !callbackContext.isRenewProcess) {\n          this.router.navigateByUrl(postLoginRoute);\n        }\n      }),\n      catchError((error) => {\n        this.flowsDataService.resetSilentRenewRunning(configId);\n        this.intervalService.stopPeriodicTokenCheck();\n        if (!triggerAuthorizationResultEvent && !isRenewProcess) {\n          this.router.navigateByUrl(unauthorizedRoute);\n        }\n\n        return throwError(error);\n      })\n    );\n  }\n}\n","import { DOCUMENT } from '@angular/common';\nimport { Inject, Injectable } from '@angular/core';\nimport { LoggerService } from '../logging/logger.service';\n\n@Injectable()\nexport class IFrameService {\n  constructor(@Inject(DOCUMENT) private readonly doc: any, private loggerService: LoggerService) {}\n\n  getExistingIFrame(identifier: string): HTMLIFrameElement | null {\n    const iFrameOnParent = this.getIFrameFromParentWindow(identifier);\n    if (this.isIFrameElement(iFrameOnParent)) {\n      return iFrameOnParent;\n    }\n\n    const iFrameOnSelf = this.getIFrameFromWindow(identifier);\n    if (this.isIFrameElement(iFrameOnSelf)) {\n      return iFrameOnSelf;\n    }\n\n    return null;\n  }\n\n  addIFrameToWindowBody(identifier: string, configId: string): HTMLIFrameElement {\n    const sessionIframe = this.doc.createElement('iframe');\n    sessionIframe.id = identifier;\n    sessionIframe.title = identifier;\n    this.loggerService.logDebug(configId, sessionIframe);\n    sessionIframe.style.display = 'none';\n    this.doc.body.appendChild(sessionIframe);\n\n    return sessionIframe;\n  }\n\n  private getIFrameFromParentWindow(identifier: string): HTMLIFrameElement | null {\n    try {\n      const iFrameElement = this.doc.defaultView.parent.document.getElementById(identifier);\n      if (this.isIFrameElement(iFrameElement)) {\n        return iFrameElement;\n      }\n\n      return null;\n    } catch (e) {\n      return null;\n    }\n  }\n\n  private getIFrameFromWindow(identifier: string): HTMLIFrameElement | null {\n    const iFrameElement = this.doc.getElementById(identifier);\n    if (this.isIFrameElement(iFrameElement)) {\n      return iFrameElement;\n    }\n\n    return null;\n  }\n\n  private isIFrameElement(element: HTMLElement | null): element is HTMLIFrameElement {\n    return !!element && element instanceof HTMLIFrameElement;\n  }\n}\n","import { Injectable, NgZone } from '@angular/core';\nimport { BehaviorSubject, Observable, of } from 'rxjs';\nimport { take } from 'rxjs/operators';\nimport { ConfigurationProvider } from '../config/provider/config.provider';\nimport { LoggerService } from '../logging/logger.service';\nimport { EventTypes } from '../public-events/event-types';\nimport { PublicEventsService } from '../public-events/public-events.service';\nimport { StoragePersistenceService } from '../storage/storage-persistence.service';\nimport { IFrameService } from './existing-iframe.service';\n\nconst IFRAME_FOR_CHECK_SESSION_IDENTIFIER = 'myiFrameForCheckSession';\n\n// http://openid.net/specs/openid-connect-session-1_0-ID4.html\n\n@Injectable()\nexport class CheckSessionService {\n  private checkSessionReceived = false;\n  private scheduledHeartBeatRunning: any;\n  private lastIFrameRefresh = 0;\n  private outstandingMessages = 0;\n  private heartBeatInterval = 3000;\n  private iframeRefreshInterval = 60000;\n  private checkSessionChangedInternal$ = new BehaviorSubject<boolean>(false);\n\n  get checkSessionChanged$(): Observable<boolean> {\n    return this.checkSessionChangedInternal$.asObservable();\n  }\n\n  constructor(\n    private storagePersistenceService: StoragePersistenceService,\n    private loggerService: LoggerService,\n    private iFrameService: IFrameService,\n    private eventService: PublicEventsService,\n    private configurationProvider: ConfigurationProvider,\n    private zone: NgZone\n  ) {}\n\n  isCheckSessionConfigured(configId: string): boolean {\n    const { startCheckSession } = this.configurationProvider.getOpenIDConfiguration(configId);\n\n    return startCheckSession;\n  }\n\n  start(configId: string): void {\n    if (!!this.scheduledHeartBeatRunning) {\n      return;\n    }\n\n    const { clientId } = this.configurationProvider.getOpenIDConfiguration(configId);\n    this.pollServerSession(clientId, configId);\n  }\n\n  stop(): void {\n    if (!this.scheduledHeartBeatRunning) {\n      return;\n    }\n\n    this.clearScheduledHeartBeat();\n    this.checkSessionReceived = false;\n  }\n\n  serverStateChanged(configId: string): boolean {\n    const { startCheckSession } = this.configurationProvider.getOpenIDConfiguration(configId);\n\n    return startCheckSession && this.checkSessionReceived;\n  }\n\n  getExistingIframe(): HTMLIFrameElement {\n    return this.iFrameService.getExistingIFrame(IFRAME_FOR_CHECK_SESSION_IDENTIFIER);\n  }\n\n  private init(configId: string): Observable<any> {\n    if (this.lastIFrameRefresh + this.iframeRefreshInterval > Date.now()) {\n      return of(undefined);\n    }\n\n    const authWellKnownEndPoints = this.storagePersistenceService.read('authWellKnownEndPoints', configId);\n\n    if (!authWellKnownEndPoints) {\n      this.loggerService.logWarning(configId, 'CheckSession - init check session: authWellKnownEndpoints is undefined. Returning.');\n\n      return of();\n    }\n\n    const existingIframe = this.getOrCreateIframe(configId);\n    const checkSessionIframe = authWellKnownEndPoints.checkSessionIframe;\n\n    if (checkSessionIframe) {\n      existingIframe.contentWindow.location.replace(checkSessionIframe);\n    } else {\n      this.loggerService.logWarning(configId, 'CheckSession - init check session: checkSessionIframe is not configured to run');\n    }\n\n    return new Observable((observer) => {\n      existingIframe.onload = (): void => {\n        this.lastIFrameRefresh = Date.now();\n        observer.next();\n        observer.complete();\n      };\n    });\n  }\n\n  private pollServerSession(clientId: string, configId: string): void {\n    this.outstandingMessages = 0;\n    const pollServerSessionRecur = (): void => {\n      this.init(configId)\n        .pipe(take(1))\n        .subscribe(() => {\n          const existingIframe = this.getExistingIframe();\n          if (existingIframe && clientId) {\n            this.loggerService.logDebug(configId, `CheckSession - clientId : '${clientId}' - existingIframe: '${existingIframe}'`);\n            const sessionState = this.storagePersistenceService.read('session_state', configId);\n            const authWellKnownEndPoints = this.storagePersistenceService.read('authWellKnownEndPoints', configId);\n\n            if (sessionState && authWellKnownEndPoints?.checkSessionIframe) {\n              const iframeOrigin = new URL(authWellKnownEndPoints.checkSessionIframe)?.origin;\n              this.outstandingMessages++;\n              existingIframe.contentWindow.postMessage(clientId + ' ' + sessionState, iframeOrigin);\n            } else {\n              this.loggerService.logDebug(\n                configId,\n                `CheckSession - session_state is '${sessionState}' - AuthWellKnownEndPoints is '${JSON.stringify(\n                  authWellKnownEndPoints,\n                  null,\n                  2\n                )}'`\n              );\n              this.checkSessionChangedInternal$.next(true);\n            }\n          } else {\n            this.loggerService.logWarning(\n              configId,\n              `CheckSession - OidcSecurityCheckSession pollServerSession checkSession IFrame does not exist:\n               clientId : '${clientId}' - existingIframe: '${existingIframe}'`\n            );\n          }\n\n          // after sending three messages with no response, fail.\n          if (this.outstandingMessages > 3) {\n            this.loggerService.logError(\n              configId,\n              `CheckSession - OidcSecurityCheckSession not receiving check session response messages.\n                            Outstanding messages: '${this.outstandingMessages}'. Server unreachable?`\n            );\n          }\n\n          this.zone.runOutsideAngular(() => {\n            this.scheduledHeartBeatRunning = setTimeout(() => this.zone.run(pollServerSessionRecur), this.heartBeatInterval);\n          });\n        });\n    };\n\n    pollServerSessionRecur();\n  }\n\n  private clearScheduledHeartBeat(): void {\n    clearTimeout(this.scheduledHeartBeatRunning);\n    this.scheduledHeartBeatRunning = null;\n  }\n\n  private messageHandler(configId: string, e: any): void {\n    const existingIFrame = this.getExistingIframe();\n    const authWellKnownEndPoints = this.storagePersistenceService.read('authWellKnownEndPoints', configId);\n    const startsWith = !!authWellKnownEndPoints?.checkSessionIframe?.startsWith(e.origin);\n\n    this.outstandingMessages = 0;\n\n    if (existingIFrame && startsWith && e.source === existingIFrame.contentWindow) {\n      if (e.data === 'error') {\n        this.loggerService.logWarning(configId, 'CheckSession - error from check session messageHandler');\n      } else if (e.data === 'changed') {\n        this.loggerService.logDebug(configId, `CheckSession - ${e} from check session messageHandler`);\n        this.checkSessionReceived = true;\n        this.eventService.fireEvent(EventTypes.CheckSessionReceived, e.data);\n        this.checkSessionChangedInternal$.next(true);\n      } else {\n        this.eventService.fireEvent(EventTypes.CheckSessionReceived, e.data);\n        this.loggerService.logDebug(configId, `CheckSession - ${e.data} from check session messageHandler`);\n      }\n    }\n  }\n\n  private bindMessageEventToIframe(configId: string): void {\n    const iframeMessageEvent = this.messageHandler.bind(this, configId);\n    window.addEventListener('message', iframeMessageEvent, false);\n  }\n\n  private getOrCreateIframe(configId: string): HTMLIFrameElement {\n    const existingIframe = this.getExistingIframe();\n\n    if (!existingIframe) {\n      const frame = this.iFrameService.addIFrameToWindowBody(IFRAME_FOR_CHECK_SESSION_IDENTIFIER, configId);\n      this.bindMessageEventToIframe(configId);\n\n      return frame;\n    }\n\n    return existingIframe;\n  }\n}\n","import { DOCUMENT } from '@angular/common';\nimport { Inject, Injectable } from '@angular/core';\n\n@Injectable()\nexport class CurrentUrlService {\n  constructor(@Inject(DOCUMENT) private doc: any) {}\n\n  getStateParamFromCurrentUrl(): string {\n    const currentUrl = this.getCurrentUrl();\n    const parsedUrl = new URL(currentUrl);\n    const urlParams = new URLSearchParams(parsedUrl.search);\n    const stateFromUrl = urlParams.get('state');\n\n    return stateFromUrl;\n  }\n\n  currentUrlHasStateParam(): boolean {\n    return !!this.getStateParamFromCurrentUrl();\n  }\n\n  getCurrentUrl(): string {\n    return this.doc.defaultView.location.toString();\n  }\n}\n","import { HttpParams } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable, of, Subject, throwError } from 'rxjs';\nimport { catchError } from 'rxjs/operators';\nimport { AuthStateService } from '../auth-state/auth-state.service';\nimport { ImplicitFlowCallbackService } from '../callback/implicit-flow-callback.service';\nimport { IntervalService } from '../callback/interval.service';\nimport { ConfigurationProvider } from '../config/provider/config.provider';\nimport { CallbackContext } from '../flows/callback-context';\nimport { FlowsDataService } from '../flows/flows-data.service';\nimport { FlowsService } from '../flows/flows.service';\nimport { ResetAuthDataService } from '../flows/reset-auth-data.service';\nimport { LoggerService } from '../logging/logger.service';\nimport { FlowHelper } from '../utils/flowHelper/flow-helper.service';\nimport { ValidationResult } from '../validation/validation-result';\nimport { IFrameService } from './existing-iframe.service';\n\nconst IFRAME_FOR_SILENT_RENEW_IDENTIFIER = 'myiFrameForSilentRenew';\n\n@Injectable()\nexport class SilentRenewService {\n  private refreshSessionWithIFrameCompletedInternal$ = new Subject<CallbackContext>();\n\n  get refreshSessionWithIFrameCompleted$(): Observable<CallbackContext> {\n    return this.refreshSessionWithIFrameCompletedInternal$.asObservable();\n  }\n\n  constructor(\n    private configurationProvider: ConfigurationProvider,\n    private iFrameService: IFrameService,\n    private flowsService: FlowsService,\n    private resetAuthDataService: ResetAuthDataService,\n    private flowsDataService: FlowsDataService,\n    private authStateService: AuthStateService,\n    private loggerService: LoggerService,\n    private flowHelper: FlowHelper,\n    private implicitFlowCallbackService: ImplicitFlowCallbackService,\n    private intervalService: IntervalService\n  ) {}\n\n  getOrCreateIframe(configId: string): HTMLIFrameElement {\n    const existingIframe = this.getExistingIframe();\n\n    if (!existingIframe) {\n      return this.iFrameService.addIFrameToWindowBody(IFRAME_FOR_SILENT_RENEW_IDENTIFIER, configId);\n    }\n\n    return existingIframe;\n  }\n\n  isSilentRenewConfigured(configId: string): boolean {\n    const { useRefreshToken, silentRenew } = this.configurationProvider.getOpenIDConfiguration(configId);\n\n    return !useRefreshToken && silentRenew;\n  }\n\n  codeFlowCallbackSilentRenewIframe(urlParts: any, configId: string): Observable<CallbackContext> {\n    const params = new HttpParams({\n      fromString: urlParts[1],\n    });\n\n    const error = params.get('error');\n\n    if (error) {\n      this.authStateService.updateAndPublishAuthState({\n        isAuthenticated: false,\n        validationResult: ValidationResult.LoginRequired,\n        isRenewProcess: true,\n      });\n      this.resetAuthDataService.resetAuthorizationData(configId);\n      this.flowsDataService.setNonce('', configId);\n      this.intervalService.stopPeriodicTokenCheck();\n\n      return throwError(error);\n    }\n\n    const code = params.get('code');\n    const state = params.get('state');\n    const sessionState = params.get('session_state');\n\n    const callbackContext = {\n      code,\n      refreshToken: null,\n      state,\n      sessionState,\n      authResult: null,\n      isRenewProcess: true,\n      jwtKeys: null,\n      validationResult: null,\n      existingIdToken: null,\n    };\n\n    return this.flowsService.processSilentRenewCodeFlowCallback(callbackContext, configId).pipe(\n      catchError((errorFromFlow) => {\n        this.intervalService.stopPeriodicTokenCheck();\n        this.resetAuthDataService.resetAuthorizationData(configId);\n\n        return throwError(errorFromFlow);\n      })\n    );\n  }\n\n  silentRenewEventHandler(e: CustomEvent, configId: string): void {\n    this.loggerService.logDebug(configId, 'silentRenewEventHandler');\n    if (!e.detail) {\n      return;\n    }\n\n    let callback$ = of(null);\n\n    const isCodeFlow = this.flowHelper.isCurrentFlowCodeFlow(configId);\n\n    if (isCodeFlow) {\n      const urlParts = e.detail.toString().split('?');\n      callback$ = this.codeFlowCallbackSilentRenewIframe(urlParts, configId);\n    } else {\n      callback$ = this.implicitFlowCallbackService.authenticatedImplicitFlowCallback(configId, e.detail);\n    }\n\n    callback$.subscribe(\n      (callbackContext) => {\n        this.refreshSessionWithIFrameCompletedInternal$.next(callbackContext);\n        this.flowsDataService.resetSilentRenewRunning(configId);\n      },\n      (err: any) => {\n        this.loggerService.logError(configId, 'Error: ' + err);\n        this.refreshSessionWithIFrameCompletedInternal$.next(null);\n        this.flowsDataService.resetSilentRenewRunning(configId);\n      }\n    );\n  }\n\n  private getExistingIframe(): HTMLIFrameElement {\n    return this.iFrameService.getExistingIFrame(IFRAME_FOR_SILENT_RENEW_IDENTIFIER);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { Observable, throwError } from 'rxjs';\nimport { catchError, tap } from 'rxjs/operators';\nimport { ConfigurationProvider } from '../config/provider/config.provider';\nimport { CallbackContext } from '../flows/callback-context';\nimport { FlowsDataService } from '../flows/flows-data.service';\nimport { FlowsService } from '../flows/flows.service';\nimport { IntervalService } from './interval.service';\n\n@Injectable({ providedIn: 'root' })\nexport class CodeFlowCallbackService {\n  constructor(\n    private flowsService: FlowsService,\n    private flowsDataService: FlowsDataService,\n    private intervalService: IntervalService,\n    private configurationProvider: ConfigurationProvider,\n    private router: Router\n  ) {}\n\n  authenticatedCallbackWithCode(urlToCheck: string, configId: string): Observable<CallbackContext> {\n    const isRenewProcess = this.flowsDataService.isSilentRenewRunning(configId);\n    const { triggerAuthorizationResultEvent, postLoginRoute, unauthorizedRoute } =\n      this.configurationProvider.getOpenIDConfiguration(configId);\n\n    return this.flowsService.processCodeFlowCallback(urlToCheck, configId).pipe(\n      tap((callbackContext) => {\n        if (!triggerAuthorizationResultEvent && !callbackContext.isRenewProcess) {\n          this.router.navigateByUrl(postLoginRoute);\n        }\n      }),\n      catchError((error) => {\n        this.flowsDataService.resetSilentRenewRunning(configId);\n        this.intervalService.stopPeriodicTokenCheck();\n        if (!triggerAuthorizationResultEvent && !isRenewProcess) {\n          this.router.navigateByUrl(unauthorizedRoute);\n        }\n\n        return throwError(error);\n      })\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable, Subject } from 'rxjs';\nimport { tap } from 'rxjs/operators';\nimport { CallbackContext } from '../flows/callback-context';\nimport { FlowHelper } from '../utils/flowHelper/flow-helper.service';\nimport { UrlService } from '../utils/url/url.service';\nimport { CodeFlowCallbackService } from './code-flow-callback.service';\nimport { ImplicitFlowCallbackService } from './implicit-flow-callback.service';\n\n@Injectable({ providedIn: 'root' })\nexport class CallbackService {\n  private stsCallbackInternal$ = new Subject();\n\n  get stsCallback$(): Observable<unknown> {\n    return this.stsCallbackInternal$.asObservable();\n  }\n\n  constructor(\n    private urlService: UrlService,\n    private flowHelper: FlowHelper,\n    private implicitFlowCallbackService: ImplicitFlowCallbackService,\n    private codeFlowCallbackService: CodeFlowCallbackService\n  ) {}\n\n  isCallback(currentUrl: string): boolean {\n    return this.urlService.isCallbackFromSts(currentUrl);\n  }\n\n  handleCallbackAndFireEvents(currentCallbackUrl: string, configId: string): Observable<CallbackContext> {\n    let callback$: Observable<any>;\n\n    if (this.flowHelper.isCurrentFlowCodeFlow(configId)) {\n      callback$ = this.codeFlowCallbackService.authenticatedCallbackWithCode(currentCallbackUrl, configId);\n    } else if (this.flowHelper.isCurrentFlowAnyImplicitFlow(configId)) {\n      callback$ = this.implicitFlowCallbackService.authenticatedImplicitFlowCallback(configId);\n    }\n\n    return callback$.pipe(tap(() => this.stsCallbackInternal$.next()));\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { map, retry } from 'rxjs/operators';\nimport { DataService } from '../../api/data.service';\nimport { AuthWellKnownEndpoints } from './auth-well-known-endpoints';\n\nconst WELL_KNOWN_SUFFIX = `/.well-known/openid-configuration`;\n\n@Injectable()\nexport class AuthWellKnownDataService {\n  constructor(private readonly http: DataService) {}\n\n  getWellKnownEndPointsFromUrl(authWellknownEndpoint: string, configId: string): Observable<AuthWellKnownEndpoints> {\n    return this.getWellKnownDocument(authWellknownEndpoint, configId).pipe(\n      map(\n        (wellKnownEndpoints) =>\n          ({\n            issuer: wellKnownEndpoints.issuer,\n            jwksUri: wellKnownEndpoints.jwks_uri,\n            authorizationEndpoint: wellKnownEndpoints.authorization_endpoint,\n            tokenEndpoint: wellKnownEndpoints.token_endpoint,\n            userInfoEndpoint: wellKnownEndpoints.userinfo_endpoint,\n            endSessionEndpoint: wellKnownEndpoints.end_session_endpoint,\n            checkSessionIframe: wellKnownEndpoints.check_session_iframe,\n            revocationEndpoint: wellKnownEndpoints.revocation_endpoint,\n            introspectionEndpoint: wellKnownEndpoints.introspection_endpoint,\n            parEndpoint: wellKnownEndpoints.pushed_authorization_request_endpoint,\n          } as AuthWellKnownEndpoints)\n      )\n    );\n  }\n\n  private getWellKnownDocument(wellKnownEndpoint: string, configId: string): Observable<any> {\n    let url = wellKnownEndpoint;\n\n    if (!wellKnownEndpoint.includes(WELL_KNOWN_SUFFIX)) {\n      url = `${wellKnownEndpoint}${WELL_KNOWN_SUFFIX}`;\n    }\n\n    return this.http.get<any>(url, configId).pipe(retry(2));\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable, of, throwError } from 'rxjs';\nimport { catchError, tap } from 'rxjs/operators';\nimport { EventTypes } from '../../public-events/event-types';\nimport { PublicEventsService } from '../../public-events/public-events.service';\nimport { StoragePersistenceService } from '../../storage/storage-persistence.service';\nimport { AuthWellKnownDataService } from './auth-well-known-data.service';\nimport { AuthWellKnownEndpoints } from './auth-well-known-endpoints';\n\n@Injectable()\nexport class AuthWellKnownService {\n  constructor(\n    private publicEventsService: PublicEventsService,\n    private dataService: AuthWellKnownDataService,\n    private storagePersistenceService: StoragePersistenceService\n  ) {}\n\n  getAuthWellKnownEndPoints(authWellknownEndpointUrl: string, configId: string): Observable<AuthWellKnownEndpoints> {\n    const alreadySavedWellKnownEndpoints = this.storagePersistenceService.read('authWellKnownEndPoints', configId);\n    if (!!alreadySavedWellKnownEndpoints) {\n      return of(alreadySavedWellKnownEndpoints);\n    }\n\n    return this.getWellKnownEndPointsFromUrl(authWellknownEndpointUrl, configId).pipe(\n      tap((mappedWellKnownEndpoints) => this.storeWellKnownEndpoints(configId, mappedWellKnownEndpoints)),\n      catchError((error) => {\n        this.publicEventsService.fireEvent(EventTypes.ConfigLoadingFailed, null);\n\n        return throwError(error);\n      })\n    );\n  }\n\n  storeWellKnownEndpoints(configId: string, mappedWellKnownEndpoints: AuthWellKnownEndpoints): void {\n    this.storagePersistenceService.write('authWellKnownEndPoints', mappedWellKnownEndpoints, configId);\n  }\n\n  private getWellKnownEndPointsFromUrl(authWellknownEndpointUrl: string, configId: string): Observable<AuthWellKnownEndpoints> {\n    return this.dataService.getWellKnownEndPointsFromUrl(authWellknownEndpointUrl, configId);\n  }\n}\n","import { DOCUMENT } from '@angular/common';\nimport { Inject, Injectable, Renderer2, RendererFactory2 } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { LoggerService } from '../logging/logger.service';\nimport { UrlService } from '../utils/url/url.service';\nimport { SilentRenewService } from './silent-renew.service';\n\n@Injectable({ providedIn: 'root' })\nexport class RefreshSessionIframeService {\n  private renderer: Renderer2;\n\n  constructor(\n    @Inject(DOCUMENT) private readonly doc: any,\n    private loggerService: LoggerService,\n    private urlService: UrlService,\n    private silentRenewService: SilentRenewService,\n    rendererFactory: RendererFactory2\n  ) {\n    this.renderer = rendererFactory.createRenderer(null, null);\n  }\n\n  refreshSessionWithIframe(configId: string, customParams?: { [key: string]: string | number | boolean }): Observable<boolean> {\n    this.loggerService.logDebug(configId, 'BEGIN refresh session Authorize Iframe renew');\n    const url = this.urlService.getRefreshSessionSilentRenewUrl(configId, customParams);\n\n    return this.sendAuthorizeRequestUsingSilentRenew(url, configId);\n  }\n\n  private sendAuthorizeRequestUsingSilentRenew(url: string, configId: string): Observable<boolean> {\n    const sessionIframe = this.silentRenewService.getOrCreateIframe(configId);\n    this.initSilentRenewRequest(configId);\n    this.loggerService.logDebug(configId, 'sendAuthorizeRequestUsingSilentRenew for URL:' + url);\n\n    return new Observable((observer) => {\n      const onLoadHandler = (): void => {\n        sessionIframe.removeEventListener('load', onLoadHandler);\n        this.loggerService.logDebug(configId, 'removed event listener from IFrame');\n        observer.next(true);\n        observer.complete();\n      };\n      sessionIframe.addEventListener('load', onLoadHandler);\n      sessionIframe.contentWindow.location.replace(url);\n    });\n  }\n\n  private initSilentRenewRequest(configId: string): void {\n    const instanceId = Math.random();\n\n    const initDestroyHandler = this.renderer.listen('window', 'oidc-silent-renew-init', (e: CustomEvent) => {\n      if (e.detail !== instanceId) {\n        initDestroyHandler();\n        renewDestroyHandler();\n      }\n    });\n    const renewDestroyHandler = this.renderer.listen('window', 'oidc-silent-renew-message', (e) =>\n      this.silentRenewService.silentRenewEventHandler(e, configId)\n    );\n\n    this.doc.defaultView.dispatchEvent(\n      new CustomEvent('oidc-silent-renew-init', {\n        detail: instanceId,\n      })\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable, throwError } from 'rxjs';\nimport { catchError } from 'rxjs/operators';\nimport { CallbackContext } from '../flows/callback-context';\nimport { FlowsService } from '../flows/flows.service';\nimport { ResetAuthDataService } from '../flows/reset-auth-data.service';\nimport { LoggerService } from '../logging/logger.service';\nimport { IntervalService } from './interval.service';\n\n@Injectable({ providedIn: 'root' })\nexport class RefreshSessionRefreshTokenService {\n  constructor(\n    private loggerService: LoggerService,\n    private resetAuthDataService: ResetAuthDataService,\n    private flowsService: FlowsService,\n    private intervalService: IntervalService\n  ) {}\n\n  refreshSessionWithRefreshTokens(\n    configId: string,\n    customParamsRefresh?: { [key: string]: string | number | boolean }\n  ): Observable<CallbackContext> {\n    this.loggerService.logDebug(configId, 'BEGIN refresh session Authorize');\n\n    return this.flowsService.processRefreshToken(configId, customParamsRefresh).pipe(\n      catchError((error) => {\n        this.intervalService.stopPeriodicTokenCheck();\n        this.resetAuthDataService.resetAuthorizationData(configId);\n\n        return throwError(error);\n      })\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { forkJoin, Observable, of, throwError, TimeoutError, timer } from 'rxjs';\nimport { map, mergeMap, retryWhen, switchMap, take, timeout } from 'rxjs/operators';\nimport { AuthStateService } from '../auth-state/auth-state.service';\nimport { AuthWellKnownService } from '../config/auth-well-known/auth-well-known.service';\nimport { ConfigurationProvider } from '../config/provider/config.provider';\nimport { CallbackContext } from '../flows/callback-context';\nimport { FlowsDataService } from '../flows/flows-data.service';\nimport { RefreshSessionIframeService } from '../iframe/refresh-session-iframe.service';\nimport { SilentRenewService } from '../iframe/silent-renew.service';\nimport { LoggerService } from '../logging/logger.service';\nimport { LoginResponse } from '../login/login-response';\nimport { StoragePersistenceService } from '../storage/storage-persistence.service';\nimport { UserService } from '../user-data/user.service';\nimport { FlowHelper } from '../utils/flowHelper/flow-helper.service';\nimport { RefreshSessionRefreshTokenService } from './refresh-session-refresh-token.service';\n\nexport const MAX_RETRY_ATTEMPTS = 3;\n@Injectable({ providedIn: 'root' })\nexport class RefreshSessionService {\n  constructor(\n    private flowHelper: FlowHelper,\n    private configurationProvider: ConfigurationProvider,\n    private flowsDataService: FlowsDataService,\n    private loggerService: LoggerService,\n    private silentRenewService: SilentRenewService,\n    private authStateService: AuthStateService,\n    private authWellKnownService: AuthWellKnownService,\n    private refreshSessionIframeService: RefreshSessionIframeService,\n    private storagePersistenceService: StoragePersistenceService,\n    private refreshSessionRefreshTokenService: RefreshSessionRefreshTokenService,\n    private userService: UserService\n  ) {}\n\n  userForceRefreshSession(configId: string, extraCustomParams?: { [key: string]: string | number | boolean }): Observable<LoginResponse> {\n    this.persistCustomParams(extraCustomParams, configId);\n\n    return this.forceRefreshSession(configId, extraCustomParams);\n  }\n\n  forceRefreshSession(configId: string, extraCustomParams?: { [key: string]: string | number | boolean }): Observable<LoginResponse> {\n    const { customParamsRefreshTokenRequest } = this.configurationProvider.getOpenIDConfiguration();\n\n    const mergedParams = { ...customParamsRefreshTokenRequest, ...extraCustomParams };\n\n    if (this.flowHelper.isCurrentFlowCodeFlowWithRefreshTokens(configId)) {\n      return this.startRefreshSession(configId, mergedParams).pipe(\n        map(() => {\n          const isAuthenticated = this.authStateService.areAuthStorageTokensValid(configId);\n          if (isAuthenticated) {\n            return {\n              idToken: this.authStateService.getIdToken(configId),\n              accessToken: this.authStateService.getAccessToken(configId),\n              userData: this.userService.getUserDataFromStore(configId),\n              isAuthenticated,\n              configId,\n            } as LoginResponse;\n          }\n\n          return null;\n        })\n      );\n    }\n\n    const { silentRenewTimeoutInSeconds } = this.configurationProvider.getOpenIDConfiguration(configId);\n    const timeOutTime = silentRenewTimeoutInSeconds * 1000;\n\n    return forkJoin([\n      this.startRefreshSession(configId, extraCustomParams),\n      this.silentRenewService.refreshSessionWithIFrameCompleted$.pipe(take(1)),\n    ]).pipe(\n      timeout(timeOutTime),\n      retryWhen(this.timeoutRetryStrategy.bind(this)),\n      map(([_, callbackContext]) => {\n        const isAuthenticated = this.authStateService.areAuthStorageTokensValid(configId);\n        if (isAuthenticated) {\n          return {\n            idToken: callbackContext?.authResult?.id_token,\n            accessToken: callbackContext?.authResult?.access_token,\n            userData: this.userService.getUserDataFromStore(configId),\n            isAuthenticated,\n            configId,\n          };\n        }\n\n        return null;\n      })\n    );\n  }\n\n  private persistCustomParams(extraCustomParams: { [key: string]: string | number | boolean }, configId: string): void {\n    const { useRefreshToken } = this.configurationProvider.getOpenIDConfiguration();\n\n    if (extraCustomParams) {\n      if (useRefreshToken) {\n        this.storagePersistenceService.write('storageCustomParamsRefresh', extraCustomParams, configId);\n      } else {\n        this.storagePersistenceService.write('storageCustomParamsAuthRequest', extraCustomParams, configId);\n      }\n    }\n  }\n\n  private startRefreshSession(\n    configId: string,\n    extraCustomParams?: { [key: string]: string | number | boolean }\n  ): Observable<boolean | CallbackContext | null> {\n    const isSilentRenewRunning = this.flowsDataService.isSilentRenewRunning(configId);\n    this.loggerService.logDebug(configId, `Checking: silentRenewRunning: ${isSilentRenewRunning}`);\n    const shouldBeExecuted = !isSilentRenewRunning;\n\n    if (!shouldBeExecuted) {\n      return of(null);\n    }\n\n    const { authWellknownEndpointUrl } = this.configurationProvider.getOpenIDConfiguration(configId) || {};\n\n    if (!authWellknownEndpointUrl) {\n      this.loggerService.logError(configId, 'no authWellKnownEndpoint given!');\n\n      return of(null);\n    }\n\n    return this.authWellKnownService.getAuthWellKnownEndPoints(authWellknownEndpointUrl, configId).pipe(\n      switchMap(() => {\n        this.flowsDataService.setSilentRenewRunning(configId);\n\n        if (this.flowHelper.isCurrentFlowCodeFlowWithRefreshTokens(configId)) {\n          // Refresh Session using Refresh tokens\n          return this.refreshSessionRefreshTokenService.refreshSessionWithRefreshTokens(configId, extraCustomParams);\n        }\n\n        return this.refreshSessionIframeService.refreshSessionWithIframe(configId, extraCustomParams);\n      })\n    );\n  }\n\n  private timeoutRetryStrategy(errorAttempts: Observable<any>, configId: string): Observable<number> {\n    return errorAttempts.pipe(\n      mergeMap((error, index) => {\n        const scalingDuration = 1000;\n        const currentAttempt = index + 1;\n\n        if (!(error instanceof TimeoutError) || currentAttempt > MAX_RETRY_ATTEMPTS) {\n          return throwError(error);\n        }\n\n        this.loggerService.logDebug(configId, `forceRefreshSession timeout. Attempt #${currentAttempt}`);\n\n        this.flowsDataService.resetSilentRenewRunning(configId);\n\n        return timer(currentAttempt * scalingDuration);\n      })\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { forkJoin, Observable, of, throwError } from 'rxjs';\nimport { catchError, switchMap } from 'rxjs/operators';\nimport { AuthStateService } from '../auth-state/auth-state.service';\nimport { OpenIdConfiguration } from '../config/openid-configuration';\nimport { ConfigurationProvider } from '../config/provider/config.provider';\nimport { FlowsDataService } from '../flows/flows-data.service';\nimport { ResetAuthDataService } from '../flows/reset-auth-data.service';\nimport { RefreshSessionIframeService } from '../iframe/refresh-session-iframe.service';\nimport { LoggerService } from '../logging/logger.service';\nimport { EventTypes } from '../public-events/event-types';\nimport { PublicEventsService } from '../public-events/public-events.service';\nimport { StoragePersistenceService } from '../storage/storage-persistence.service';\nimport { UserService } from '../user-data/user.service';\nimport { FlowHelper } from '../utils/flowHelper/flow-helper.service';\nimport { IntervalService } from './interval.service';\nimport { RefreshSessionRefreshTokenService } from './refresh-session-refresh-token.service';\n\n@Injectable({ providedIn: 'root' })\nexport class PeriodicallyTokenCheckService {\n  constructor(\n    private resetAuthDataService: ResetAuthDataService,\n    private flowHelper: FlowHelper,\n    private configurationProvider: ConfigurationProvider,\n    private flowsDataService: FlowsDataService,\n    private loggerService: LoggerService,\n    private userService: UserService,\n    private authStateService: AuthStateService,\n    private refreshSessionIframeService: RefreshSessionIframeService,\n    private refreshSessionRefreshTokenService: RefreshSessionRefreshTokenService,\n    private intervalService: IntervalService,\n    private storagePersistenceService: StoragePersistenceService,\n    private publicEventsService: PublicEventsService\n  ) {}\n\n  startTokenValidationPeriodically(): void {\n    const configsWithSilentRenewEnabled = this.getConfigsWithSilentRenewEnabled();\n    if (configsWithSilentRenewEnabled.length <= 0) {\n      return;\n    }\n\n    const refreshTimeInSeconds = this.getSmallestRefreshTimeFromConfigs(configsWithSilentRenewEnabled);\n\n    if (!!this.intervalService.runTokenValidationRunning) {\n      return;\n    }\n\n    // START PERIODICALLY CHECK ONCE AND CHECK EACH CONFIG WHICH HAS IT ENABLED\n    const periodicallyCheck$ = this.intervalService.startPeriodicTokenCheck(refreshTimeInSeconds).pipe(\n      switchMap(() => {\n        const objectWithConfigIdsAndRefreshEvent = {};\n        configsWithSilentRenewEnabled.forEach(({ configId }) => {\n          objectWithConfigIdsAndRefreshEvent[configId] = this.getRefreshEvent(configId);\n        });\n\n        return forkJoin(objectWithConfigIdsAndRefreshEvent);\n      })\n    );\n\n    this.intervalService.runTokenValidationRunning = periodicallyCheck$.subscribe((objectWithConfigIds) => {\n      for (const [key, _] of Object.entries(objectWithConfigIds)) {\n        this.loggerService.logDebug(key, 'silent renew, periodic check finished!');\n\n        if (this.flowHelper.isCurrentFlowCodeFlowWithRefreshTokens(key)) {\n          this.flowsDataService.resetSilentRenewRunning(key);\n        }\n      }\n    });\n  }\n\n  private getRefreshEvent(configId: string): Observable<any> {\n    const shouldStartRefreshEvent = this.shouldStartPeriodicallyCheckForConfig(configId);\n\n    if (!shouldStartRefreshEvent) {\n      return of(null);\n    }\n\n    const refreshEvent$ = this.createRefreshEventForConfig(configId);\n\n    this.publicEventsService.fireEvent(EventTypes.SilentRenewStarted);\n\n    const refreshEventWithErrorHandler$ = refreshEvent$.pipe(\n      catchError((error) => {\n        this.loggerService.logError(configId, 'silent renew failed!', error);\n        this.flowsDataService.resetSilentRenewRunning(configId);\n\n        return throwError(error);\n      })\n    );\n\n    return refreshEventWithErrorHandler$;\n  }\n\n  private getSmallestRefreshTimeFromConfigs(configsWithSilentRenewEnabled: OpenIdConfiguration[]): number {\n    const result = configsWithSilentRenewEnabled.reduce((prev, curr) =>\n      prev.tokenRefreshInSeconds < curr.tokenRefreshInSeconds ? prev : curr\n    );\n\n    return result.tokenRefreshInSeconds;\n  }\n\n  private getConfigsWithSilentRenewEnabled(): OpenIdConfiguration[] {\n    return this.configurationProvider.getAllConfigurations().filter((x) => x.silentRenew);\n  }\n\n  private createRefreshEventForConfig(configId: string): Observable<any> {\n    this.loggerService.logDebug(configId, 'starting silent renew...');\n\n    const config = this.configurationProvider.getOpenIDConfiguration(configId);\n\n    if (!config?.silentRenew) {\n      this.resetAuthDataService.resetAuthorizationData(configId);\n\n      return of(null);\n    }\n\n    this.flowsDataService.setSilentRenewRunning(configId);\n\n    if (this.flowHelper.isCurrentFlowCodeFlowWithRefreshTokens(configId)) {\n      // Retrieve Dynamically Set Custom Params for refresh body\n      const customParamsRefresh: { [key: string]: string | number | boolean } =\n        this.storagePersistenceService.read('storageCustomParamsRefresh', configId) || {};\n\n      const { customParamsRefreshTokenRequest } = this.configurationProvider.getOpenIDConfiguration(configId);\n\n      const mergedParams = { ...customParamsRefreshTokenRequest, ...customParamsRefresh };\n\n      // Refresh Session using Refresh tokens\n      return this.refreshSessionRefreshTokenService.refreshSessionWithRefreshTokens(configId, mergedParams);\n    }\n\n    // Retrieve Dynamically Set Custom Params\n    const customParams: { [key: string]: string | number | boolean } = this.storagePersistenceService.read(\n      'storageCustomParamsAuthRequest',\n      configId\n    );\n\n    return this.refreshSessionIframeService.refreshSessionWithIframe(configId, customParams);\n  }\n\n  private shouldStartPeriodicallyCheckForConfig(configId: string): boolean {\n    const idToken = this.authStateService.getIdToken(configId);\n    const isSilentRenewRunning = this.flowsDataService.isSilentRenewRunning(configId);\n    const userDataFromStore = this.userService.getUserDataFromStore(configId);\n\n    this.loggerService.logDebug(\n      configId,\n      `Checking: silentRenewRunning: ${isSilentRenewRunning} - has idToken: ${!!idToken} - has userData: ${!!userDataFromStore}`\n    );\n\n    const shouldBeExecuted = !!userDataFromStore && !isSilentRenewRunning && !!idToken;\n\n    if (!shouldBeExecuted) {\n      return false;\n    }\n\n    const idTokenStillValid = this.authStateService.hasIdTokenExpiredAndRenewCheckIsEnabled(configId);\n    const accessTokenHasExpired = this.authStateService.hasAccessTokenExpiredIfExpiryExists(configId);\n\n    if (!idTokenStillValid && !accessTokenHasExpired) {\n      return false;\n    }\n\n    return true;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable, Subject } from 'rxjs';\nimport { PopupOptions } from './popup-options';\nimport { PopupResult } from './popup-result';\n\n@Injectable({ providedIn: 'root' })\nexport class PopUpService {\n  private STORAGE_IDENTIFIER = 'popupauth';\n  private popUp: Window;\n  private handle: number;\n  private resultInternal$ = new Subject<PopupResult>();\n\n  get result$(): Observable<PopupResult> {\n    return this.resultInternal$.asObservable();\n  }\n\n  isCurrentlyInPopup(): boolean {\n    if (this.canAccessSessionStorage()) {\n      const popup = sessionStorage.getItem(this.STORAGE_IDENTIFIER);\n\n      return !!window.opener && window.opener !== window && !!popup;\n    }\n\n    return false;\n  }\n\n  openPopUp(url: string, popupOptions?: PopupOptions): void {\n    const optionsToPass = this.getOptions(popupOptions);\n    this.popUp = window.open(url, '_blank', optionsToPass);\n    this.popUp.sessionStorage.setItem(this.STORAGE_IDENTIFIER, 'true');\n\n    const listener = (event: MessageEvent): void => {\n      if (!event?.data || typeof event.data !== 'string') {\n        return;\n      }\n\n      this.resultInternal$.next({ userClosed: false, receivedUrl: event.data });\n\n      this.cleanUp(listener);\n    };\n\n    window.addEventListener('message', listener, false);\n\n    this.handle = window.setInterval(() => {\n      if (this.popUp.closed) {\n        this.resultInternal$.next({ userClosed: true });\n\n        this.cleanUp(listener);\n      }\n    }, 200);\n  }\n\n  sendMessageToMainWindow(url: string): void {\n    if (window.opener) {\n      this.sendMessage(url, window.location.href);\n    }\n  }\n\n  private cleanUp(listener: any): void {\n    window.removeEventListener('message', listener, false);\n\n    window.clearInterval(this.handle);\n\n    if (this.popUp) {\n      this.popUp.sessionStorage?.removeItem(this.STORAGE_IDENTIFIER);\n      this.popUp.close();\n      this.popUp = null;\n    }\n  }\n\n  private sendMessage(url: string, href: string): void {\n    window.opener.postMessage(url, href);\n  }\n\n  private getOptions(popupOptions?: PopupOptions): string {\n    const popupDefaultOptions: PopupOptions = { width: 500, height: 500, left: 50, top: 50 };\n\n    const options: PopupOptions = { ...popupDefaultOptions, ...(popupOptions || {}) };\n    const left: number = window.screenLeft + (window.outerWidth - options.width) / 2;\n    const top: number = window.screenTop + (window.outerHeight - options.height) / 2;\n    options.left = left;\n    options.top = top;\n\n    return Object.entries(options)\n      .map(([key, value]) => `${encodeURIComponent(key)}=${encodeURIComponent(value)}`)\n      .join(',');\n  }\n\n  private canAccessSessionStorage(): boolean {\n    return typeof navigator !== 'undefined' && navigator.cookieEnabled && typeof Storage !== 'undefined';\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { forkJoin, Observable, of, throwError } from 'rxjs';\nimport { catchError, map, switchMap, tap } from 'rxjs/operators';\nimport { AuthStateService } from './auth-state/auth-state.service';\nimport { AutoLoginService } from './auto-login/auto-login.service';\nimport { CallbackService } from './callback/callback.service';\nimport { PeriodicallyTokenCheckService } from './callback/periodically-token-check.service';\nimport { RefreshSessionService } from './callback/refresh-session.service';\nimport { OpenIdConfiguration } from './config/openid-configuration';\nimport { ConfigurationProvider } from './config/provider/config.provider';\nimport { CheckSessionService } from './iframe/check-session.service';\nimport { SilentRenewService } from './iframe/silent-renew.service';\nimport { LoggerService } from './logging/logger.service';\nimport { LoginResponse } from './login/login-response';\nimport { PopUpService } from './login/popup/popup.service';\nimport { StoragePersistenceService } from './storage/storage-persistence.service';\nimport { UserService } from './user-data/user.service';\nimport { CurrentUrlService } from './utils/url/current-url.service';\n\n@Injectable()\nexport class CheckAuthService {\n  constructor(\n    private checkSessionService: CheckSessionService,\n    private currentUrlService: CurrentUrlService,\n    private silentRenewService: SilentRenewService,\n    private userService: UserService,\n    private loggerService: LoggerService,\n    private configurationProvider: ConfigurationProvider,\n    private authStateService: AuthStateService,\n    private callbackService: CallbackService,\n    private refreshSessionService: RefreshSessionService,\n    private periodicallyTokenCheckService: PeriodicallyTokenCheckService,\n    private popupService: PopUpService,\n    private autoLoginService: AutoLoginService,\n    private storagePersistenceService: StoragePersistenceService\n  ) {}\n\n  checkAuth(passedConfigId?: string, url?: string): Observable<LoginResponse> {\n    if (this.currentUrlService.currentUrlHasStateParam()) {\n      const stateParamFromUrl = this.currentUrlService.getStateParamFromCurrentUrl();\n      const config = this.getConfigurationWithUrlState(stateParamFromUrl);\n\n      if (!config) {\n        return throwError(`could not find matching config for state ${stateParamFromUrl}`);\n      }\n\n      return this.checkAuthWithConfig(config, url);\n    }\n\n    if (!!passedConfigId) {\n      const config = this.configurationProvider.getOpenIDConfiguration(passedConfigId);\n\n      return this.checkAuthWithConfig(config, url);\n    }\n\n    const onlyExistingConfig = this.configurationProvider.getOpenIDConfiguration();\n\n    return this.checkAuthWithConfig(onlyExistingConfig, url);\n  }\n\n  checkAuthMultiple(passedConfigId?: string, url?: string): Observable<LoginResponse[]> {\n    if (this.currentUrlService.currentUrlHasStateParam()) {\n      const stateParamFromUrl = this.currentUrlService.getStateParamFromCurrentUrl();\n      const config = this.getConfigurationWithUrlState(stateParamFromUrl);\n\n      if (!config) {\n        return throwError(`could not find matching config for state ${stateParamFromUrl}`);\n      }\n\n      return this.composeMultipleLoginResults(config, url);\n    }\n\n    if (!!passedConfigId) {\n      const config = this.configurationProvider.getOpenIDConfiguration(passedConfigId);\n\n      if (!config) {\n        return throwError(`could not find matching config for id ${passedConfigId}`);\n      }\n\n      return this.composeMultipleLoginResults(config, url);\n    }\n\n    const allConfigs = this.configurationProvider.getAllConfigurations();\n    const allChecks$ = allConfigs.map((x) => this.checkAuthWithConfig(x, url));\n\n    return forkJoin(allChecks$);\n  }\n\n  checkAuthIncludingServer(configId: string): Observable<LoginResponse> {\n    const config = this.configurationProvider.getOpenIDConfiguration(configId);\n\n    return this.checkAuthWithConfig(config).pipe(\n      switchMap((loginResponse) => {\n        const { isAuthenticated } = loginResponse;\n\n        if (isAuthenticated) {\n          return of(loginResponse);\n        }\n\n        return this.refreshSessionService.forceRefreshSession(configId).pipe(\n          tap((loginResponseAfterRefreshSession) => {\n            if (loginResponseAfterRefreshSession?.isAuthenticated) {\n              this.startCheckSessionAndValidation(configId);\n            }\n          })\n        );\n      })\n    );\n  }\n\n  private checkAuthWithConfig(config: OpenIdConfiguration, url?: string): Observable<LoginResponse> {\n    const { configId, authority } = config;\n\n    if (!this.configurationProvider.hasAsLeastOneConfig()) {\n      const errorMessage = 'Please provide at least one configuration before setting up the module';\n      this.loggerService.logError(configId, errorMessage);\n\n      return of({ isAuthenticated: false, errorMessage, userData: null, idToken: null, accessToken: null, configId });\n    }\n\n    const currentUrl = url || this.currentUrlService.getCurrentUrl();\n\n    this.loggerService.logDebug(configId, `Working with config '${configId}' using ${authority}`);\n\n    if (this.popupService.isCurrentlyInPopup()) {\n      this.popupService.sendMessageToMainWindow(currentUrl);\n\n      return of(null);\n    }\n\n    const isCallback = this.callbackService.isCallback(currentUrl);\n\n    this.loggerService.logDebug(configId, 'currentUrl to check auth with: ', currentUrl);\n\n    const callback$ = isCallback ? this.callbackService.handleCallbackAndFireEvents(currentUrl, configId) : of(null);\n\n    return callback$.pipe(\n      map(() => {\n        const isAuthenticated = this.authStateService.areAuthStorageTokensValid(configId);\n        if (isAuthenticated) {\n          this.startCheckSessionAndValidation(configId);\n\n          if (!isCallback) {\n            this.authStateService.setAuthenticatedAndFireEvent();\n            this.userService.publishUserDataIfExists(configId);\n          }\n        }\n\n        this.loggerService.logDebug(configId, 'checkAuth completed - firing events now. isAuthenticated: ' + isAuthenticated);\n\n        return {\n          isAuthenticated,\n          userData: this.userService.getUserDataFromStore(configId),\n          accessToken: this.authStateService.getAccessToken(configId),\n          idToken: this.authStateService.getIdToken(configId),\n          configId,\n        };\n      }),\n      tap(({ isAuthenticated }) => {\n        if (isAuthenticated) {\n          this.autoLoginService.checkSavedRedirectRouteAndNavigate(configId);\n        }\n      }),\n      catchError((errorMessage) => {\n        this.loggerService.logError(configId, errorMessage);\n\n        return of({ isAuthenticated: false, errorMessage, userData: null, idToken: null, accessToken: null, configId });\n      })\n    );\n  }\n\n  private startCheckSessionAndValidation(configId: string): void {\n    if (this.checkSessionService.isCheckSessionConfigured(configId)) {\n      this.checkSessionService.start(configId);\n    }\n\n    this.periodicallyTokenCheckService.startTokenValidationPeriodically();\n\n    if (this.silentRenewService.isSilentRenewConfigured(configId)) {\n      this.silentRenewService.getOrCreateIframe(configId);\n    }\n  }\n\n  private getConfigurationWithUrlState(stateFromUrl: string): OpenIdConfiguration {\n    const allConfigs = this.configurationProvider.getAllConfigurations();\n\n    for (const config of allConfigs) {\n      const storedState = this.storagePersistenceService.read('authStateControl', config.configId);\n\n      if (storedState === stateFromUrl) {\n        return config;\n      }\n    }\n\n    return null;\n  }\n\n  private composeMultipleLoginResults(activeConfig: OpenIdConfiguration, url?: string): Observable<LoginResponse[]> {\n    const allOtherConfigs = this.configurationProvider.getAllConfigurations().filter((x) => x.configId !== activeConfig.configId);\n\n    const currentConfigResult = this.checkAuthWithConfig(activeConfig, url);\n\n    const allOtherConfigResults = allOtherConfigs.map((config) => {\n      const { redirectUrl } = config;\n\n      return this.checkAuthWithConfig(config, redirectUrl);\n    });\n\n    return forkJoin([currentConfigResult, ...allOtherConfigResults]);\n  }\n}\n","import { LogLevel } from '../logging/log-level';\nimport { OpenIdConfiguration } from './openid-configuration';\n\nexport const DEFAULT_CONFIG: OpenIdConfiguration = {\n  authority: 'https://please_set',\n  authWellknownEndpointUrl: '',\n  authWellknownEndpoints: null,\n  redirectUrl: 'https://please_set',\n  clientId: 'please_set',\n  responseType: 'code',\n  scope: 'openid email profile',\n  hdParam: '',\n  postLogoutRedirectUri: 'https://please_set',\n  startCheckSession: false,\n  silentRenew: false,\n  silentRenewUrl: 'https://please_set',\n  silentRenewTimeoutInSeconds: 20,\n  renewTimeBeforeTokenExpiresInSeconds: 0,\n  useRefreshToken: false,\n  usePushedAuthorisationRequests: false,\n  ignoreNonceAfterRefresh: false,\n  postLoginRoute: '/',\n  forbiddenRoute: '/forbidden',\n  unauthorizedRoute: '/unauthorized',\n  autoUserInfo: true,\n  autoCleanStateAfterAuthentication: true,\n  triggerAuthorizationResultEvent: false,\n  logLevel: LogLevel.Warn,\n  issValidationOff: false,\n  historyCleanupOff: false,\n  maxIdTokenIatOffsetAllowedInSeconds: 120,\n  disableIatOffsetValidation: false,\n  storage: null,\n  customParamsAuthRequest: {},\n  customParamsRefreshTokenRequest: {},\n  customParamsEndSessionRequest: {},\n  customParamsCodeRequest: {},\n  eagerLoadAuthWellKnownEndpoints: true,\n  disableRefreshIdTokenAuthTimeValidation: false,\n  enableIdTokenExpiredValidationInRenew: true,\n  tokenRefreshInSeconds: 4,\n  refreshTokenRetryInSeconds: 3,\n  ngswBypass: false,\n};\n","import { OpenIdConfiguration } from '../openid-configuration';\n\nexport interface Rule {\n  validate(passedConfig: OpenIdConfiguration): RuleValidationResult;\n}\n\nexport interface RuleValidationResult {\n  result: boolean;\n  messages: string[];\n  level: Level;\n}\n\nexport const POSITIVE_VALIDATION_RESULT = {\n  result: true,\n  messages: [],\n  level: null,\n};\n\nexport type Level = 'warning' | 'error';\n","import { OpenIdConfiguration } from '../../openid-configuration';\nimport { POSITIVE_VALIDATION_RESULT, RuleValidationResult } from '../rule';\n\nexport const ensureAuthority = (passedConfig: OpenIdConfiguration): RuleValidationResult => {\n  if (!passedConfig.authority) {\n    return {\n      result: false,\n      messages: ['The authority URL MUST be provided in the configuration! '],\n      level: 'error',\n    };\n  }\n\n  return POSITIVE_VALIDATION_RESULT;\n};\n","import { OpenIdConfiguration } from '../../openid-configuration';\nimport { POSITIVE_VALIDATION_RESULT, RuleValidationResult } from '../rule';\n\nexport const ensureClientId = (passedConfig: OpenIdConfiguration): RuleValidationResult => {\n  if (!passedConfig.clientId) {\n    return {\n      result: false,\n      messages: ['The clientId is required and missing from your config!'],\n      level: 'error',\n    };\n  }\n\n  return POSITIVE_VALIDATION_RESULT;\n};\n","import { OpenIdConfiguration } from '../../openid-configuration';\nimport { POSITIVE_VALIDATION_RESULT, RuleValidationResult } from '../rule';\n\nconst createIdentifierToCheck = (passedConfig: OpenIdConfiguration): string => {\n  if (!passedConfig) {\n    return null;\n  }\n\n  const { authority, clientId, scope } = passedConfig;\n\n  return `${authority}${clientId}${scope}`;\n};\n\nconst arrayHasDuplicates = (array: string[]): boolean => new Set(array).size !== array.length;\n\nexport const ensureNoDuplicatedConfigsRule = (passedConfigs: OpenIdConfiguration[]): RuleValidationResult => {\n  const allIdentifiers = passedConfigs.map((x) => createIdentifierToCheck(x));\n\n  const someAreNull = allIdentifiers.some((x) => x === null);\n\n  if (someAreNull) {\n    return {\n      result: false,\n      messages: [`Please make sure you add an object with a 'config' property: ....({ config }) instead of ...(config)`],\n      level: 'error',\n    };\n  }\n\n  const hasDuplicates = arrayHasDuplicates(allIdentifiers);\n\n  if (hasDuplicates) {\n    return {\n      result: false,\n      messages: ['You added multiple configs with the same authority, clientId and scope'],\n      level: 'warning',\n    };\n  }\n\n  return POSITIVE_VALIDATION_RESULT;\n};\n","import { OpenIdConfiguration } from '../../openid-configuration';\nimport { POSITIVE_VALIDATION_RESULT, RuleValidationResult } from '../rule';\n\nexport const ensureRedirectRule = (passedConfig: OpenIdConfiguration): RuleValidationResult => {\n  if (!passedConfig.redirectUrl) {\n    return {\n      result: false,\n      messages: ['The redirectURL is required and missing from your config'],\n      level: 'error',\n    };\n  }\n\n  return POSITIVE_VALIDATION_RESULT;\n};\n","import { OpenIdConfiguration } from '../../openid-configuration';\nimport { POSITIVE_VALIDATION_RESULT, RuleValidationResult } from '../rule';\n\nexport const ensureSilentRenewUrlWhenNoRefreshTokenUsed = (passedConfig: OpenIdConfiguration): RuleValidationResult => {\n  const usesSilentRenew = passedConfig.silentRenew;\n  const usesRefreshToken = passedConfig.useRefreshToken;\n  const hasSilentRenewUrl = passedConfig.silentRenewUrl;\n\n  if (usesSilentRenew && !usesRefreshToken && !hasSilentRenewUrl) {\n    return {\n      result: false,\n      messages: ['Please provide a silent renew URL if using renew and not refresh tokens'],\n      level: 'error',\n    };\n  }\n\n  return POSITIVE_VALIDATION_RESULT;\n};\n","import { OpenIdConfiguration } from '../../openid-configuration';\nimport { POSITIVE_VALIDATION_RESULT, RuleValidationResult } from '../rule';\n\nexport const useOfflineScopeWithSilentRenew = (passedConfig: OpenIdConfiguration): RuleValidationResult => {\n  const hasRefreshToken = passedConfig.useRefreshToken;\n  const hasSilentRenew = passedConfig.silentRenew;\n  const scope = passedConfig.scope || '';\n  const hasOfflineScope = scope.split(' ').includes('offline_access');\n\n  if (hasRefreshToken && hasSilentRenew && !hasOfflineScope) {\n    return {\n      result: false,\n      messages: ['When using silent renew and refresh tokens please set the `offline_access` scope'],\n      level: 'warning',\n    };\n  }\n\n  return POSITIVE_VALIDATION_RESULT;\n};\n","import { ensureAuthority } from './ensure-authority.rule';\nimport { ensureClientId } from './ensure-clientId.rule';\nimport { ensureNoDuplicatedConfigsRule } from './ensure-no-duplicated-configs.rule';\nimport { ensureRedirectRule } from './ensure-redirect-url.rule';\nimport { ensureSilentRenewUrlWhenNoRefreshTokenUsed } from './ensure-silentRenewUrl-with-no-refreshtokens.rule';\nimport { useOfflineScopeWithSilentRenew } from './use-offline-scope-with-silent-renew.rule';\n\nexport const allRules = [\n  ensureAuthority,\n  useOfflineScopeWithSilentRenew,\n  ensureRedirectRule,\n  ensureClientId,\n  ensureSilentRenewUrlWhenNoRefreshTokenUsed,\n];\n\nexport const allMultipleConfigRules = [ensureNoDuplicatedConfigsRule];\n","import { Injectable } from '@angular/core';\nimport { LoggerService } from '../../logging/logger.service';\nimport { OpenIdConfiguration } from '../openid-configuration';\nimport { Level, RuleValidationResult } from './rule';\nimport { allRules } from './rules';\nimport { allMultipleConfigRules } from './rules/index';\n\n@Injectable()\nexport class ConfigValidationService {\n  constructor(private loggerService: LoggerService) {}\n\n  validateConfigs(passedConfigs: OpenIdConfiguration[]): boolean {\n    return this.validateConfigsInternal(passedConfigs, allMultipleConfigRules);\n  }\n\n  validateConfig(passedConfig: OpenIdConfiguration): boolean {\n    return this.validateConfigInternal(passedConfig, allRules);\n  }\n\n  private validateConfigsInternal(passedConfigs: OpenIdConfiguration[], allRulesToUse: any[]): boolean {\n    const allValidationResults = allRulesToUse.map((rule) => rule(passedConfigs));\n\n    let overallErrorCount = 0;\n    passedConfigs.forEach((passedConfig) => {\n      const errorCount = this.processValidationResultsAndGetErrorCount(allValidationResults, passedConfig?.configId);\n      overallErrorCount += errorCount;\n    });\n\n    return overallErrorCount === 0;\n  }\n\n  private validateConfigInternal(passedConfig: OpenIdConfiguration, allRulesToUse: any[]): boolean {\n    const allValidationResults = allRulesToUse.map((rule) => rule(passedConfig));\n\n    const errorCount = this.processValidationResultsAndGetErrorCount(allValidationResults, passedConfig.configId);\n\n    return errorCount === 0;\n  }\n\n  private processValidationResultsAndGetErrorCount(allValidationResults: RuleValidationResult[], configId: string): number {\n    const allMessages = allValidationResults.filter((x) => x.messages.length > 0);\n\n    const allErrorMessages = this.getAllMessagesOfType('error', allMessages);\n    const allWarnings = this.getAllMessagesOfType('warning', allMessages);\n    allErrorMessages.forEach((message) => this.loggerService.logError(configId, message));\n    allWarnings.forEach((message) => this.loggerService.logWarning(configId, message));\n\n    return allErrorMessages.length;\n  }\n\n  private getAllMessagesOfType(type: Level, results: RuleValidationResult[]): string[] {\n    const allMessages = results.filter((x) => x.level === type).map((result) => result.messages);\n\n    return allMessages.reduce((acc, val) => acc.concat(val), []);\n  }\n}\n","import { isPlatformBrowser } from '@angular/common';\nimport { Inject, Injectable, PLATFORM_ID } from '@angular/core';\n\n@Injectable()\nexport class PlatformProvider {\n  get isBrowser(): boolean {\n    return isPlatformBrowser(this.platformId);\n  }\n\n  constructor(@Inject(PLATFORM_ID) private platformId: string) {}\n}\n","import { Injectable } from '@angular/core';\nimport { AbstractSecurityStorage } from './abstract-security-storage';\n\n@Injectable()\nexport class DefaultSessionStorageService implements AbstractSecurityStorage {\n  public read(key: string): any {\n    return sessionStorage.getItem(key);\n  }\n\n  public write(key: string, value: any): void {\n    sessionStorage.setItem(key, value);\n  }\n\n  public remove(key: string): void {\n    sessionStorage.removeItem(key);\n  }\n\n  public clear(): void {\n    sessionStorage.clear();\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { throwError } from 'rxjs';\nimport { catchError, tap } from 'rxjs/operators';\nimport { LoggerService } from '../logging/logger.service';\nimport { EventTypes } from '../public-events/event-types';\nimport { PublicEventsService } from '../public-events/public-events.service';\nimport { StoragePersistenceService } from '../storage/storage-persistence.service';\nimport { PlatformProvider } from '../utils/platform-provider/platform.provider';\nimport { DefaultSessionStorageService } from './../storage/default-sessionstorage.service';\nimport { AuthWellKnownService } from './auth-well-known/auth-well-known.service';\nimport { DEFAULT_CONFIG } from './default-config';\nimport { OpenIdConfiguration } from './openid-configuration';\nimport { ConfigurationProvider } from './provider/config.provider';\nimport { ConfigValidationService } from './validation/config-validation.service';\n\n@Injectable()\nexport class OidcConfigService {\n  constructor(\n    private loggerService: LoggerService,\n    private publicEventsService: PublicEventsService,\n    private configurationProvider: ConfigurationProvider,\n    private authWellKnownService: AuthWellKnownService,\n    private storagePersistenceService: StoragePersistenceService,\n    private configValidationService: ConfigValidationService,\n    private platformProvider: PlatformProvider,\n    private defaultSessionStorageService: DefaultSessionStorageService\n  ) {}\n\n  withConfigs(passedConfigs: OpenIdConfiguration[]): Promise<OpenIdConfiguration[]> {\n    if (!this.configValidationService.validateConfigs(passedConfigs)) {\n      return Promise.resolve(null);\n    }\n\n    this.createUniqueIds(passedConfigs);\n    const allHandleConfigPromises = passedConfigs.map((x) => this.handleConfig(x));\n\n    return Promise.all(allHandleConfigPromises);\n  }\n\n  private createUniqueIds(passedConfigs: OpenIdConfiguration[]): void {\n    passedConfigs.forEach((config, index) => {\n      if (!config.configId) {\n        config.configId = `${index}-${config.clientId}`;\n      }\n    });\n  }\n\n  private handleConfig(passedConfig: OpenIdConfiguration): Promise<OpenIdConfiguration> {\n    return new Promise((resolve, reject) => {\n      if (!this.configValidationService.validateConfig(passedConfig)) {\n        this.loggerService.logError(passedConfig.configId, 'Validation of config rejected with errors. Config is NOT set.');\n        resolve(null);\n\n        return;\n      }\n\n      if (!passedConfig.authWellknownEndpointUrl) {\n        passedConfig.authWellknownEndpointUrl = passedConfig.authority;\n      }\n\n      const usedConfig = this.prepareConfig(passedConfig);\n      this.configurationProvider.setConfig(usedConfig);\n\n      const alreadyExistingAuthWellKnownEndpoints = this.storagePersistenceService.read('authWellKnownEndPoints', usedConfig.configId);\n      if (!!alreadyExistingAuthWellKnownEndpoints) {\n        usedConfig.authWellknownEndpoints = alreadyExistingAuthWellKnownEndpoints;\n        this.publicEventsService.fireEvent<OpenIdConfiguration>(EventTypes.ConfigLoaded, usedConfig);\n\n        resolve(usedConfig);\n\n        return;\n      }\n\n      const passedAuthWellKnownEndpoints = usedConfig.authWellknownEndpoints;\n\n      if (!!passedAuthWellKnownEndpoints) {\n        this.authWellKnownService.storeWellKnownEndpoints(usedConfig.configId, passedAuthWellKnownEndpoints);\n        usedConfig.authWellknownEndpoints = passedAuthWellKnownEndpoints;\n        this.publicEventsService.fireEvent<OpenIdConfiguration>(EventTypes.ConfigLoaded, usedConfig);\n\n        resolve(usedConfig);\n\n        return;\n      }\n\n      if (usedConfig.eagerLoadAuthWellKnownEndpoints) {\n        this.authWellKnownService\n          .getAuthWellKnownEndPoints(usedConfig.authWellknownEndpointUrl, usedConfig.configId)\n          .pipe(\n            catchError((error) => {\n              this.loggerService.logError(usedConfig.configId, 'Getting auth well known endpoints failed on start', error);\n\n              return throwError(error);\n            }),\n            tap((wellknownEndPoints) => {\n              usedConfig.authWellknownEndpoints = wellknownEndPoints;\n              this.publicEventsService.fireEvent<OpenIdConfiguration>(EventTypes.ConfigLoaded, usedConfig);\n            })\n          )\n          .subscribe(\n            () => resolve(usedConfig),\n\n            () => reject()\n          );\n      } else {\n        this.publicEventsService.fireEvent<OpenIdConfiguration>(EventTypes.ConfigLoaded, usedConfig);\n        resolve(usedConfig);\n      }\n    });\n  }\n\n  private prepareConfig(configuration: OpenIdConfiguration): OpenIdConfiguration {\n    const openIdConfigurationInternal = { ...DEFAULT_CONFIG, ...configuration };\n    this.setSpecialCases(openIdConfigurationInternal);\n    this.setStorage(openIdConfigurationInternal);\n\n    return openIdConfigurationInternal;\n  }\n\n  private setSpecialCases(currentConfig: OpenIdConfiguration): void {\n    if (!this.platformProvider.isBrowser) {\n      currentConfig.startCheckSession = false;\n      currentConfig.silentRenew = false;\n      currentConfig.useRefreshToken = false;\n      currentConfig.usePushedAuthorisationRequests = false;\n    }\n  }\n\n  private setStorage(currentConfig: OpenIdConfiguration): void {\n    if (currentConfig.storage) {\n      return;\n    }\n\n    if (this.hasBrowserStorage()) {\n      currentConfig.storage = this.defaultSessionStorageService;\n    } else {\n      currentConfig.storage = null;\n    }\n  }\n\n  private hasBrowserStorage(): boolean {\n    return typeof navigator !== 'undefined' && navigator.cookieEnabled && typeof Storage !== 'undefined';\n  }\n}\n","import { Provider } from '@angular/core';\nimport { OpenIdConfiguration } from '../openid-configuration';\n\nexport class OpenIdConfigLoader {\n  loader?: Provider;\n}\n\nexport abstract class StsConfigLoader {\n  abstract loadConfigs(): Promise<OpenIdConfiguration>[];\n}\n\nexport class StsConfigStaticLoader implements StsConfigLoader {\n  constructor(private passedConfigs: OpenIdConfiguration | OpenIdConfiguration[]) {}\n\n  loadConfigs(): Promise<OpenIdConfiguration>[] {\n    if (Array.isArray(this.passedConfigs)) {\n      const allInstantStaticPromises = this.passedConfigs.map((x) => new Promise((resolve, _) => resolve(x)));\n\n      return allInstantStaticPromises;\n    }\n\n    const singleStaticPromise = new Promise((resolve, _) => resolve(this.passedConfigs));\n\n    return [singleStaticPromise];\n  }\n}\n\nexport class StsConfigHttpLoader implements StsConfigLoader {\n  constructor(private configs$: Promise<OpenIdConfiguration> | Promise<OpenIdConfiguration>[]) {}\n\n  loadConfigs(): Promise<OpenIdConfiguration>[] {\n    return Array.isArray(this.configs$) ? this.configs$ : [this.configs$];\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { ConfigurationProvider } from '../config/provider/config.provider';\n\n@Injectable()\nexport class ClosestMatchingRouteService {\n  constructor(private configProvider: ConfigurationProvider) {}\n\n  getConfigIdForClosestMatchingRoute(route: string): ClosestMatchingRouteResult {\n    const allConfiguredRoutes = this.getAllConfiguredRoutes();\n\n    for (const routesWithConfig of allConfiguredRoutes) {\n      const allRoutesForConfig = routesWithConfig.routes;\n\n      for (const configuredRoute of allRoutesForConfig) {\n        if (route.startsWith(configuredRoute)) {\n          return {\n            matchingRoute: configuredRoute,\n            matchingConfigId: routesWithConfig.configId,\n          };\n        }\n      }\n    }\n\n    return {\n      matchingRoute: null,\n      matchingConfigId: null,\n    };\n  }\n\n  private getAllConfiguredRoutes(): ConfiguredRoutesWithConfig[] {\n    const allConfigurations = this.configProvider.getAllConfigurations();\n\n    return allConfigurations.map((x) => ({ routes: x.secureRoutes, configId: x.configId }));\n  }\n}\n\nexport interface ConfiguredRoutesWithConfig {\n  routes: string[];\n  configId: string;\n}\n\nexport interface ClosestMatchingRouteResult {\n  matchingRoute: string;\n  matchingConfigId: string;\n}\n","import { Injectable } from '@angular/core';\nimport { LoggerService } from '../../logging/logger.service';\nimport { FlowHelper } from '../../utils/flowHelper/flow-helper.service';\n\n@Injectable()\nexport class ResponseTypeValidationService {\n  constructor(private loggerService: LoggerService, private flowHelper: FlowHelper) {}\n\n  hasConfigValidResponseType(configId: string): boolean {\n    if (this.flowHelper.isCurrentFlowAnyImplicitFlow(configId)) {\n      return true;\n    }\n\n    if (this.flowHelper.isCurrentFlowCodeFlow(configId)) {\n      return true;\n    }\n\n    this.loggerService.logWarning(configId, 'module configured incorrectly, invalid response_type. Check the responseType in the config');\n\n    return false;\n  }\n}\n","import { DOCUMENT } from '@angular/common';\nimport { Inject, Injectable } from '@angular/core';\n\n@Injectable({ providedIn: 'root' })\nexport class RedirectService {\n  constructor(@Inject(DOCUMENT) private readonly doc: any) {}\n\n  redirectTo(url): void {\n    this.doc.location.href = url;\n  }\n}\n","import { HttpHeaders } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable, throwError } from 'rxjs';\nimport { catchError, map, retry } from 'rxjs/operators';\nimport { DataService } from '../../api/data.service';\nimport { LoggerService } from '../../logging/logger.service';\nimport { StoragePersistenceService } from '../../storage/storage-persistence.service';\nimport { UrlService } from '../../utils/url/url.service';\nimport { ParResponse } from './par-response';\n\n@Injectable()\nexport class ParService {\n  constructor(\n    private loggerService: LoggerService,\n    private urlService: UrlService,\n    private dataService: DataService,\n    private storagePersistenceService: StoragePersistenceService\n  ) {}\n\n  postParRequest(configId: string, customParams?: { [key: string]: string | number | boolean }): Observable<ParResponse> {\n    let headers: HttpHeaders = new HttpHeaders();\n    headers = headers.set('Content-Type', 'application/x-www-form-urlencoded');\n\n    const authWellknownEndpoints = this.storagePersistenceService.read('authWellKnownEndPoints', configId);\n\n    if (!authWellknownEndpoints) {\n      return throwError('Could not read PAR endpoint because authWellKnownEndPoints are not given');\n    }\n\n    const parEndpoint = authWellknownEndpoints.parEndpoint;\n    if (!parEndpoint) {\n      return throwError('Could not read PAR endpoint from authWellKnownEndpoints');\n    }\n\n    const data = this.urlService.createBodyForParCodeFlowRequest(configId, customParams);\n\n    return this.dataService.post(parEndpoint, data, configId, headers).pipe(\n      retry(2),\n      map((response: any) => {\n        this.loggerService.logDebug(configId, 'par response: ', response);\n\n        return {\n          expiresIn: response.expires_in,\n          requestUri: response.request_uri,\n        };\n      }),\n      catchError((error) => {\n        const errorMessage = `There was an error on ParService postParRequest`;\n        this.loggerService.logError(configId, errorMessage, error);\n\n        return throwError(errorMessage);\n      })\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable, of, throwError } from 'rxjs';\nimport { switchMap, take } from 'rxjs/operators';\nimport { AuthOptions } from '../../auth-options';\nimport { CheckAuthService } from '../../check-auth.service';\nimport { AuthWellKnownService } from '../../config/auth-well-known/auth-well-known.service';\nimport { ConfigurationProvider } from '../../config/provider/config.provider';\nimport { LoggerService } from '../../logging/logger.service';\nimport { RedirectService } from '../../utils/redirect/redirect.service';\nimport { UrlService } from '../../utils/url/url.service';\nimport { LoginResponse } from '../login-response';\nimport { PopupOptions } from '../popup/popup-options';\nimport { PopupResultReceivedUrl } from '../popup/popup-result';\nimport { PopUpService } from '../popup/popup.service';\nimport { ResponseTypeValidationService } from '../response-type-validation/response-type-validation.service';\nimport { ParResponse } from './par-response';\nimport { ParService } from './par.service';\n\n@Injectable()\nexport class ParLoginService {\n  constructor(\n    private loggerService: LoggerService,\n    private responseTypeValidationService: ResponseTypeValidationService,\n    private urlService: UrlService,\n    private redirectService: RedirectService,\n    private configurationProvider: ConfigurationProvider,\n    private authWellKnownService: AuthWellKnownService,\n    private popupService: PopUpService,\n    private checkAuthService: CheckAuthService,\n    private parService: ParService\n  ) {}\n\n  loginPar(configId: string, authOptions?: AuthOptions): void {\n    if (!this.responseTypeValidationService.hasConfigValidResponseType(configId)) {\n      this.loggerService.logError(configId, 'Invalid response type!');\n\n      return;\n    }\n\n    const { authWellknownEndpointUrl } = this.configurationProvider.getOpenIDConfiguration(configId);\n\n    if (!authWellknownEndpointUrl) {\n      this.loggerService.logError(configId, 'no authWellknownEndpoint given!');\n\n      return;\n    }\n\n    this.loggerService.logDebug(configId, 'BEGIN Authorize OIDC Flow, no auth data');\n\n    const { urlHandler, customParams } = authOptions || {};\n\n    this.authWellKnownService\n      .getAuthWellKnownEndPoints(authWellknownEndpointUrl, configId)\n      .pipe(switchMap(() => this.parService.postParRequest(configId, customParams)))\n      .subscribe((response) => {\n        this.loggerService.logDebug(configId, 'par response: ', response);\n\n        const url = this.urlService.getAuthorizeParUrl(response.requestUri, configId);\n\n        this.loggerService.logDebug(configId, 'par request url: ', url);\n\n        if (!url) {\n          this.loggerService.logError(configId, `Could not create URL with param ${response.requestUri}: '${url}'`);\n\n          return;\n        }\n\n        if (urlHandler) {\n          urlHandler(url);\n        } else {\n          this.redirectService.redirectTo(url);\n        }\n      });\n  }\n\n  loginWithPopUpPar(configId: string, authOptions?: AuthOptions, popupOptions?: PopupOptions): Observable<LoginResponse> {\n    if (!this.responseTypeValidationService.hasConfigValidResponseType(configId)) {\n      const errorMessage = 'Invalid response type!';\n      this.loggerService.logError(configId, errorMessage);\n\n      return throwError(errorMessage);\n    }\n\n    const { authWellknownEndpointUrl } = this.configurationProvider.getOpenIDConfiguration(configId);\n\n    if (!authWellknownEndpointUrl) {\n      const errorMessage = 'no authWellknownEndpoint given!';\n      this.loggerService.logError(configId, errorMessage);\n\n      return throwError(errorMessage);\n    }\n\n    this.loggerService.logDebug(configId, 'BEGIN Authorize OIDC Flow with popup, no auth data');\n\n    const { customParams } = authOptions || {};\n\n    return this.authWellKnownService.getAuthWellKnownEndPoints(authWellknownEndpointUrl, configId).pipe(\n      switchMap(() => this.parService.postParRequest(configId, customParams)),\n      switchMap((response: ParResponse) => {\n        this.loggerService.logDebug(configId, 'par response: ', response);\n\n        const url = this.urlService.getAuthorizeParUrl(response.requestUri, configId);\n\n        this.loggerService.logDebug(configId, 'par request url: ', url);\n\n        if (!url) {\n          const errorMessage = `Could not create URL with param ${response.requestUri}: 'url'`;\n          this.loggerService.logError(configId, errorMessage);\n\n          return throwError(errorMessage);\n        }\n\n        this.popupService.openPopUp(url, popupOptions);\n\n        return this.popupService.result$.pipe(\n          take(1),\n          switchMap((result: PopupResultReceivedUrl) => {\n            const { userClosed, receivedUrl } = result;\n\n            if (userClosed) {\n              return of({\n                isAuthenticated: false,\n                errorMessage: 'User closed popup',\n                userData: null,\n                idToken: null,\n                accessToken: null,\n                configId,\n              });\n            }\n\n            return this.checkAuthService.checkAuth(configId, receivedUrl);\n          })\n        );\n      })\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable, of, throwError } from 'rxjs';\nimport { switchMap, take } from 'rxjs/operators';\nimport { AuthOptions } from '../../auth-options';\nimport { CheckAuthService } from '../../check-auth.service';\nimport { AuthWellKnownService } from '../../config/auth-well-known/auth-well-known.service';\nimport { ConfigurationProvider } from '../../config/provider/config.provider';\nimport { LoggerService } from '../../logging/logger.service';\nimport { UrlService } from '../../utils/url/url.service';\nimport { LoginResponse } from '../login-response';\nimport { PopupOptions } from '../popup/popup-options';\nimport { PopUpService } from '../popup/popup.service';\nimport { ResponseTypeValidationService } from '../response-type-validation/response-type-validation.service';\nimport { PopupResultReceivedUrl } from './popup-result';\n\n@Injectable()\nexport class PopUpLoginService {\n  constructor(\n    private loggerService: LoggerService,\n    private responseTypeValidationService: ResponseTypeValidationService,\n    private urlService: UrlService,\n    private configurationProvider: ConfigurationProvider,\n    private authWellKnownService: AuthWellKnownService,\n    private popupService: PopUpService,\n    private checkAuthService: CheckAuthService\n  ) {}\n\n  loginWithPopUpStandard(configId: string, authOptions?: AuthOptions, popupOptions?: PopupOptions): Observable<LoginResponse> {\n    if (!this.responseTypeValidationService.hasConfigValidResponseType(configId)) {\n      const errorMessage = 'Invalid response type!';\n      this.loggerService.logError(configId, errorMessage);\n\n      return throwError(errorMessage);\n    }\n\n    const { authWellknownEndpointUrl } = this.configurationProvider.getOpenIDConfiguration(configId);\n\n    if (!authWellknownEndpointUrl) {\n      const errorMessage = 'no authWellknownEndpoint given!';\n      this.loggerService.logError(configId, errorMessage);\n\n      return throwError(errorMessage);\n    }\n\n    this.loggerService.logDebug(configId, 'BEGIN Authorize OIDC Flow with popup, no auth data');\n\n    return this.authWellKnownService.getAuthWellKnownEndPoints(authWellknownEndpointUrl, configId).pipe(\n      switchMap(() => {\n        const { customParams } = authOptions || {};\n\n        const authUrl = this.urlService.getAuthorizeUrl(configId, customParams);\n\n        this.popupService.openPopUp(authUrl, popupOptions);\n\n        return this.popupService.result$.pipe(\n          take(1),\n          switchMap((result: PopupResultReceivedUrl) => {\n            const { userClosed, receivedUrl } = result;\n\n            if (userClosed) {\n              return of({\n                isAuthenticated: false,\n                errorMessage: 'User closed popup',\n                userData: null,\n                idToken: null,\n                accessToken: null,\n                configId,\n              });\n            }\n\n            return this.checkAuthService.checkAuth(configId, receivedUrl);\n          })\n        );\n      })\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { AuthOptions } from '../../auth-options';\nimport { AuthWellKnownService } from '../../config/auth-well-known/auth-well-known.service';\nimport { ConfigurationProvider } from '../../config/provider/config.provider';\nimport { LoggerService } from '../../logging/logger.service';\nimport { RedirectService } from '../../utils/redirect/redirect.service';\nimport { UrlService } from '../../utils/url/url.service';\nimport { ResponseTypeValidationService } from '../response-type-validation/response-type-validation.service';\n\n@Injectable()\nexport class StandardLoginService {\n  constructor(\n    private loggerService: LoggerService,\n    private responseTypeValidationService: ResponseTypeValidationService,\n    private urlService: UrlService,\n    private redirectService: RedirectService,\n    private configurationProvider: ConfigurationProvider,\n    private authWellKnownService: AuthWellKnownService\n  ) {}\n\n  loginStandard(configId: string, authOptions?: AuthOptions): void {\n    if (!this.responseTypeValidationService.hasConfigValidResponseType(configId)) {\n      this.loggerService.logError(configId, 'Invalid response type!');\n\n      return;\n    }\n\n    const { authWellknownEndpointUrl } = this.configurationProvider.getOpenIDConfiguration(configId);\n\n    if (!authWellknownEndpointUrl) {\n      this.loggerService.logError(configId, 'no authWellknownEndpoint given!');\n\n      return;\n    }\n\n    this.loggerService.logDebug(configId, 'BEGIN Authorize OIDC Flow, no auth data');\n\n    this.authWellKnownService.getAuthWellKnownEndPoints(authWellknownEndpointUrl, configId).subscribe(() => {\n      const { urlHandler, customParams } = authOptions || {};\n\n      const url = this.urlService.getAuthorizeUrl(configId, customParams);\n\n      if (!url) {\n        this.loggerService.logError(configId, 'Could not create URL', url);\n\n        return;\n      }\n\n      if (urlHandler) {\n        urlHandler(url);\n      } else {\n        this.redirectService.redirectTo(url);\n      }\n    });\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { AuthOptions } from '../auth-options';\nimport { ConfigurationProvider } from '../config/provider/config.provider';\nimport { StoragePersistenceService } from '../storage/storage-persistence.service';\nimport { LoginResponse } from './login-response';\nimport { ParLoginService } from './par/par-login.service';\nimport { PopUpLoginService } from './popup/popup-login.service';\nimport { PopupOptions } from './popup/popup-options';\nimport { StandardLoginService } from './standard/standard-login.service';\n\n@Injectable()\nexport class LoginService {\n  constructor(\n    private configurationProvider: ConfigurationProvider,\n    private parLoginService: ParLoginService,\n    private popUpLoginService: PopUpLoginService,\n    private standardLoginService: StandardLoginService,\n    private storagePersistenceService: StoragePersistenceService\n  ) {}\n\n  login(configId: string, authOptions?: AuthOptions): void {\n    if (authOptions?.customParams) {\n      this.storagePersistenceService.write('storageCustomParamsAuthRequest', authOptions.customParams, configId);\n    }\n\n    const { usePushedAuthorisationRequests } = this.configurationProvider.getOpenIDConfiguration(configId);\n\n    if (usePushedAuthorisationRequests) {\n      return this.parLoginService.loginPar(configId, authOptions);\n    } else {\n      return this.standardLoginService.loginStandard(configId, authOptions);\n    }\n  }\n\n  loginWithPopUp(configId: string, authOptions?: AuthOptions, popupOptions?: PopupOptions): Observable<LoginResponse> {\n    if (authOptions?.customParams) {\n      this.storagePersistenceService.write('storageCustomParamsAuthRequest', authOptions.customParams, configId);\n    }\n\n    const { usePushedAuthorisationRequests } = this.configurationProvider.getOpenIDConfiguration(configId);\n\n    if (usePushedAuthorisationRequests) {\n      return this.parLoginService.loginWithPopUpPar(configId, authOptions, popupOptions);\n    } else {\n      return this.popUpLoginService.loginWithPopUpStandard(configId, authOptions, popupOptions);\n    }\n  }\n}\n","import { HttpHeaders } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable, of, throwError } from 'rxjs';\nimport { catchError, retry, switchMap, tap } from 'rxjs/operators';\nimport { DataService } from '../api/data.service';\nimport { AuthOptions } from '../auth-options';\nimport { ConfigurationProvider } from '../config/provider/config.provider';\nimport { ResetAuthDataService } from '../flows/reset-auth-data.service';\nimport { CheckSessionService } from '../iframe/check-session.service';\nimport { LoggerService } from '../logging/logger.service';\nimport { StoragePersistenceService } from '../storage/storage-persistence.service';\nimport { RedirectService } from '../utils/redirect/redirect.service';\nimport { UrlService } from '../utils/url/url.service';\n\n@Injectable()\nexport class LogoffRevocationService {\n  constructor(\n    private dataService: DataService,\n    private storagePersistenceService: StoragePersistenceService,\n    private loggerService: LoggerService,\n    private urlService: UrlService,\n    private checkSessionService: CheckSessionService,\n    private resetAuthDataService: ResetAuthDataService,\n    private redirectService: RedirectService,\n    private configurationProvider: ConfigurationProvider\n  ) {}\n\n  // Logs out on the server and the local client.\n  // If the server state has changed, check session, then only a local logout.\n  logoff(configId: string, authOptions?: AuthOptions): void {\n    const { urlHandler, customParams } = authOptions || {};\n\n    this.loggerService.logDebug(configId, 'logoff, remove auth ');\n\n    const endSessionUrl = this.getEndSessionUrl(configId, customParams);\n\n    this.resetAuthDataService.resetAuthorizationData(configId);\n\n    if (!endSessionUrl) {\n      this.loggerService.logDebug(configId, 'only local login cleaned up, no end_session_endpoint');\n\n      return;\n    }\n\n    if (this.checkSessionService.serverStateChanged(configId)) {\n      this.loggerService.logDebug(configId, 'only local login cleaned up, server session has changed');\n    } else if (urlHandler) {\n      urlHandler(endSessionUrl);\n    } else {\n      this.redirectService.redirectTo(endSessionUrl);\n    }\n  }\n\n  logoffLocal(configId: string): void {\n    this.resetAuthDataService.resetAuthorizationData(configId);\n    this.checkSessionService.stop();\n  }\n\n  logoffLocalMultiple(): void {\n    const allConfigs = this.configurationProvider.getAllConfigurations();\n\n    allConfigs.forEach(({ configId }) => this.logoffLocal(configId));\n  }\n\n  // The refresh token and and the access token are revoked on the server. If the refresh token does not exist\n  // only the access token is revoked. Then the logout run.\n  logoffAndRevokeTokens(configId: string, authOptions?: AuthOptions): Observable<any> {\n    const { revocationEndpoint } = this.storagePersistenceService.read('authWellKnownEndPoints', configId) || {};\n\n    if (!revocationEndpoint) {\n      this.loggerService.logDebug(configId, 'revocation endpoint not supported');\n      this.logoff(configId, authOptions);\n    }\n\n    if (this.storagePersistenceService.getRefreshToken(configId)) {\n      return this.revokeRefreshToken(configId).pipe(\n        switchMap((result) => this.revokeAccessToken(configId, result)),\n        catchError((error) => {\n          const errorMessage = `revoke token failed`;\n          this.loggerService.logError(configId, errorMessage, error);\n\n          return throwError(errorMessage);\n        }),\n        tap(() => this.logoff(configId, authOptions))\n      );\n    } else {\n      return this.revokeAccessToken(configId).pipe(\n        catchError((error) => {\n          const errorMessage = `revoke accessToken failed`;\n          this.loggerService.logError(configId, errorMessage, error);\n\n          return throwError(errorMessage);\n        }),\n        tap(() => this.logoff(configId, authOptions))\n      );\n    }\n  }\n\n  // https://tools.ietf.org/html/rfc7009\n  // revokes an access token on the STS. If no token is provided, then the token from\n  // the storage is revoked. You can pass any token to revoke. This makes it possible to\n  // manage your own tokens. The is a public API.\n  revokeAccessToken(configId: string, accessToken?: any): Observable<any> {\n    const accessTok = accessToken || this.storagePersistenceService.getAccessToken(configId);\n    const body = this.urlService.createRevocationEndpointBodyAccessToken(accessTok, configId);\n\n    return this.sendRevokeRequest(configId, body);\n  }\n\n  // https://tools.ietf.org/html/rfc7009\n  // revokes an refresh token on the STS. This is only required in the code flow with refresh tokens.\n  // If no token is provided, then the token from the storage is revoked. You can pass any token to revoke.\n  // This makes it possible to manage your own tokens.\n  revokeRefreshToken(configId: string, refreshToken?: any): Observable<any> {\n    const refreshTok = refreshToken || this.storagePersistenceService.getRefreshToken(configId);\n    const body = this.urlService.createRevocationEndpointBodyRefreshToken(refreshTok, configId);\n\n    return this.sendRevokeRequest(configId, body);\n  }\n\n  getEndSessionUrl(configId: string, customParams?: { [p: string]: string | number | boolean }): string | null {\n    const idToken = this.storagePersistenceService.getIdToken(configId);\n    const { customParamsEndSessionRequest } = this.configurationProvider.getOpenIDConfiguration();\n\n    const mergedParams = { ...customParamsEndSessionRequest, ...customParams };\n\n    return this.urlService.createEndSessionUrl(idToken, configId, mergedParams);\n  }\n\n  private sendRevokeRequest(configId: string, body: string): Observable<any> {\n    const url = this.urlService.getRevocationEndpointUrl(configId);\n\n    let headers: HttpHeaders = new HttpHeaders();\n    headers = headers.set('Content-Type', 'application/x-www-form-urlencoded');\n\n    return this.dataService.post(url, body, configId, headers).pipe(\n      retry(2),\n      switchMap((response: any) => {\n        this.loggerService.logDebug(configId, 'revocation endpoint post response: ', response);\n\n        return of(response);\n      }),\n      catchError((error) => {\n        const errorMessage = `Revocation request failed`;\n        this.loggerService.logError(configId, errorMessage, error);\n\n        return throwError(errorMessage);\n      })\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { AuthOptions } from './auth-options';\nimport { AuthenticatedResult } from './auth-state/auth-result';\nimport { AuthStateService } from './auth-state/auth-state.service';\nimport { CallbackService } from './callback/callback.service';\nimport { RefreshSessionService } from './callback/refresh-session.service';\nimport { CheckAuthService } from './check-auth.service';\nimport { OpenIdConfiguration } from './config/openid-configuration';\nimport { ConfigurationProvider } from './config/provider/config.provider';\nimport { FlowsDataService } from './flows/flows-data.service';\nimport { CheckSessionService } from './iframe/check-session.service';\nimport { LoginResponse } from './login/login-response';\nimport { LoginService } from './login/login.service';\nimport { PopupOptions } from './login/popup/popup-options';\nimport { LogoffRevocationService } from './logoff-revoke/logoff-revocation.service';\nimport { UserService } from './user-data/user.service';\nimport { UserDataResult } from './user-data/userdata-result';\nimport { TokenHelperService } from './utils/tokenHelper/token-helper.service';\nimport { UrlService } from './utils/url/url.service';\n\n@Injectable()\nexport class OidcSecurityService {\n  /**\n   * Provides information about the user after they have logged in.\n   *\n   * @returns Returns an object containing either the user data directly (single config) or\n   * the user data per config in case you are running with multiple configs\n   */\n  get userData$(): Observable<UserDataResult> {\n    return this.userService.userData$;\n  }\n\n  /**\n   * Emits each time an authorization event occurs.\n   *\n   * @returns Returns an object containing if you are authenticated or not.\n   * Single Config: true if config is authenticated, false if not.\n   * Multiple Configs: true is all configs are authenticated, false if only one of them is not\n   *\n   * The `allConfigsAuthenticated` property contains the auth information _per config_.\n   */\n  get isAuthenticated$(): Observable<AuthenticatedResult> {\n    return this.authStateService.authenticated$;\n  }\n\n  /**\n   * Emits each time the server sends a CheckSession event and the value changed. This property will always return\n   * true.\n   */\n  get checkSessionChanged$(): Observable<boolean> {\n    return this.checkSessionService.checkSessionChanged$;\n  }\n\n  /**\n   * Emits on a Security Token Service callback. The observable will never contain a value.\n   */\n  get stsCallback$(): Observable<any> {\n    return this.callbackService.stsCallback$;\n  }\n\n  constructor(\n    private checkSessionService: CheckSessionService,\n    private checkAuthService: CheckAuthService,\n    private userService: UserService,\n    private tokenHelperService: TokenHelperService,\n    private configurationProvider: ConfigurationProvider,\n    private authStateService: AuthStateService,\n    private flowsDataService: FlowsDataService,\n    private callbackService: CallbackService,\n    private logoffRevocationService: LogoffRevocationService,\n    private loginService: LoginService,\n    private refreshSessionService: RefreshSessionService,\n    private urlService: UrlService\n  ) {}\n\n  /**\n   * Returns the currently active OpenID configurations.\n   *\n   * @returns an array of OpenIdConfigurations.\n   */\n  getConfigurations(): OpenIdConfiguration[] {\n    return this.configurationProvider.getAllConfigurations();\n  }\n\n  /**\n   * Returns a single active OpenIdConfiguration.\n   *\n   * @param configId The configId to identify the config. If not passed, the first one is being returned\n   */\n  getConfiguration(configId?: string): OpenIdConfiguration {\n    configId = configId ?? this.configurationProvider.getOpenIDConfiguration().configId;\n\n    return this.configurationProvider.getOpenIDConfiguration(configId);\n  }\n\n  /**\n   * Returns the userData for a configuration\n   *\n   * @param configId The configId to identify the config. If not passed, the first one is being used\n   */\n  getUserData(configId?: string): any {\n    configId = configId ?? this.configurationProvider.getOpenIDConfiguration().configId;\n\n    return this.userService.getUserDataFromStore(configId);\n  }\n\n  /**\n   * Starts the complete setup flow for one configuration. Calling will start the entire authentication flow, and the returned observable\n   * will denote whether the user was successfully authenticated including the user data, the access token, the configId and\n   * an error message in case an error happened\n   *\n   * @param url The URL to perform the authorization on the behalf of.\n   * @param configId The configId to perform the authorization on the behalf of. If not passed, the first configs will be taken\n   *\n   * @returns An object `LoginResponse` containing all information about the login\n   */\n  checkAuth(url?: string, configId?: string): Observable<LoginResponse> {\n    return this.checkAuthService.checkAuth(configId, url);\n  }\n\n  /**\n   * Starts the complete setup flow for multiple configurations.\n   * Calling will start the entire authentication flow, and the returned observable\n   * will denote whether the user was successfully authenticated including the user data, the access token, the configId and\n   * an error message in case an error happened in an array for each config which was provided\n   *\n   * @param url The URL to perform the authorization on the behalf of.\n   * @param configId The configId to perform the authorization on the behalf of. If not passed, all of the current\n   * configured ones will be used to check.\n   *\n   * @returns An array of `LoginResponse` objects containing all information about the logins\n   */\n  checkAuthMultiple(url?: string, configId?: string): Observable<LoginResponse[]> {\n    return this.checkAuthService.checkAuthMultiple(configId, url);\n  }\n\n  /**\n   * Provides information about the current authenticated state\n   *\n   * @param configId The configId to check the information for. If not passed, the first configs will be taken\n   *\n   * @returns A boolean whether the config is authenticated or not.\n   */\n  isAuthenticated(configId?: string): boolean {\n    configId = configId ?? this.configurationProvider.getOpenIDConfiguration(configId).configId;\n\n    return this.authStateService.isAuthenticated(configId);\n  }\n\n  /**\n   * Checks the server for an authenticated session using the iframe silent renew if not locally authenticated.\n   */\n  checkAuthIncludingServer(configId?: string): Observable<LoginResponse> {\n    configId = configId ?? this.configurationProvider.getOpenIDConfiguration(configId).configId;\n\n    return this.checkAuthService.checkAuthIncludingServer(configId);\n  }\n\n  /**\n   * Returns the access token for the login scenario.\n   *\n   * @param configId The configId to check the information for. If not passed, the first configs will be taken\n   *\n   * @returns A string with the access token.\n   */\n  getAccessToken(configId?: string): string {\n    configId = configId ?? this.configurationProvider.getOpenIDConfiguration(configId).configId;\n\n    return this.authStateService.getAccessToken(configId);\n  }\n\n  /**\n   * Returns the ID token for the sign-in.\n   *\n   * @param configId The configId to check the information for. If not passed, the first configs will be taken\n   *\n   * @returns A string with the id token.\n   */\n  getIdToken(configId?: string): string {\n    configId = configId ?? this.configurationProvider.getOpenIDConfiguration(configId).configId;\n\n    return this.authStateService.getIdToken(configId);\n  }\n\n  /**\n   * Returns the refresh token, if present, for the sign-in.\n   *\n   * @param configId The configId to check the information for. If not passed, the first configs will be taken\n   *\n   * @returns A string with the refresh token.\n   */\n  getRefreshToken(configId?: string): string {\n    configId = configId ?? this.configurationProvider.getOpenIDConfiguration(configId).configId;\n\n    return this.authStateService.getRefreshToken(configId);\n  }\n\n  /**\n   * Returns the authentication result, if present, for the sign-in.\n   *\n   * @param configId The configId to check the information for. If not passed, the first configs will be taken\n   *\n   * @returns A object with the authentication result\n   */\n  getAuthenticationResult(configId?: string): any {\n    configId = configId ?? this.configurationProvider.getOpenIDConfiguration(configId).configId;\n\n    return this.authStateService.getAuthenticationResult(configId);\n  }\n\n  /**\n   * Returns the payload from the ID token.\n   *\n   * @param encode Set to true if the payload is base64 encoded\n   * @param configId The configId to check the information for. If not passed, the first configs will be taken\n   *\n   * @returns The payload from the id token.\n   */\n  getPayloadFromIdToken(encode = false, configId?: string): any {\n    configId = configId ?? this.configurationProvider.getOpenIDConfiguration(configId).configId;\n    const token = this.authStateService.getIdToken(configId);\n\n    return this.tokenHelperService.getPayloadFromToken(token, encode, configId);\n  }\n\n  /**\n   * Sets a custom state for the authorize request.\n   *\n   * @param state The state to set.\n   * @param configId The configId to check the information for. If not passed, the first configs will be taken\n   */\n  setState(state: string, configId?: string): void {\n    configId = configId ?? this.configurationProvider.getOpenIDConfiguration(configId).configId;\n\n    this.flowsDataService.setAuthStateControl(state, configId);\n  }\n\n  /**\n   * Gets the state value used for the authorize request.\n   *\n   * @param configId The configId to check the information for. If not passed, the first configs will be taken\n   *\n   * @returns The state value used for the authorize request.\n   */\n  getState(configId?: string): string {\n    configId = configId ?? this.configurationProvider.getOpenIDConfiguration(configId).configId;\n\n    return this.flowsDataService.getAuthStateControl(configId);\n  }\n\n  /**\n   * Redirects the user to the Security Token Service to begin the authentication process.\n   *\n   * @param configId The configId to perform the action in behalf of. If not passed, the first configs will be taken\n   * @param authOptions The custom options for the the authentication request.\n   */\n  authorize(configId?: string, authOptions?: AuthOptions): void {\n    configId = configId ?? this.configurationProvider.getOpenIDConfiguration(configId).configId;\n\n    this.loginService.login(configId, authOptions);\n  }\n\n  /**\n   * Opens the Security Token Service in a new window to begin the authentication process.\n   *\n   * @param authOptions The custom options for the authentication request.\n   * @param popupOptions The configuration for the popup window.\n   * @param configId The configId to perform the action in behalf of. If not passed, the first configs will be taken\n   *\n   * @returns An `Observable<LoginResponse>` containing all information about the login\n   */\n  authorizeWithPopUp(authOptions?: AuthOptions, popupOptions?: PopupOptions, configId?: string): Observable<LoginResponse> {\n    configId = configId ?? this.configurationProvider.getOpenIDConfiguration(configId).configId;\n\n    return this.loginService.loginWithPopUp(configId, authOptions, popupOptions);\n  }\n\n  /**\n   * Manually refreshes the session.\n   *\n   * @param customParams Custom parameters to pass to the refresh request.\n   * @param configId The configId to perform the action in behalf of. If not passed, the first configs will be taken\n   *\n   * @returns An `Observable<LoginResponse>` containing all information about the login\n   */\n  forceRefreshSession(customParams?: { [key: string]: string | number | boolean }, configId?: string): Observable<LoginResponse> {\n    configId = configId ?? this.configurationProvider.getOpenIDConfiguration(configId).configId;\n\n    return this.refreshSessionService.userForceRefreshSession(configId, customParams);\n  }\n\n  /**\n   * Revokes the refresh token (if present) and the access token on the server and then performs the logoff operation.\n   * The refresh token and and the access token are revoked on the server. If the refresh token does not exist\n   * only the access token is revoked. Then the logout run.\n   *\n   * @param configId The configId to perform the action in behalf of. If not passed, the first configs will be taken\n   * @param authOptions The custom options for the request.\n   *\n   * @returns An observable when the action is finished\n   */\n  logoffAndRevokeTokens(configId?: string, authOptions?: AuthOptions): Observable<any> {\n    configId = configId ?? this.configurationProvider.getOpenIDConfiguration(configId).configId;\n\n    return this.logoffRevocationService.logoffAndRevokeTokens(configId, authOptions);\n  }\n\n  /**\n   * Logs out on the server and the local client. If the server state has changed, confirmed via check session,\n   * then only a local logout is performed.\n   *\n   * @param configId The configId to perform the action in behalf of. If not passed, the first configs will be taken\n   * @param authOptions with custom parameters and/or an custom url handler\n   */\n  logoff(configId?: string, authOptions?: AuthOptions): void {\n    configId = configId ?? this.configurationProvider.getOpenIDConfiguration(configId).configId;\n\n    return this.logoffRevocationService.logoff(configId, authOptions);\n  }\n\n  /**\n   * Logs the user out of the application without logging them out of the server.\n   * Use this method if you have _one_ config enabled.\n   *\n   * @param configId The configId to perform the action in behalf of. If not passed, the first configs will be taken\n   */\n  logoffLocal(configId?: string): void {\n    configId = configId ?? this.configurationProvider.getOpenIDConfiguration(configId).configId;\n\n    return this.logoffRevocationService.logoffLocal(configId);\n  }\n\n  /**\n   * Logs the user out of the application for all configs without logging them out of the server.\n   * Use this method if you have _multiple_ configs enabled.\n   */\n  logoffLocalMultiple(): void {\n    return this.logoffRevocationService.logoffLocalMultiple();\n  }\n\n  /**\n   * Revokes an access token on the Security Token Service. This is only required in the code flow with refresh tokens. If no token is\n   * provided, then the token from the storage is revoked. You can pass any token to revoke.\n   * https://tools.ietf.org/html/rfc7009\n   *\n   * @param accessToken The access token to revoke.\n   * @param configId The configId to perform the action in behalf of. If not passed, the first configs will be taken\n   *\n   * @returns An observable when the action is finished\n   */\n  revokeAccessToken(accessToken?: any, configId?: string): Observable<any> {\n    configId = configId ?? this.configurationProvider.getOpenIDConfiguration(configId).configId;\n\n    return this.logoffRevocationService.revokeAccessToken(configId, accessToken);\n  }\n\n  /**\n   * Revokes a refresh token on the Security Token Service. This is only required in the code flow with refresh tokens. If no token is\n   * provided, then the token from the storage is revoked. You can pass any token to revoke.\n   * https://tools.ietf.org/html/rfc7009\n   *\n   * @param refreshToken The access token to revoke.\n   * @param configId The configId to perform the action in behalf of. If not passed, the first configs will be taken\n   *\n   * @returns An observable when the action is finished\n   */\n  revokeRefreshToken(refreshToken?: any, configId?: string): Observable<any> {\n    configId = configId ?? this.configurationProvider.getOpenIDConfiguration(configId).configId;\n\n    return this.logoffRevocationService.revokeRefreshToken(configId, refreshToken);\n  }\n\n  /**\n   * Creates the end session URL which can be used to implement an alternate server logout.\n   *\n   * @param customParams\n   * @param configId The configId to perform the action in behalf of. If not passed, the first configs will be taken\n   *\n   * @returns A string with the end session url or null\n   */\n  getEndSessionUrl(customParams?: { [p: string]: string | number | boolean }, configId?: string): string | null {\n    configId = configId ?? this.configurationProvider.getOpenIDConfiguration(configId).configId;\n\n    return this.logoffRevocationService.getEndSessionUrl(configId, customParams);\n  }\n\n  /**\n   * Creates the authorize URL based on your flow\n   *\n   * @param customParams\n   * @param configId The configId to perform the action in behalf of. If not passed, the first configs will be taken\n   *\n   * @returns A string with the authorize URL or null\n   */\n  getAuthorizeUrl(customParams?: { [p: string]: string | number | boolean }, configId?: string): string | null {\n    configId = configId ?? this.configurationProvider.getOpenIDConfiguration(configId).configId;\n\n    return this.urlService.getAuthorizeUrl(configId, customParams);\n  }\n}\n","import { CommonModule } from '@angular/common';\nimport { HttpClientModule } from '@angular/common/http';\nimport { APP_INITIALIZER, InjectionToken, ModuleWithProviders, NgModule, Provider } from '@angular/core';\nimport { DataService } from './api/data.service';\nimport { HttpBaseService } from './api/http-base.service';\nimport { AuthStateService } from './auth-state/auth-state.service';\nimport { AutoLoginService } from './auto-login/auto-login.service';\nimport { ImplicitFlowCallbackService } from './callback/implicit-flow-callback.service';\nimport { CheckAuthService } from './check-auth.service';\nimport { AuthWellKnownDataService } from './config/auth-well-known/auth-well-known-data.service';\nimport { AuthWellKnownService } from './config/auth-well-known/auth-well-known.service';\nimport { OidcConfigService } from './config/config.service';\nimport { StsConfigLoader, StsConfigStaticLoader } from './config/loader/config-loader';\nimport { OpenIdConfiguration } from './config/openid-configuration';\nimport { ConfigurationProvider } from './config/provider/config.provider';\nimport { ConfigValidationService } from './config/validation/config-validation.service';\nimport { CodeFlowCallbackHandlerService } from './flows/callback-handling/code-flow-callback-handler.service';\nimport { HistoryJwtKeysCallbackHandlerService } from './flows/callback-handling/history-jwt-keys-callback-handler.service';\nimport { ImplicitFlowCallbackHandlerService } from './flows/callback-handling/implicit-flow-callback-handler.service';\nimport { RefreshSessionCallbackHandlerService } from './flows/callback-handling/refresh-session-callback-handler.service';\nimport { RefreshTokenCallbackHandlerService } from './flows/callback-handling/refresh-token-callback-handler.service';\nimport { StateValidationCallbackHandlerService } from './flows/callback-handling/state-validation-callback-handler.service';\nimport { UserCallbackHandlerService } from './flows/callback-handling/user-callback-handler.service';\nimport { FlowsDataService } from './flows/flows-data.service';\nimport { FlowsService } from './flows/flows.service';\nimport { RandomService } from './flows/random/random.service';\nimport { ResetAuthDataService } from './flows/reset-auth-data.service';\nimport { SigninKeyDataService } from './flows/signin-key-data.service';\nimport { CheckSessionService } from './iframe/check-session.service';\nimport { IFrameService } from './iframe/existing-iframe.service';\nimport { SilentRenewService } from './iframe/silent-renew.service';\nimport { ClosestMatchingRouteService } from './interceptor/closest-matching-route.service';\nimport { LoggerService } from './logging/logger.service';\nimport { LoginService } from './login/login.service';\nimport { ParLoginService } from './login/par/par-login.service';\nimport { ParService } from './login/par/par.service';\nimport { PopUpLoginService } from './login/popup/popup-login.service';\nimport { ResponseTypeValidationService } from './login/response-type-validation/response-type-validation.service';\nimport { StandardLoginService } from './login/standard/standard-login.service';\nimport { LogoffRevocationService } from './logoff-revoke/logoff-revocation.service';\nimport { OidcSecurityService } from './oidc.security.service';\nimport { PublicEventsService } from './public-events/public-events.service';\nimport { BrowserStorageService } from './storage/browser-storage.service';\nimport { DefaultSessionStorageService } from './storage/default-sessionstorage.service';\nimport { StoragePersistenceService } from './storage/storage-persistence.service';\nimport { UserService } from './user-data/user.service';\nimport { EqualityService } from './utils/equality/equality.service';\nimport { FlowHelper } from './utils/flowHelper/flow-helper.service';\nimport { PlatformProvider } from './utils/platform-provider/platform.provider';\nimport { TokenHelperService } from './utils/tokenHelper/token-helper.service';\nimport { CurrentUrlService } from './utils/url/current-url.service';\nimport { UrlService } from './utils/url/url.service';\nimport { JsrsAsignReducedService } from './validation/jsrsasign-reduced.service';\nimport { StateValidationService } from './validation/state-validation.service';\nimport { TokenValidationService } from './validation/token-validation.service';\n\nexport interface PassedInitialConfig {\n  config?: OpenIdConfiguration | OpenIdConfiguration[];\n  loader?: Provider;\n  storage?: any;\n}\n\n// eslint-disable-next-line @typescript-eslint/explicit-function-return-type\nexport function createStaticLoader(passedConfig: PassedInitialConfig) {\n  return new StsConfigStaticLoader(passedConfig.config);\n}\n\n// eslint-disable-next-line @typescript-eslint/explicit-function-return-type\nexport function configurationProviderFactory(oidcConfigService: OidcConfigService, loader: StsConfigLoader) {\n  const allLoadPromises = Promise.all(loader.loadConfigs());\n  const fn: () => Promise<OpenIdConfiguration[]> = () => allLoadPromises.then((configs) => oidcConfigService.withConfigs(configs));\n\n  return fn;\n}\n\nexport const PASSED_CONFIG = new InjectionToken<PassedInitialConfig>('PASSED_CONFIG');\n\n@NgModule({\n  imports: [CommonModule, HttpClientModule],\n  declarations: [],\n  exports: [],\n})\nexport class AuthModule {\n  static forRoot(passedConfig: PassedInitialConfig): ModuleWithProviders<AuthModule> {\n    return {\n      ngModule: AuthModule,\n      providers: [\n        // Make the PASSED_CONFIG available through injection\n        { provide: PASSED_CONFIG, useValue: passedConfig },\n\n        // Create the loader: Either the one getting passed or a static one\n        passedConfig?.loader || { provide: StsConfigLoader, useFactory: createStaticLoader, deps: [PASSED_CONFIG] },\n\n        // Load the config when the app starts\n        {\n          provide: APP_INITIALIZER,\n          multi: true,\n          deps: [OidcConfigService, StsConfigLoader, PASSED_CONFIG],\n          useFactory: configurationProviderFactory,\n        },\n        OidcConfigService,\n        PublicEventsService,\n        FlowHelper,\n        ConfigurationProvider,\n        OidcSecurityService,\n        TokenValidationService,\n        PlatformProvider,\n        CheckSessionService,\n        FlowsDataService,\n        FlowsService,\n        SilentRenewService,\n        LogoffRevocationService,\n        UserService,\n        RandomService,\n        HttpBaseService,\n        UrlService,\n        AuthStateService,\n        SigninKeyDataService,\n        StoragePersistenceService,\n        TokenHelperService,\n        LoggerService,\n        IFrameService,\n        EqualityService,\n        LoginService,\n        ParService,\n        AuthWellKnownDataService,\n        AuthWellKnownService,\n        DataService,\n        StateValidationService,\n        ConfigValidationService,\n        CheckAuthService,\n        ResetAuthDataService,\n        ImplicitFlowCallbackService,\n        HistoryJwtKeysCallbackHandlerService,\n        ResponseTypeValidationService,\n        UserCallbackHandlerService,\n        StateValidationCallbackHandlerService,\n        RefreshSessionCallbackHandlerService,\n        RefreshTokenCallbackHandlerService,\n        CodeFlowCallbackHandlerService,\n        ImplicitFlowCallbackHandlerService,\n        ParLoginService,\n        PopUpLoginService,\n        StandardLoginService,\n        AutoLoginService,\n        JsrsAsignReducedService,\n        CurrentUrlService,\n        ClosestMatchingRouteService,\n        DefaultSessionStorageService,\n        BrowserStorageService,\n      ],\n    };\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { ActivatedRouteSnapshot, CanActivate, CanActivateChild, CanLoad, Route, RouterStateSnapshot, UrlSegment } from '@angular/router';\nimport { Observable } from 'rxjs';\nimport { map, take } from 'rxjs/operators';\nimport { CheckAuthService } from '../check-auth.service';\nimport { ConfigurationProvider } from '../config/provider/config.provider';\nimport { LoginService } from '../login/login.service';\nimport { AutoLoginService } from './auto-login.service';\n\n@Injectable({ providedIn: 'root' })\nexport class AutoLoginAllRoutesGuard implements CanActivate, CanActivateChild, CanLoad {\n  constructor(\n    private autoLoginService: AutoLoginService,\n    private checkAuthService: CheckAuthService,\n    private loginService: LoginService,\n    private configurationProvider: ConfigurationProvider\n  ) {}\n\n  canLoad(route: Route, segments: UrlSegment[]): Observable<boolean> {\n    const routeToRedirect = segments.join('/');\n\n    return this.checkAuth(routeToRedirect);\n  }\n\n  canActivate(route: ActivatedRouteSnapshot, state: RouterStateSnapshot): Observable<boolean> {\n    return this.checkAuth(state.url);\n  }\n\n  canActivateChild(route: ActivatedRouteSnapshot, state: RouterStateSnapshot): Observable<boolean> {\n    return this.checkAuth(state.url);\n  }\n\n  private checkAuth(url: string): Observable<boolean> {\n    const configId = this.getId();\n\n    return this.checkAuthService.checkAuth().pipe(\n      take(1),\n      map(({ isAuthenticated }) => {\n        if (isAuthenticated) {\n          this.autoLoginService.checkSavedRedirectRouteAndNavigate(configId);\n        }\n\n        if (!isAuthenticated) {\n          this.autoLoginService.saveRedirectRoute(configId, url);\n          this.loginService.login(configId);\n        }\n\n        return isAuthenticated;\n      })\n    );\n  }\n\n  private getId(): string {\n    return this.configurationProvider.getOpenIDConfiguration().configId;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { ActivatedRouteSnapshot, CanActivate, CanActivateChild, CanLoad, Route, RouterStateSnapshot, UrlSegment } from '@angular/router';\nimport { AuthStateService } from '../auth-state/auth-state.service';\nimport { ConfigurationProvider } from '../config/provider/config.provider';\nimport { LoginService } from '../login/login.service';\nimport { AutoLoginService } from './auto-login.service';\n\n@Injectable({ providedIn: 'root' })\nexport class AutoLoginPartialRoutesGuard implements CanActivate, CanActivateChild, CanLoad {\n  constructor(\n    private autoLoginService: AutoLoginService,\n    private authStateService: AuthStateService,\n    private loginService: LoginService,\n    private configurationProvider: ConfigurationProvider\n  ) {}\n\n  canLoad(route: Route, segments: UrlSegment[]): boolean {\n    const routeToRedirect = segments.join('/');\n\n    return this.checkAuth(routeToRedirect);\n  }\n\n  canActivate(route: ActivatedRouteSnapshot, state: RouterStateSnapshot): boolean {\n    return this.checkAuth(state.url);\n  }\n\n  canActivateChild(route: ActivatedRouteSnapshot, state: RouterStateSnapshot): boolean {\n    return this.checkAuth(state.url);\n  }\n\n  private checkAuth(url: string): boolean {\n    const configId = this.getId();\n\n    const isAuthenticated = this.authStateService.areAuthStorageTokensValid(configId);\n\n    if (isAuthenticated) {\n      this.autoLoginService.checkSavedRedirectRouteAndNavigate(configId);\n    }\n\n    if (!isAuthenticated) {\n      this.autoLoginService.saveRedirectRoute(configId, url);\n      this.loginService.login(configId);\n    }\n\n    return isAuthenticated;\n  }\n\n  private getId(): string {\n    return this.configurationProvider.getOpenIDConfiguration().configId;\n  }\n}\n","import { HttpEvent, HttpHandler, HttpInterceptor, HttpRequest } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { AuthStateService } from '../auth-state/auth-state.service';\nimport { ConfigurationProvider } from '../config/provider/config.provider';\nimport { LoggerService } from '../logging/logger.service';\nimport { ClosestMatchingRouteService } from './closest-matching-route.service';\n\n@Injectable()\nexport class AuthInterceptor implements HttpInterceptor {\n  constructor(\n    private authStateService: AuthStateService,\n    private configurationProvider: ConfigurationProvider,\n    private loggerService: LoggerService,\n    private closestMatchingRouteService: ClosestMatchingRouteService\n  ) {}\n\n  intercept(req: HttpRequest<any>, next: HttpHandler): Observable<HttpEvent<any>> {\n    if (!this.configurationProvider.hasAsLeastOneConfig()) {\n      return next.handle(req);\n    }\n\n    const allConfigurations = this.configurationProvider.getAllConfigurations();\n    const allRoutesConfigured = allConfigurations.map((x) => x.secureRoutes || []);\n    const allRoutesConfiguredFlat = [].concat.apply([], allRoutesConfigured);\n\n    if (allRoutesConfiguredFlat.length === 0) {\n      const { configId } = allConfigurations[0];\n      this.loggerService.logDebug(configId, `No routes to check configured`);\n\n      return next.handle(req);\n    }\n\n    const { matchingConfigId, matchingRoute } = this.closestMatchingRouteService.getConfigIdForClosestMatchingRoute(req.url);\n\n    if (!matchingConfigId) {\n      const { configId } = allConfigurations[0];\n      this.loggerService.logDebug(configId, `Did not find any configured route for route ${req.url}`);\n\n      return next.handle(req);\n    }\n\n    this.loggerService.logDebug(matchingConfigId, `'${req.url}' matches configured route '${matchingRoute}'`);\n\n    const token = this.authStateService.getAccessToken(matchingConfigId);\n\n    if (!token) {\n      this.loggerService.logDebug(matchingConfigId, `Wanted to add token to ${req.url} but found no token: '${token}'`);\n\n      return next.handle(req);\n    }\n\n    this.loggerService.logDebug(matchingConfigId, `'${req.url}' matches configured route '${matchingRoute}', adding token`);\n    req = req.clone({\n      headers: req.headers.set('Authorization', 'Bearer ' + token),\n    });\n\n    return next.handle(req);\n  }\n}\n","import { Injectable } from '@angular/core';\n\n/**\n * Implement this class-interface to create a custom storage.\n */\n@Injectable()\nexport abstract class AbstractSecurityStorage {\n  /**\n   * This method must contain the logic to read the storage.\n   *\n   * @return The value of the given key\n   */\n  public abstract read(key: string): any;\n\n  /**\n   * This method must contain the logic to write the storage.\n   *\n   * @param key The key to write a value for\n   * @param value The value for the given key\n   */\n  public abstract write(key: string, value: any): void;\n\n  /**\n   * This method must contain the logic to remove an item from the storage.\n   *\n   * @param key The value for the key to be removed\n   */\n  public abstract remove(key: string): void;\n\n  /**\n   * This method must contain the logic to remove all items from the storage.\n   */\n  public abstract clear(): void;\n}\n","// Public classes.\n\nexport * from './auth-options';\nexport * from './auth-state/auth-result';\nexport * from './auth-state/auth-state';\nexport * from './auth.module';\nexport * from './auto-login/auto-login-all-routes.guard';\nexport * from './auto-login/auto-login-partial-routes.guard';\nexport * from './config/auth-well-known/auth-well-known-endpoints';\nexport * from './config/config.service';\nexport * from './config/loader/config-loader';\nexport * from './config/openid-configuration';\nexport * from './interceptor/auth.interceptor';\nexport * from './logging/log-level';\nexport * from './logging/logger.service';\nexport * from './login/login-response';\nexport * from './login/popup/popup-options';\nexport * from './login/popup/popup.service';\nexport * from './oidc.security.service';\nexport * from './public-events/event-types';\nexport * from './public-events/notification';\nexport * from './public-events/public-events.service';\nexport * from './storage/abstract-security-storage';\nexport * from './user-data/userdata-result';\nexport * from './utils/tokenHelper/token-helper.service';\nexport * from './validation/jwtkeys';\nexport * from './validation/state-validation-result';\nexport * from './validation/token-validation.service';\nexport * from './validation/validation-result';\n","/*\n * Public API Surface of angular-auth-oidc-client\n */\n\nexport * from './lib/angular-auth-oidc-client';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":["Injectable","HttpHeaders","HttpParams","EventTypes","LogLevel","ReplaySubject","KJUR","hextob64u","KEYUTIL","BehaviorSubject","distinctUntilChanged","DOCUMENT","Inject","throwError","of","switchMap","retryWhen","catchError","mergeMap","HttpErrorResponse","timer","map","retry","ValidationResult","HttpResponse","tap","concatMap","Observable","take","Subject","forkJoin","timeout","TimeoutError","isPlatformBrowser","PLATFORM_ID","InjectionToken","APP_INITIALIZER","CommonModule","HttpClientModule","NgModule"],"mappings":"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"}